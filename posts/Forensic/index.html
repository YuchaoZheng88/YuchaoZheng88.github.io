<!DOCTYPE html>













<html lang="en"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Allow having a localized datetime different from the appearance language -->
  

  

    

    

  

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Forensic" />
<meta name="author" content="Yuchao" />
<meta property="og:locale" content="en" />
<meta name="description" content="SANS 3MinMax" />
<meta property="og:description" content="SANS 3MinMax" />
<link rel="canonical" href="/posts/Forensic/" />
<meta property="og:url" content="/posts/Forensic/" />
<meta property="og:site_name" content="Yuchao Toolbox" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-29T11:33:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Forensic" />
<meta name="twitter:site" content="@0xZEN2" />
<meta name="twitter:creator" content="@Yuchao" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yuchao"},"dateModified":"2023-04-24T12:50:28+08:00","datePublished":"2023-01-29T11:33:00+08:00","description":"SANS 3MinMax","headline":"Forensic","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Forensic/"},"url":"/posts/Forensic/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Forensic | Yuchao Toolbox
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Yuchao Toolbox">
<meta name="application-name" content="Yuchao Toolbox">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get MODE_ATTR() { return "data-mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
          
          <img src="https://raw.githubusercontent.com/YuchaoZheng88/blogImage/main/123.png" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Yuchao Toolbox</a>
    </div>
    <div class="site-subtitle font-italic">About hacking and thinking.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
      <a href="https://github.com/YuchaoZheng88" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/0xZEN2" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['johneastcodestock','gmail.com'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Forensic</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        









<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-8">
    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->



<!-- images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







<!-- return -->







<h1 data-toc-skip>Forensic</h1>

<div class="post-meta text-muted">

  <!-- author -->
  <div>
    
    

    

    By
    <em>
      
        Yuchao
      
    </em>
  </div>

  <div class="d-flex">
    <div>
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago"
    data-ts="1674963180"
    
      data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll"
    
    >
  2023-01-29
</em>

      </span>

      <!-- lastmod date -->
      
      <span>
        Updated
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago"
    data-ts="1682311828"
    
      data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll"
    
    >
  2023-04-24
</em>

      </span>
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="3999 words">
  <em>22 min</em> read</span>


      <!-- page views -->
      
    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <h1 id="sans-3minmax">SANS 3MinMax</h1>

<p>Kevin Ripa  101</p>

<h2 id="5-windows-quick-win-artifacts"><span class="mr-2">5 Windows Quick Win Artifacts</span><a href="#5-windows-quick-win-artifacts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h4 id="registry"><span class="mr-2">Registry</span><a href="#registry" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>aka. hives: SAM,System,Software,Secrutiy,NTUser</li>
  <li>find what: MRU Lists, System searches, Browser typed URLs, USB/Wifi connection, SSIDs, Network connections, Programs/services running at startup, etc.</li>
  <li>https://github.com/EricZimmerman -&gt; Registry Explorer.</li>
  <li>C:\Windows\system32\config\SAM</li>
  <li>popular: OpenSavePidIMRU, RecentDocs, SAM, USBSTOR, AppCompatCache, WordWheelQuery, ComputerName, TimeZoneInformation, CurrentVersion.</li>
  <li>Regeditor shows no information of SAM hive, but Registry Explorer shows the information.</li>
  <li>Transaction Logs: https://andreafortuna.org/2021/02/06/windows-registry-transaction-logs-in-forensic-analysis/</li>
</ul>

<h4 id="jumplists"><span class="mr-2">Jumplists</span><a href="#jumplists" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>file, folder user performed historically.</li>
  <li>{userFile}\AppData\Roaming\Microsoft\Recent Items\AutomaticDestinations</li>
  <li>last folder above need to be input manually.</li>
  <li>“{appID}.automaticDestinations-ms” files</li>
  <li>jumplist explorer: “jlecmd -f {one-ms file path} “</li>
  <li>“jlecmd -f {one-ms file path}  –csv {output path}” output as csv.</li>
</ul>

<h4 id="lnk"><span class="mr-2">“.LNK”</span><a href="#lnk" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>{userFile}\AppData\Roaming\Microsoft\Recent Items</li>
  <li>files in above folder, are files interacted before.</li>
  <li>when date created same as date modified, mean opened once. Otherwise, more than once.</li>
  <li>real file has different time stamp, as file above is the shortcut`s timestamp.</li>
  <li>when real file deleted, link file still stays.</li>
  <li><code class="language-plaintext highlighter-rouge">lecmd -f {linkFilePath} --csv {outPutPath}</code> or -d to directory.</li>
</ul>

<h4 id="shellbags"><span class="mr-2">Shellbags</span><a href="#shellbags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>open a folder again, same location, same window size.</li>
  <li>{userFile}\AppData\Roaming\Microsoft\Windows\UsrClass.dat</li>
  <li>HKEY_CLASSES_ROOT\Local Settings\Software\Microsoft\Windows\Shell</li>
  <li>ZM tool: ShellBags Explorer. <code class="language-plaintext highlighter-rouge">SBECmd.exe -l --csv {outPutPath}</code></li>
  <li>eg. F: may not be the same USB device, watch meta data to check.</li>
</ul>

<h4 id="prefetch"><span class="mr-2">Prefetch</span><a href="#prefetch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>C:\Windows\Prefetch</li>
  <li>file name eg. CONHOST.EXE-0C6456FB.pf, MSEDGEWEBVIEW2.EXE-053FE714.pf</li>
  <li>ZM tool: <code class="language-plaintext highlighter-rouge">pecmd -f {.pf file path}</code></li>
  <li><code class="language-plaintext highlighter-rouge">pecmd -d C:\Windows\Prefetch\ --csv C:\Temp1 -q</code></li>
  <li>WinPrefetchView, www.nirsoft.net</li>
</ul>

<h2 id="bigger-data"><span class="mr-2">Bigger data</span><a href="#bigger-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>NAS: network attached storage.</li>
  <li>RAID: Redundant Array of Independent(Inexpensive) Disks.</li>
  <li>RAID 5: maybe the most popular one. One drive lose is acceptable. Recover takes time. Use parity.</li>
  <li>synology, QNAP.</li>
</ul>

<h2 id="online-evidence"><span class="mr-2">Online evidence</span><a href="#online-evidence" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>https://hunch.ly/</li>
  <li>https://www.aircrack-ng.org/ IP not sufficient -&gt; device</li>
</ul>

<h2 id="image-surface-pro"><span class="mr-2">image Surface Pro</span><a href="#image-surface-pro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>only 3 ports: Power Interface, USB 3, mini Display.</li>
  <li>use USB 3 powered hub.</li>
  <li>connect: USB with boot program, hard drive(get image).</li>
  <li>UEFI screen. Boot to Paladin OS.</li>
  <li>https://sumuri.com/paladin-manual/</li>
</ul>

<h2 id="log"><span class="mr-2">log</span><a href="#log" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>c:\Windows\System32\winevt\Logs</li>
  <li>gkape: https://ericzimmerman.github.io/KapeDocs/#!index.md</li>
  <li>EZ tool: Timeline Explorer.</li>
  <li>Event Log Explorer. (filter)</li>
  <li>logon type: https://learn.microsoft.com/en-us/windows-server/identity/securing-privileged-access/reference-tools-logon-types</li>
  <li>Oalerts</li>
</ul>

<h2 id="lies-computer-tolds"><span class="mr-2">lies computer tolds</span><a href="#lies-computer-tolds" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>LNK file: ftk imager can look at master file table(MFT), and show files, which Windows may not. (same file names, but some of them deleted)</li>
</ul>

<h2 id="volume-shadow-copy"><span class="mr-2">Volume Shadow Copy</span><a href="#volume-shadow-copy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>system-&gt;about-&gt;system protection</li>
  <li><code class="language-plaintext highlighter-rouge">svvadmin list shadows /for=E:</code></li>
  <li>arsenal image mounter</li>
  <li>ShadowExplorer</li>
</ul>

<h2 id="webcache"><span class="mr-2">webcache</span><a href="#webcache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Browser-&gt;Website Data Settings-&gt;Current Location.</li>
  <li>If you want to see it: 1. show hidden files. 2. (Not) Hide protected operating system files.</li>
</ul>

<h2 id="cellphone"><span class="mr-2">Cellphone</span><a href="#cellphone" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Do not turn off.</li>
  <li>Different kinds.</li>
</ul>

<h2 id="password"><span class="mr-2">password</span><a href="#password" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>https://www.grc.com/haystack.htm</li>
  <li>cupp: wordlist builder</li>
  <li>Password Manager: Dashlane, Lastpass, Keypass, 1Password.</li>
</ul>

<h2 id="data"><span class="mr-2">data</span><a href="#data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Bit: binary digit</li>
  <li>Byte: By eight</li>
  <li>nibble: 4 bits, one hex.</li>
</ul>

<h2 id="forensic-resources"><span class="mr-2">Forensic resources</span><a href="#forensic-resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Cellebrite.com/en/home; smarterforensics.com/blog/; Mac4n6.com</li>
  <li>Thisweekin4n6.com; Aboutdfir.com; sans.org/blog/</li>
  <li>blog.elcomsoft.com; Thebinaryhick.blog</li>
  <li>https://www.youtube.com/@MagnetForensics1/videos; binaryforay.blogspot.com</li>
</ul>

<h2 id="kape"><span class="mr-2">Kape</span><a href="#kape" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Kroll Artifact Parser &amp; Extractor</li>
  <li>target, executable, modules.</li>
  <li>GUI version: gkape.</li>
</ul>

<h2 id="ezviewer"><span class="mr-2">EZViewer</span><a href="#ezviewer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>If do not know how to handle a file, it will open in hex.</li>
  <li>right bottom, view in hex.</li>
</ul>

<h2 id="incorrected-conclusion"><span class="mr-2">Incorrected conclusion.</span><a href="#incorrected-conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>MFT entry 2 - Deleted abc.dll -&gt; Cluster 13.</li>
  <li>MFT entry 3 - Exists Koala.jpg -&gt; Cluster 13.</li>
  <li>Then, MFT entry 3, Koala.jpg deleted, and points to Cluster 14 like abc.xlsx.</li>
  <li>wrong conclusion may be: some one hide Koala.jpg as abc.dll in a system directory.</li>
  <li>Because Entry and storage space have no relationship between each other.</li>
</ul>

<h2 id="usb"><span class="mr-2">USB</span><a href="#usb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Vendor, Product Name, Version, and device S/N</li>
</ul>

<h2 id="tools"><span class="mr-2">Tools</span><a href="#tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h4 id="acquisition-tools"><span class="mr-2">Acquisition tools</span><a href="#acquisition-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Arsenal Image Mounter, FTK Imager, Magnet Acquire, gkape</li>
  <li>USB WhiteProtectOFF/ON, Forensic Copy, Magnet RAM Capture</li>
</ul>

<h4 id="forensic-suites"><span class="mr-2">Forensic Suites</span><a href="#forensic-suites" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>BlackLight, IEF - Internet Evidence Finder, IEF Report Viewer</li>
  <li>AXIOMProcess, AXIOMExamine, Paraben P2C, Autopsy</li>
</ul>

<h4 id="artifact-tools"><span class="mr-2">Artifact Tools</span><a href="#artifact-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>autorunner, DCode Date, ExifTool GUI, GENA, Hexinator - HEX EDITOR</li>
  <li>Highligher, JumpList Explorer, md5summer, PhotoRec GUI</li>
  <li>QuickHash - FILE HASHER, ShadowExplorer, ShellBags Explorer</li>
  <li>Skype Log View, SRUM_DUMP, Structured Storage Viewer, thumbcache_viewer</li>
  <li>thumbs_viewer, Timeline Explorer, win prefetch view, WinHex</li>
</ul>

<h4 id="browser-tools"><span class="mr-2">Browser Tools</span><a href="#browser-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>ESEDatabase View, chrome cookies view, FOXTRON History Examiner</li>
  <li>mozilla history view, mozilla cache view, hindsight GUI, chrome cache view</li>
  <li>Mozilla Cookies, DB Browser for SQLite, browser add ons view</li>
  <li>browsing history view, chrome history view, firefox downloads view</li>
  <li>flash cookies view, GA Cookie Cruncher, NirLauncher</li>
</ul>

<h4 id="usb-forensics"><span class="mr-2">USB Forensics</span><a href="#usb-forensics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>USBDevice Forensics, USB Detective, UVCView</li>
</ul>

<h4 id="event-log-tools"><span class="mr-2">Event Log Tools</span><a href="#event-log-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Event Log Explorer, EVTX_VIEW</li>
</ul>

<h4 id="email-tools"><span class="mr-2">Email Tools</span><a href="#email-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>NUIX, Kernel OST Viewer, Kernel Outlook PST Viewer</li>
</ul>

<h4 id="registry-tools"><span class="mr-2">Registry Tools</span><a href="#registry-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Registry Explorer, Registry Recon, RegistryViewer</li>
  <li>regripper, SAMInside, UserAssist</li>
</ul>

<hr />

<h1 id="guided-hacking">Guided Hacking</h1>

<h2 id="where-to-download-new-malware-samples"><span class="mr-2">Where to Download New Malware Samples</span><a href="#where-to-download-new-malware-samples" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>https://abuse.ch/</li>
  <li>https://bazaar.abuse.ch/</li>
  <li>https://www.virustotal.com/gui/home/upload</li>
  <li>https://www.intezer.com/</li>
  <li>https://malpedia.caad.fkie.fraunhofer.de/</li>
  <li>https://tria.ge/</li>
  <li>https://www.unpac.me/#/</li>
</ul>

<h2 id="setup-vm"><span class="mr-2">setup VM</span><a href="#setup-vm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>https://github.com/mandiant/flare-vm common tools on Windows.</li>
  <li>https://www.uwamp.com/en/ light weight PHP server, can change version.</li>
  <li>https://www.telerik.com/fiddler Proxy, Find C2, script(own language) reponses.</li>
  <li>https://github.com/mandiant/flare-fakenet-ng python script</li>
  <li>https://github.com/a0rtega/pafish check what to patch, to make malware do not aware in VM.</li>
  <li>https://github.com/d4rksystem/VBoxCloak After this ps script, pafish will find much less VM traits.</li>
  <li>https://hex-rays.com/ida-free/</li>
  <li>https://github.com/mandiant/flare-ida IDA plugins.</li>
  <li>IDA plug: ret-sync.</li>
</ul>

<h2 id="syscalls"><span class="mr-2">syscalls</span><a href="#syscalls" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>32bit: https://syscalls32.paolostivanin.com/</li>
  <li>64bit: https://syscalls64.paolostivanin.com/</li>
</ul>

<h2 id="malware-traffic-analysis"><span class="mr-2">malware traffic analysis</span><a href="#malware-traffic-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>https://www.malware-traffic-analysis.net/</li>
  <li>infection chains</li>
  <li>https://unit42.paloaltonetworks.com/january-wireshark-quiz/</li>
  <li>https://unit42.paloaltonetworks.com/wireshark-workshop-videos/</li>
</ul>

<h2 id="youhacker"><span class="mr-2">YouHacker</span><a href="#youhacker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Detect It Easy -&gt; find library .NET</li>
  <li>dnspy -&gt; . NET assembly editor</li>
  <li>https://pypi.org/project/pydumpck/</li>
</ul>

<h2 id="paradies-clipper"><span class="mr-2">Paradies Clipper</span><a href="#paradies-clipper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>when copy and paste BTC address, the malware will change it.</li>
  <li>A C2 server to monitor the replacement.</li>
  <li>user32.dll -&gt; f: Open/Get/Set/EmptyClipboard</li>
</ul>

<hr />

<h1 id="book-practical-malware-analysis">book: Practical Malware Analysis</h1>

<h2 id="types"><span class="mr-2">types</span><a href="#types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>- Backdoor, botnet, downloader, launcher, rootkit, scareware, spam, worm
- persistence mechanism: windows registry
</pre></td></tr></tbody></table></code></div></div>

<h2 id="static"><span class="mr-2">static</span><a href="#static" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>1. hash as a fingerprint.
2. find strings
3. detect packed and obfuscated malware
4. linked library and functions
5. PE file headers: meta data about the file
</pre></td></tr></tbody></table></code></div></div>

<h2 id="dynamic"><span class="mr-2">Dynamic:</span><a href="#dynamic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>1. source-level, assembly-level debug.
2. kernel, user-mode debug.
</pre></td></tr></tbody></table></code></div></div>

<h2 id="process-vs-service"><span class="mr-2">Process VS Service:</span><a href="#process-vs-service" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>- A process is an instance of a particular executable (.exe program file) running. 
- A service is a process which runs in the background and does not interact with the desktop
</pre></td></tr></tbody></table></code></div></div>

<h2 id="pe-magic-number-mz"><span class="mr-2">PE: magic number “MZ”</span><a href="#pe-magic-number-mz" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>1. PE Header
	metadata information, pointers, and links to address sections in memory. 
2. PE Data Section
	.text stores the actual code of the program
	.data holds the initialized and defined variables
	.bss holds the uninitialized data (declared variables with no assigned values)
	.rdata contains the read-only data
	.edata: contains exportable objects and related table information
	.idata imported objects and related table information
	.reloc image relocation information
	.rsrc links external resources used by the program such as images, icons, embedded binaries, and manifest file, which has all information about program versions, authors, company, and copyright!
</pre></td></tr></tbody></table></code></div></div>

<h2 id="av-evasion"><span class="mr-2">AV Evasion:</span><a href="#av-evasion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>1. staged payload.
2. packer. Packing and Obfuscation.
3. Binder.
4. Sandbox evasion. 
</pre></td></tr></tbody></table></code></div></div>

<h2 id="virtual-memory"><span class="mr-2">Virtual memory:</span><a href="#virtual-memory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>page virtual memory to the disk to slove: more virtual memory than physical memory allocated.
</pre></td></tr></tbody></table></code></div></div>

<h2 id="tools-1"><span class="mr-2">Tools:</span><a href="#tools-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>- PEview
- FSG packer
- UPX packer
- Dependency Walker
- Resource Hacker
	To counter: resource section contains another PE executable.
	Use:save the resource as binary data, then analyze.
		click Action&gt;Save resource as binary file.
- downloader
	downloads additional malware
- Regshot
	take a baseline snapshot of the registry
</pre></td></tr></tbody></table></code></div></div>

<h2 id="imports-msdn-documentation"><span class="mr-2">Imports: (MSDN documentation)</span><a href="#imports-msdn-documentation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>- type: networking, service-manipulation, registry-manipulation.

- WS2_32.dll		-&gt; network functionality
- wininet.dll		-&gt; F: InternetOpen, InternetOpenURL	-&gt; connects to Internet
	InternetReadFile, InternetCloseHandle, InternetOpenUrlA, InternetOpenA
- advapi32.dll	-&gt; permissions

- kernel32.dll	-&gt; F: FindFirstFile, FindNextFile	 -&gt; filesystem(modify files)
- kernel32.dll	-&gt; F: CreateProcess, Sleep			 -&gt; backdoors
- kernel32.dll	-&gt; F: CreateFile, WriteFile, WinExec -&gt; write to disk &amp; execute
- kernel32.dll	-&gt; F: LoadResource, FindResource	 -&gt; loads data from resource section 

- CreateFileA, CreateFileMappingA, and MapViewOfFile -&gt; probably opens a file and maps it into memory.
- LoadLibrary, or GetProcAddress -&gt; load DLL and use its function at runtime.
</pre></td></tr></tbody></table></code></div></div>

<h2 id="exports-mostly-for-dll"><span class="mr-2">Exports: mostly for DLL</span><a href="#exports-mostly-for-dll" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>- ServiceMain 	-&gt; malware needs to be installed as a service.
	svchost.exe: a shared-service process that serves as a shell for loading services from DLL files.
- rundll32: can run DLL with exports.
</pre></td></tr></tbody></table></code></div></div>

<h2 id="use-of-mutex"><span class="mr-2">Use of mutex</span><a href="#use-of-mutex" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>only one copy of the program is running at a time.
</pre></td></tr></tbody></table></code></div></div>

<h2 id="dynamic-analysis"><span class="mr-2">Dynamic analysis…</span><a href="#dynamic-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h4 id="before-run-malware"><span class="mr-2">Before run malware:</span><a href="#before-run-malware" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>- run procmon
- start Process Explorer
- set up virtual network (including ApateDNS, Netcat, Wireshark) #### Run malware:
- In Process Explorer: 
	Handlers: may find Mutant.
	Dlls.
- procmon filter process actions:
	need to filter out a certain amount of noise.
	find if it: RegSetValue, WriteFile.
		write file to copy itself.
		modify register to run on system startup. #### Check ApateDNS
	if malware performed DNS requests. #### Check netcat
	find what the malware requested.
</pre></td></tr></tbody></table></code></div></div>

<h2 id="ida-pro-dll"><span class="mr-2">IDA Pro DLL</span><a href="#ida-pro-dll" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>- Start from DllMain
	all code that executes from the DllEntryPoint until DllMain has likely been generated by the compiler
- CTRL-X with the cursor on gethostbyname: check cross-references.
- byte_ prefix: IDA believes a one byte variable.
- off_ prefix: a pointer variable.
- Rabit hole: IDA may fail to label function like printf, and you may lost in it.
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h1 id="book-learning-malware-analysis">book: Learning malware analysis</h1>

<ul>
  <li>all kinds of malware: https://www.malwarebytes.com/glossary</li>
  <li>INetSim: Internet Services Simulation Suite</li>
</ul>

<h2 id="static-1"><span class="mr-2">Static</span><a href="#static-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h4 id="source"><span class="mr-2">source</span><a href="#source" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Hybrid Analysis: https:/​/​www.​hybrid-​analysis.​com/​</li>
  <li>KernelMode.info: http:/​/​www.​kernelmode.​info/​forum/​viewforum.​php?​f=​16VirusBay: https:/​/​beta.​virusbay.​io/​</li>
  <li>Contagio malware dump: http:/​/​contagiodump.​blogspot.​com/​</li>
  <li>AVCaesar: https:/​/​avcaesar.​malware.​lu/​</li>
  <li>Malwr: https:/​/​malwr.​com/​</li>
  <li>VirusShare: https:/​/​virusshare.​com/​</li>
  <li>theZoo: http:/​/​thezoo.​morirt.​com/</li>
  <li>https://zeltser.com/malware-sample-sources/</li>
</ul>

<h4 id="strings"><span class="mr-2">Strings</span><a href="#strings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>https://github.com/mandiant/flare-floss, extract strings and decode obfuscated strings. <code class="language-plaintext highlighter-rouge">$ ./floss test.exe</code></li>
</ul>

<h4 id="pack"><span class="mr-2">pack</span><a href="#pack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<p><code class="language-plaintext highlighter-rouge">$ upx -o spybot_packed.exe spybot.exe</code></p>

<h4 id="pe-structure-in-image"><span class="mr-2">pe structure in image.</span><a href="#pe-structure-in-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>https://github.com/corkami/pics/blob/master/binary/pe101/pe101.pdf</li>
  <li>http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf</li>
  <li>more file stuctures in picture: https://github.com/corkami/pics/tree/master/binary</li>
</ul>

<h4 id="import-table"><span class="mr-2">import table</span><a href="#import-table" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>can not display function loaded by: LoadLibrary() or LdrLoadDLL(), then GetProcessAdress().</li>
  <li>Search API get info: https://learn.microsoft.com/en-us/</li>
  <li>python to get pe information: https://github.com/erocarrera/pefile <code class="language-plaintext highlighter-rouge">python enum_imports.py test.exe</code></li>
</ul>

<h4 id="dll-export"><span class="mr-2">dll export</span><a href="#dll-export" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>attacker may use fake export names to mislead.</li>
</ul>

<h4 id="pe-data-sections"><span class="mr-2">pe data sections</span><a href="#pe-data-sections" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>idata: import table, if not present, import table in rdata.</li>
  <li>edata: export info, if not present, export info in rdata.</li>
  <li>rdata: read only; or import and export.</li>
  <li>data: read/write data and global var.</li>
</ul>

<h4 id="resource-section"><span class="mr-2">resource section</span><a href="#resource-section" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>.rsrc</li>
  <li>resourcehacker: http://www.angusj.com/resourcehacker/, save resource to *.bin file</li>
</ul>

<h4 id="pescanner"><span class="mr-2">pescanner</span><a href="#pescanner" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>https://github.com/hiddenillusion/AnalyzePE/blob/master/pescanner.py</li>
</ul>

<h4 id="fuzzy-hashing"><span class="mr-2">Fuzzy hashing</span><a href="#fuzzy-hashing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">$ ssdeep -pb *</code> check the similarity of files in pwd, -p: determine percentage similarity.</li>
  <li><code class="language-plaintext highlighter-rouge">$ ssdeep -lrpa samples/</code></li>
  <li>python-ssdeep, https://pypi.org/project/ssdeep/</li>
  <li>other hash: import hash, section hash,</li>
</ul>

<h4 id="yara"><span class="mr-2">Yara</span><a href="#yara" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>yara rule generator: https://www.joesandbox.com/#windows</li>
  <li>yarGen: https://github.com/Neo23x0/yarGen</li>
  <li>write simple rule: https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/</li>
</ul>

<h2 id="dynamic-1"><span class="mr-2">Dynamic</span><a href="#dynamic-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h4 id="tools-2"><span class="mr-2">tools</span><a href="#tools-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>inetsim, flare-fakenet-ng</li>
  <li>Process Hacker, Process Monitor.</li>
  <li>Noriben (put Noriben.py in same folder as Procmon.exe)</li>
</ul>

<h4 id="dll"><span class="mr-2">dll</span><a href="#dll" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>rundll32</li>
  <li>https://learn.microsoft.com/en-US/windows-server/administration/windows-commands/rundll32</li>
  <li>whenever dll loaded, entry point function gets called.</li>
  <li>DLLRunner, run all functions with fuzz parameters in DLL, https://github.com/Neo23x0/DLLRunner</li>
  <li>some mal DLL may check if its running under rundll32.exe</li>
  <li>RemoteDLL has 3 injection methods, may evade above checks.</li>
  <li>some dll may only run when loaded as a service.</li>
</ul>

<h4 id="assembly"><span class="mr-2">assembly</span><a href="#assembly" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>mov dword ptr [ebx], 100;  00 00 00 64</li>
  <li>mov word ptr [ebx], 100;    00 64</li>
  <li>mul ebx: eax * ebx -&gt; edx:eax.</li>
  <li>mul bx: bx * ax -&gt; dx:ax.</li>
  <li>div ebx: edx:eax / ebx.</li>
  <li>movsx: move a sequence of bytes.</li>
  <li>movsb, movsw, movsd: move esi to edi by 1/2/4 bytes.</li>
  <li>repe/repz:      move until ecx=0 or ZF = 0.</li>
  <li>repne/repnz:  move until ecx=0 or ZF = 1.</li>
  <li>stosb/stosw/stosd: move 1/2/4 bytes from al/ax/eax to [edi].  With rep, like C memset().</li>
  <li>lodsb/lodsw/lodsd: move 1/2/4 bytes from [esi] to al/ax/eax.</li>
  <li>scasx: search [edi] until ecx=0 or find equal to al.</li>
  <li>cmpsx: compare a byte in [esi] to [edi], until ecx=0 or not equal.</li>
  <li>WOW64: a subsystem for the execution of 32-bit on 64-bit windows.</li>
  <li>https://www.tutorialspoint.com/assembly_programming/</li>
  <li>http://pacman128.github.io/pcasm/</li>
  <li>https://opensecuritytraining.info/IntroX86.html</li>
  <li>https://en.wikibooks.org/wiki/X86_Disassembly</li>
</ul>

<h4 id="ida"><span class="mr-2">IDA</span><a href="#ida" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>IDA database: .id0, .id1, .nam, .id2, .til</li>
  <li>offset keyword: indicate address of variables are used.</li>
  <li>IDA keeps track of your navigation history</li>
</ul>

<h4 id="common-dlls"><span class="mr-2">common dlls</span><a href="#common-dlls" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Kernel32.dll,  process, memory, hardware, and filesystem</li>
  <li>Advapi32.dll,   service and registry</li>
  <li>Gdi32.dll,        graphics</li>
  <li>User32.dll,     desktop, windows, menus, message boxes, prompts, etc.</li>
  <li>MSVCRT.dll,    C standard lib</li>
  <li>WS2_32.dll,      network</li>
  <li>WSock32.dll,    network</li>
  <li>Wininet.dll,       HTTP FTP</li>
  <li>Urlmon.dll,       wrapper around WinInet.dll</li>
  <li>NTDLL.dll,        Most of the functions in ntdll.dll areundocumented</li>
</ul>

<h4 id="windows-api"><span class="mr-2">Windows API</span><a href="#windows-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>IDA employs a technology called Fast LibraryIdentification and Recognition Technology (FLIRT)</li>
  <li>replace the constants with symbolic names.</li>
  <li>CreateFileA: take ANSI string. CreateFileW: take Unicode string. as input.</li>
  <li>RegCreateKeyEx: Ex mean update function which is incompatible with old function.</li>
</ul>

<h4 id="ida-python"><span class="mr-2">IDA python</span><a href="#ida-python" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>The Beginner’s Guide to IDAPython by Alexander Hanel: https:/​/​leanpub.​com/IDAPython-​Book</li>
  <li>Hex-Rays IDAPython documentation: https:/​/​www.​hex-​rays.​com/​products/​ida/support/​idapython_​docs/</li>
  <li>idautils.Names(),</li>
</ul>

<h4 id="plugins"><span class="mr-2">plugins</span><a href="#plugins" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>https://github.com/onethawt/idaplugins-list</li>
  <li>https://www.hex-rays.com/contests/</li>
  <li>https://www.hex-rays.com/decompiler/</li>
</ul>

<h4 id="debugging"><span class="mr-2">debugging</span><a href="#debugging" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>IDA pro commercial disassemble/debugger</li>
  <li>x64dbg</li>
  <li>dnSpy (debug .NET app), radare2</li>
  <li>WinDbg, Ollydbg, Immunity Debugger, Hopper, Binary Ninja</li>
  <li>exe executed with the privileges of the userrunning the debugger</li>
  <li>software breakpoint: int 3 (0xCC). malware can look for 0xCC and modify it.</li>
  <li>hardware breakpoint: maximum four, DR0-DR3.</li>
  <li>TLS callbacks: Thread Local Storage, run mal code before main application runs.</li>
  <li>System Breakpoint: dubugger first breaks in the system function.</li>
  <li>64-bit code-&gt; FASTCALL calling convention -&gt; rcx,rdx,r8,r9,rest on stack.(pram on register and stack)</li>
  <li>32-bit function: stack grows when arguments pushed. 64-bit function: stack allocated at beginning.</li>
  <li>64-bit: hard to say whether it is local var or parameter, (as mov to pre-allocated stack, not push), when no API doc.</li>
  <li>
    <div class="table-wrapper"><table>
      <tbody>
        <tr>
          <td>debug DLL by rundll32.exe: After oad rundell32.exe, Debug</td>
          <td>Change Command Line, add dll path parameter.</td>
        </tr>
      </tbody>
    </table></div>
  </li>
  <li>DLL already running in a process. https://securityxploded.com/remotedll.php</li>
  <li>trace log text: https://help.x64dbg.com/en/latest/introduction/Formatting.html</li>
  <li>trace log condition: https://help.x64dbg.com/en/latest/introduction/Expressions.html</li>
  <li>IDAPython debugger script: https://www.hex-rays.com/products/ida/debugger/scriptable/</li>
  <li>https://unit42.paloaltonetworks.com/using-idapython-to-make-your-life-easier-part-1/</li>
  <li>dnspy example: https://cysinfo.com/cyber-attack-targeting-cbi-and-possibly-indian-army-officials/</li>
</ul>

<hr />

<h1 id="thm">THM</h1>

<h2 id="room-keywords"><span class="mr-2">room keywords</span><a href="#room-keywords" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>forensic, DFIR, AV, malware, reverse engineering, siem, blue.</li>
</ul>

<h2 id="eric-zimmerman"><span class="mr-2">Eric Zimmerman</span><a href="#eric-zimmerman" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h2 id="dfir-an-introduction-room"><span class="mr-2">DFIR: An Introduction, room</span><a href="#dfir-an-introduction-room" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h4 id="artifacts"><span class="mr-2">artifacts:</span><a href="#artifacts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre>- pieces of information that provide evidence of human activity.
- collected from the Endpoint or Server's file system, memory, or network activity.

#### type:
	- Strings ("exec": a backdoor)
	- API calls
	- Memory dumps
	- Filesystem modifications
	- Log events
	- Running processes
	- Web requests
	- IP address string routable to Command and control server
	- IOCs can be MD5, SHA1, SHA256 hashes, IP address, C2 domain, file size, filename, file path, a registry key, etc.

#### Windows Registry
	- if only access to disk image.
		C:\Windows\System32\Config
		NTUSER.DAT, USRCLASS.DAT
		C:\Windows\AppCompat\Programs\Amcache.hve
			save information on programs that were recently run on the system
	- transaction logs
		journal of the changelog of the registry hive.
	- Registry backups
	- tools: Registry Viewer, similar to Windows Registry Editor, but on disk image.
	- Forensic use:
		Find OS version: SOFTWARE\Microsoft\Windows NT\CurrentVersion
		Computer Name, Time Zone Information, Autostart Programs.
		Network Interfaces: IP, DNS server, DHCP server, Subnet. 
		Past Networks: a given machine was connected to, write time is the connection time.
		SAM hive and user information: RID, login times, last login time, password change/policy/hint.
		NTUSER hive
			recently opened files information.
		Evidence of Execution.
			User Assist (registry keys)
			ShimCache
		External Devices, USB

#### Disk:
	- Autospy disk recovery.
		data on the disk in different unallocated clusters, which can possibly be recovered. 
		X mark indicates a deleted file.
	- Windows Prefetch files
		program information for future use.
	- Windows 10 Timeline
		a database, store recently used applications
	- Windows Jump Lists
		last executed programs and the last opened files in a system
	- setupapi.dev.log
		information related to attached devices
</pre></td></tr></tbody></table></code></div></div>

<h4 id="linux-forensic"><span class="mr-2">Linux forensic:</span><a href="#linux-forensic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>- Information
	/etc/os-release, /etc/passwd, /etc/shadow, /bin/bash, /etc/group, /etc/sudoers
	sudo last -f /var/log/wtmp, binary file read by last, data of logins.
	cat /var/log/auth.log
- System Configuration
	/etc/hostname, /etc/timezone, /etc/network/interfaces, /etc/resolv.conf
	/etc/bash.bashrc, /etc/profile
	netstat -natp
	ps -aux
- Persistence mechanisms: ways a program can survive after a system reboot
	Cron jobs, /etc/crontab
	Service startup, /etc/init.d
	~/.bashrc, run commands when bash shell is spawned.
- Evidence of Execution
	cat /var/log/auth.log* 
	cat ~/.bash_history, cat ~/.zsh_history
	cat ~/.viminfo, file accessed using vim
- Logs
	Syslog, Auth logs, Third-party logs
</pre></td></tr></tbody></table></code></div></div>

<h4 id="evidence-preservation"><span class="mr-2">Evidence Preservation</span><a href="#evidence-preservation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>

<h4 id="chain-of-custody"><span class="mr-2">Chain of custody</span><a href="#chain-of-custody" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>integrity of the data.
</pre></td></tr></tbody></table></code></div></div>

<h4 id="order-of-volatility"><span class="mr-2">Order of volatility</span><a href="#order-of-volatility" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>preserve RAM before hard drive.
</pre></td></tr></tbody></table></code></div></div>

<h4 id="timeline-creation"><span class="mr-2">Timeline creation</span><a href="#timeline-creation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>puts all the activities in chronological order.
</pre></td></tr></tbody></table></code></div></div>

<h4 id="tools-3"><span class="mr-2">Tools:</span><a href="#tools-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>- KAPE (Kroll Artifact Parser and Extractor)
	bypass the OS locks and copy the files
- Autopsy
	analyzes major file systems
- Volatility
	analyzing memory dumps
	python3 vol.py -f &lt;file&gt; windows.info
	pslist, pstree, netstat, dlllist
	compare the memory file against YARA rules
	SSDT Hooks: system Service Descriptor Table
		An adversary can hook into this table and modify pointers to point to a location the rootkit controls.
- Redline 
	IOC: Indicators of Compromise
		artifacts of the potential compromise
	collects various data for analysis 
		running processes, download histroy, services, files, registry structures, event logs,
- Velociraptor
</pre></td></tr></tbody></table></code></div></div>

<h4 id="nist-and-sans-incident-handling-guide"><span class="mr-2">NIST and SANS incident handling guide.</span><a href="#nist-and-sans-incident-handling-guide" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>1. Preparation 2. Identification 3. Containment 4. Eradication 5. Recovery 6. Lessons Learned
</pre></td></tr></tbody></table></code></div></div>

<h4 id="btk-serial-killer"><span class="mr-2">BTK serial killer</span><a href="#btk-serial-killer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>he sent a floppy disk, recover a deleted word document.
</pre></td></tr></tbody></table></code></div></div>

<h2 id="kape-room"><span class="mr-2">KAPE, room</span><a href="#kape-room" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Bin: execute when exe not on system. mostly EZ tools.</li>
  <li>Process VSCs: process Volume Shadow Copies.</li>
  <li>When both Target and Module Options. Module Source is not required.  Target destination is the Module source.</li>
  <li>“_kape.cli”:  batch mode commands in the same directory of Kape.</li>
  <li>What search query was run on the system? -&gt; registry: WordWheelQuery.</li>
  <li>module out -&gt; Automatic Destinations -&gt; FileFolderAccess.</li>
</ul>

<h2 id="autopsy-room"><span class="mr-2">Autopsy, room</span><a href="#autopsy-room" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p>More than the room:</p>
<ul>
  <li>Global Hash Lookup Settings</li>
  <li>Global File Extension Mismatch Identification Settings</li>
  <li>Global Keyword Search Settings</li>
  <li>Global Interesting Items Settings</li>
  <li>Yara Analyser</li>
</ul>

<p>Full excercise: https://cfreds.nist.gov/ , to download the disk image</p>

<h2 id="linux-forensics-room"><span class="mr-2">Linux Forensics, room</span><a href="#linux-forensics-room" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>

<h4 id="system-config"><span class="mr-2">system config</span><a href="#system-config" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/os-release</code></li>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/sudoers</code></li>
  <li><code class="language-plaintext highlighter-rouge">sudo last -f /var/log/wtmp</code> last logins</li>
  <li><code class="language-plaintext highlighter-rouge">sudo last -f /var/log/btmp</code> failed logins</li>
  <li><code class="language-plaintext highlighter-rouge">/var/log/auth.log</code> Authentication logs</li>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/hostname</code> hostname</li>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/timezone</code> timezone</li>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/network/interfaces</code> network config</li>
  <li><code class="language-plaintext highlighter-rouge">ip address show</code></li>
  <li><code class="language-plaintext highlighter-rouge">netstat -natp</code> Active network connections</li>
  <li><code class="language-plaintext highlighter-rouge">ps</code> running processes</li>
  <li><code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> DNS server</li>
</ul>

<h4 id="persistence"><span class="mr-2">persistence</span><a href="#persistence" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<p>ways a program can survive after a system reboot.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">cat /etc/crontab</code> Cron jobs.</li>
  <li><code class="language-plaintext highlighter-rouge">cd /etc/init.d</code> services startup in this folder.</li>
  <li><code class="language-plaintext highlighter-rouge">cat ~/.bashrc</code> commands run after bash shell spawned.</li>
  <li>/etc/bash.bashrc, /etc/profile. -&gt; System-wide settings</li>
</ul>

<h4 id="evidence-of-execution"><span class="mr-2">evidence of execution</span><a href="#evidence-of-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Sudo execution history: <code class="language-plaintext highlighter-rouge">cat /var/log/auth.log* |grep -i COMMAND</code></li>
  <li>Bash history: <code class="language-plaintext highlighter-rouge">cat ~/.bash_history</code></li>
  <li>Files accessed using vim: <code class="language-plaintext highlighter-rouge">cat ~/.viminfo</code></li>
</ul>

<h4 id="log-1"><span class="mr-2">Log</span><a href="#log-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Syslog, <code class="language-plaintext highlighter-rouge">cat /var/log/syslog*</code>, check former hostname.</li>
  <li>Auth logs, <code class="language-plaintext highlighter-rouge">cat /var/log/auth.log*</code></li>
  <li>Third-party logs, <code class="language-plaintext highlighter-rouge">ls /var/log</code></li>
  <li>/var/log/httpd, /var/log/cron, /var/log/auth.log, /var/log/secure, /var/log/kern.</li>
  <li>/var/log/apache, /var/log/httpd.</li>
  <li>Ways of Log Ingestion of SIEM:  1) Agent / Forwarder, 2) Syslog, 3) Manual Upload, 4) Port-Forwarding</li>
</ul>

<h2 id="volatility-room"><span class="mr-2">Volatility, room</span><a href="#volatility-room" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>https://volatility3.readthedocs.io/en/latest/</li>
  <li>https://github.com/volatilityfoundation/volatility3</li>
  <li>syntax changed in volatility3 from volatility2. (python3 -&gt; python2)</li>
  <li>Virtual memory: VMWare - .vmem; Hyper-V - .bin; Parallels - .mem; VirtualBox - .sav file.</li>
  <li>imageinfo: list best possible OS profiles</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f dump.vmem windows.info</code> use plugin windows.info to get information from dump.vmem.</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.pslist</code> listing processes. Can not see unlinked rootkits.</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.psscan</code> help combat evasion techniques above.</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.pstree</code></li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.netstat</code> another tool in this case may be better-&gt; bulk_extractor.</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.dlllist</code></li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.malfind</code> attempt to identify injected processes</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.yarascan</code></li>
</ul>

<h4 id="hooking"><span class="mr-2">Hooking</span><a href="#hooking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>one evasion technique</li>
  <li>SSDT Hooks, IRP Hooks, IAT Hooks, EAT Hooks, Inline Hooks.</li>
  <li>SSDT: System Service Descriptor Table. modify pointers to a location the rootkit controls.</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.ssdt</code></li>
</ul>

<h4 id="find-driver-files-as-part-of-their-evasion"><span class="mr-2">find driver files as part of their evasion</span><a href="#find-driver-files-as-part-of-their-evasion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.modules</code> dump a list of loaded kernel modules</li>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f &lt;file&gt; windows.driverscan</code> identify driver files in the kernel, which “modules” may miss</li>
</ul>

<h4 id="dump-pid-1640"><span class="mr-2">dump pid 1640</span><a href="#dump-pid-1640" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">python3 vol.py -f /Scenarios/Investigations/Investigation-1.vmem -o ./mydump windows.memmap.Memmap --pid 1640 --dump</code></li>
</ul>

<h4 id="resources"><span class="mr-2">resources</span><a href="#resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>https://github.com/volatilityfoundation/volatility/wiki</li>
  <li>https://eforensicsmag.com/finding-advanced-malware-using-volatility/</li>
  <li>https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet</li>
  <li>https://book.cyberyozh.com/counter-forensics-anti-computer-forensics/</li>
</ul>

<h2 id="redline-room"><span class="mr-2">Redline, room</span><a href="#redline-room" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>FireEye tool</li>
</ul>

<hr />

<h1 id="bookcyberyozhcom">book.cyberyozh.com</h1>

<h4 id="anti-forensic"><span class="mr-2">anti-forensic</span><a href="#anti-forensic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>hidden OS. Different password to different file container. TrueCrypt, VeraCrypt.</li>
  <li>DMA attack: FireWire port, cold boot attack.</li>
</ul>

<hr />

<h1 id="13cubed-investigating-windows-endpoints">13Cubed (Investigating Windows Endpoints)</h1>

<ul>
  <li>https://www.13cubed.com/</li>
</ul>

<h2 id="alexiou-principle"><span class="mr-2">Alexiou principle</span><a href="#alexiou-principle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>What question are you trying to answer?</li>
  <li>What data do you need to answer that question?</li>
  <li>How do you extract that data?</li>
  <li>What does that data tell you?</li>
</ul>

<h2 id="setup"><span class="mr-2">Setup</span><a href="#setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>windows sandbox (ctr+R: optionalfeatures)</li>
  <li>linux on windows (windows store)</li>
  <li>sysinternals suite (windows store) -&gt; RDCMan(RDP manager)</li>
  <li>powertoys (windows store)</li>
  <li>FTK imager.</li>
  <li>Arsenal Recon: Arsenal Image Mounter, Hibernation Recon.</li>
  <li>Zimmerman tools. &amp; KAPE</li>
  <li>NIRSOFT tools.</li>
  <li>Other: Chainsaw, MemProcFS, PEstudio, RegRipper, TestDisk, thumbs_viewer.</li>
</ul>

<h2 id="windows-event-log"><span class="mr-2">Windows Event Log</span><a href="#windows-event-log" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>file: .evt</li>
  <li>vista introduce evtx format.</li>
  <li>ctl+R: \windows\system32\winevt\logs</li>
  <li>Event Viewer -&gt; Windows Logs -&gt; Channels: Application, Security, Setup, System, Forwarded Events.</li>
  <li>power shell: <code class="language-plaintext highlighter-rouge">Get-Help Get-WinEvent</code></li>
  <li><code class="language-plaintext highlighter-rouge">Get-WinEvent -LogName Security</code></li>
  <li>Ntds. dit: a database that stores Active Directory data. (hashcat: can get the credentials)</li>
  <li>application event ID 216: move Nsds.dit database, caused by volumn shadow copy, no worry.</li>
  <li>RDP related logs: https://ponderthebits.com/</li>
  <li>ZMtool -&gt; EvtxeCmd -&gt; Maps. <code class="language-plaintext highlighter-rouge">EvtxECmd.exe -d {logPath} --csv {outputPath}</code></li>
  <li>ZMtool -&gt;  – vss options -&gt; powerful to get data from shadow volume.</li>
  <li>https://github.com/BeanBagKing/BaselineLogging</li>
  <li>https://nullsec.us/windows-baseline-logging/</li>
  <li>Sysmon: addtion to event log, not default.</li>
</ul>

<h2 id="registry-1"><span class="mr-2">Registry</span><a href="#registry-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>https://dfir.ru/2020/10/03/exporting-registry-hives-from-a-live-system/</li>
  <li>some may only stay in memory, others on disk as hive.</li>
  <li>system hives: C:\Windows\System32\config, DEFAULT; SAM; SECURITY; SOFTWARE; SYSTEM.</li>
  <li>HKEY_CURRENT_USER: NTUSR.DAT; usrClass.dat.</li>
  <li>C:\Windows\appcompat\Programs\Amcache.hve</li>
  <li>https://www.13cubed.com/downloads/windows_registry_cheat_sheet.pdf</li>
  <li>keys and subkeys have last write time; but values in it do not have.</li>
  <li>shellbag: even delete the path, shellbag still exists.</li>
  <li>HKLM/SYSTEM/Select(current) -&gt; check which control set is using.</li>
  <li>https://github.com/EricZimmerman/RECmd/blob/master/BatchExamples/Kroll_Batch.reb (filter out potentially irrelevant information from the Windows Registry)</li>
  <li>regripper: another tool</li>
</ul>

<h2 id="evidence-of-execution-1"><span class="mr-2">Evidence of Execution</span><a href="#evidence-of-execution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>two major type: 1. user experience. 2. backwards compatibility.</li>
</ul>

<h4 id="prefetch-1"><span class="mr-2">prefetch</span><a href="#prefetch-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>user experience</li>
  <li>prefetch: speed up app start up. (monitor app for around 10 seconds, to see the resources it needs.)</li>
  <li>GUI or CMD.</li>
  <li>C:\Windows\Prefetch</li>
  <li>name: {appName}-{8digitsHash}.pf</li>
  <li>different hash may means same exe name in different locations or with different parameters.</li>
  <li>sometimes parameters in hash calculation, not always.</li>
  <li>created time -&gt; first execute; modified time -&gt; last execute.</li>
  <li>default on desktop windows, not server.</li>
  <li>last 8 time of execution is tracked in pf file, since windows 8.</li>
  <li>32-bit app runs on 64-bit system, not reverse. so malware authors use 32-bit. at: windows/SysWOW64. 2 CMD pf files, one 32-bit.</li>
  <li>ZM tool: PECmd.exe</li>
  <li>after delete binary, prefetch still exists.</li>
  <li>anti-forensic: delete prefetch. <code class="language-plaintext highlighter-rouge">sdelete *.pf</code> delete all prefetch.</li>
  <li>sdelete-hash.pf left, in PECmd.exe, in “file referenced”, we can know what it deleted.</li>
  <li>https://learn.microsoft.com/en-us/sysinternals/downloads/sdelete</li>
  <li>https://www.youtube.com/watch?v=f4RAtR_3zcs</li>
</ul>

<h4 id="shimcache"><span class="mr-2">Shimcache</span><a href="#shimcache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>backwards compatibility</li>
  <li>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache</li>
  <li>used to be evidence of execution, before windows 10, not in windows 10/newer.</li>
  <li>the higher on the list, the more recent it shimed.</li>
  <li>same modified time, may mean same file just with different name.(eg. find renamed malware)</li>
  <li>files viewd in window explorer, will be in the cache. NOT only when executed.</li>
  <li>reboot computer will refresh shimcache.</li>
  <li>ZM: AppCompatCacheParser.exe</li>
</ul>

<h4 id="amcache"><span class="mr-2">AmCache</span><a href="#amcache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>https://www.ssi.gouv.fr/uploads/2019/01/anssi-coriin_2019-analysis_amcache.pdf</li>
  <li>C:\Windows\appcompat\Programs\Amcache.hve</li>
  <li>contain many program metadata. linkdate(compilation date)</li>
  <li>can not use to proof execution.</li>
  <li>InventoryApplication, InventoryApplicationFile, InventoryDriverBinary.</li>
  <li>ZM: AmcacheParser.exe</li>
</ul>

<h4 id="pca-program-compatibility-assistant"><span class="mr-2">PCA (Program Compatibility Assistant)</span><a href="#pca-program-compatibility-assistant" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>very new, Windows 11 22H2</li>
  <li>C:\Windows\appcompat\pca\PcaAppLaunchDic.txt</li>
</ul>

<h4 id="muicache"><span class="mr-2">MUICache</span><a href="#muicache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\MuiCache</li>
  <li>ApplicationCompany, FriendlyAppName. (rename exe do not change them)</li>
  <li>no MRU list, so no timestamp info.</li>
  <li>per user artifact for gui program.</li>
</ul>

<h4 id="userassist-registry"><span class="mr-2">UserAssist Registry</span><a href="#userassist-registry" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>Run counter, Focus Count.</li>
  <li>https://imphash.medium.com/userassist-with-a-pinch-of-salt-as-an-evidence-of-execution-4dc4e9640a77</li>
</ul>

<h4 id="srum"><span class="mr-2">SRUM</span><a href="#srum" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ul>
  <li>System Resource Utilization Monitor</li>
  <li>C:\Windows\System32\sru\SRUDB.dat</li>
  <li>ZM: SrumECmd.exe</li>
</ul>

<h2 id="persistentence"><span class="mr-2">persistentence</span><a href="#persistentence" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>BatchExamples/RegistryASEPs.reb (Auto Start Extensibility Points)</li>
  <li>Process: Local Security Authority Process.</li>
  <li>https://blog.netwrix.com/2021/11/30/extracting-password-hashes-from-the-ntds-dit-file/</li>
  <li>ntdlutil</li>
  <li>https://www.crowdstrike.com/cybersecurity-101/privilege-escalation</li>
  <li>impacket below:</li>
  <li>https://www.13cubed.com/downloads/impacket_exec_commands_cheat_sheet.pdf</li>
  <li>https://www.13cubed.com/downloads/impacket_exec_commands_cheat_sheet_poster.pdf</li>
  <li>MACB: Modified, Accessed, Changed ($MFT Modified), Birth (file creation time)</li>
  <li>SumECmd.exe</li>
  <li>User Access Logging (UAL)</li>
</ul>

<hr />

<h1 id="13cubed-videos">13cubed videos</h1>

<h2 id="thumbnail-forensic"><span class="mr-2">thumbnail forensic</span><a href="#thumbnail-forensic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>tools: thumbsviewer, thumb cache.</li>
  <li>thumbcache_xxx.db (xxx is the resolution)</li>
</ul>

<h2 id="malware-analysis"><span class="mr-2">malware analysis</span><a href="#malware-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>IDA -&gt; plugin -&gt; OllyDumpEx</li>
  <li>IDA -&gt; plugin -&gt; Scylla: IAT Autosearch</li>
</ul>

<hr />

<h1 id="certs">Certs</h1>

<h2 id="giac-reverse-engineering-malware-grem"><span class="mr-2">GIAC Reverse Engineering Malware (GREM)</span><a href="#giac-reverse-engineering-malware-grem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Analyzing Malicious Office Macros</li>
  <li>Analyzing Malicious PDFs</li>
  <li>Analyzing Malicious RTF Files</li>
  <li>Analyzing Obfuscated Malware</li>
  <li>Behavioral Analysis Fundamentals</li>
  <li>Common Malware Patterns</li>
  <li>Core Reverse Engineering Concepts</li>
  <li>Identifying and Bypassing Anti-Analysis Techniques</li>
  <li>Malware Analysis Fundamentals</li>
  <li>Malware Flow Control and Structures</li>
  <li>Overcoming Misdirection Techniques</li>
  <li>Reversing Functions in Assembly</li>
  <li>Static Analysis Fundamentals</li>
  <li>Unpacking and Debugging Packed Malware</li>
</ul>

<h2 id="giac-certified-incident-handler-gcih"><span class="mr-2">GIAC Certified Incident Handler (GCIH)</span><a href="#giac-certified-incident-handler-gcih" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Detecting Covert Communications</li>
  <li>Detecting Evasive Techniques</li>
  <li>Detecting Exploitation Tools</li>
  <li>Drive-By Attacks</li>
  <li>Endpoint Attack and Pivoting</li>
  <li>Incident Response and Cyber Investigation</li>
  <li>Memory and Malware Investigation</li>
  <li>Network Investigations</li>
  <li>Networked Environment Attack</li>
  <li>Password Attacks</li>
  <li>Post-Exploitation Attacks</li>
  <li>Reconnaissance and Open-Source Intelligence</li>
  <li>Scanning and Mapping</li>
  <li>SMB Scanning</li>
  <li>Web App Attacks</li>
</ul>

<h2 id="giac-certified-intrusion-analyst-gcia"><span class="mr-2">GIAC Certified Intrusion Analyst (GCIA)</span><a href="#giac-certified-intrusion-analyst-gcia" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Advanced IDS Concepts</li>
  <li>Application Protocols</li>
  <li>Concepts of TCP/IP and the Link Layer</li>
  <li>Fragmentation</li>
  <li>IDS Fundamentals and Network Architecture</li>
  <li>Intrusion Detection System Rules</li>
  <li>IP Headers</li>
  <li>IPv6</li>
  <li>Network Forensics and Traffic Analysis</li>
  <li>Packet Engineering</li>
  <li>SiLK and Other Traffic Analysis Tools</li>
  <li>TCP</li>
  <li>Tcpdump Filters</li>
  <li>UDP and ICMP</li>
  <li>Wireshark Fundamentals</li>
</ul>

<h2 id="giac-battlefield-forensics-and-acquisition-gbfa"><span class="mr-2">GIAC Battlefield Forensics and Acquisition (GBFA)</span><a href="#giac-battlefield-forensics-and-acquisition-gbfa" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Acquiring RAM and OS Artifacts</li>
  <li>Acquisition Preparation</li>
  <li>Data on Drives</li>
  <li>Data on the Network</li>
  <li>Dead Box Acquisition</li>
  <li>Host Based Live Acquisition</li>
  <li>Manual Triage</li>
  <li>Manually Finding Data</li>
  <li>Mobile Device Acquisition/Triage</li>
  <li>Physical Storage Devices</li>
  <li>Remote Acquisition</li>
  <li>Storage Technologies</li>
  <li>Working With Evidence Files</li>
</ul>

<h2 id="giac-certified-forensic-analyst-gcfa-aka-for508"><span class="mr-2">GIAC Certified Forensic Analyst (GCFA), aka. FOR508</span><a href="#giac-certified-forensic-analyst-gcfa-aka-for508" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<ul>
  <li>Analyzing Volatile Malicious Event Artifacts</li>
  <li>Analyzing Volatile Windows Event Artifacts</li>
  <li>Enterprise Environment Incident Response</li>
  <li>File System Timeline Artifact Analysis</li>
  <li>Identification of Malicious System and User Activity</li>
  <li>Identification of Normal System and User Activity</li>
  <li>Introduction to File System Timeline Forensics</li>
  <li>Introduction to Memory Forensics</li>
  <li>NTFS Artifact Analysis</li>
  <li>Windows Artifact Analysis</li>
</ul>

<h2 id="for500-windows-forensic-analysis"><span class="mr-2">FOR500: Windows Forensic Analysis</span><a href="#for500-windows-forensic-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>


</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/sec/'>sec</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/forensic/"
          class="post-tag no-text-decoration" >forensic</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Forensic+-+Yuchao+Toolbox&url=%2Fposts%2FForensic%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Forensic+-+Yuchao+Toolbox&u=%2Fposts%2FForensic%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=%2Fposts%2FForensic%2F&text=Forensic+-+Yuchao+Toolbox" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/posts/IDA-Python/">IDA Python</a></li>
      
        
        
        
      <li><a href="/posts/Forensic/">Forensic</a></li>
      
        
        
        
      <li><a href="/posts/OffSec-Notes/">OffSecNotes</a></li>
      
        
        
        
      <li><a href="/posts/Network-Security/">Network Security</a></li>
      
        
        
        
      <li><a href="/posts/CPP-the-Cherno/">C++ The Cherno</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/htb/">htb</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/burpsuite/">burpsuite</a>
    
      
      <a class="post-tag" href="/tags/forensic/">forensic</a>
    
      
      <a class="post-tag" href="/tags/jekyll/">jekyll</a>
    
      
      <a class="post-tag" href="/tags/oscp/">oscp</a>
    
      
      <a class="post-tag" href="/tags/thm/">thm</a>
    
      
      <a class="post-tag" href="/tags/activedirectory/">ActiveDirectory</a>
    
      
      <a class="post-tag" href="/tags/assembly/">assembly</a>
    
      
      <a class="post-tag" href="/tags/aws/">aws</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
      
        
        <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/IDA-Python/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1682479980"
    
    >
  2023-04-26
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>IDA Python</h3>
            <div class="text-muted small">
              <p>
                





                PE format

  https://github.com/corkami/pics/blob/master/binary/PE.png
  https://github.com/corkami/pics/blob/master/binary/PE101.png
  https://github.com/corkami/pics/blob/master/binary/PE102.png
...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/yara/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1652671980"
    
    >
  2022-05-16
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Yara</h3>
            <div class="text-muted small">
              <p>
                





                install
sudo apt update -y &amp;amp;&amp;amp; sudo apt upgrade -y
sudo apt install yara


usage
yara myfirstrule.yar somefile


write rules

  https://yara.readthedocs.io/en/stable/writingrules.html
  http...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Zero-Logon/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1652758380"
    
    >
  2022-05-17
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Zero Logon CVE</h3>
            <div class="text-muted small">
              <p>
                





                Zero Logon

CVE-2020-1472

  abuses a feature within MS-NRPC (Microsoft NetLogon Remote Protocol)
  AES-CFB8 with hard coded IV.
  https://github.com/SecuraBV/CVE-2020-1472, the POC
  https://githu...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


      
        
        <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/CPP-the-Cherno/" class="btn btn-outline-primary"
    prompt="Older">
    <p>C++ The Cherno</p>
  </a>
  

  
  <a href="/posts/Network-Security/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Network Security</p>
  </a>
  

</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>
</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center text-muted">
    <div class="footer-left">
      <p class="mb-0">
        © 2023
        <a href="https://twitter.com/0xZEN2">Yuchao</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
         theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/htb/">htb</a>
    
      
      <a class="post-tag" href="/tags/linux/">linux</a>
    
      
      <a class="post-tag" href="/tags/burpsuite/">burpsuite</a>
    
      
      <a class="post-tag" href="/tags/forensic/">forensic</a>
    
      
      <a class="post-tag" href="/tags/jekyll/">jekyll</a>
    
      
      <a class="post-tag" href="/tags/oscp/">oscp</a>
    
      
      <a class="post-tag" href="/tags/thm/">thm</a>
    
      
      <a class="post-tag" href="/tags/activedirectory/">ActiveDirectory</a>
    
      
      <a class="post-tag" href="/tags/assembly/">assembly</a>
    
      
      <a class="post-tag" href="/tags/aws/">aws</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    
      <!--
  mermaid-js loader
-->

<script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script>

<script>
  $(function() {
    function updateMermaid(event) {
      if (event.source === window && event.data &&
            event.data.direction === ModeToggle.ID) {

        const mode = event.data.message;

        if (typeof mermaid === "undefined") {
          return;
        }

        let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    let initTheme = "default";

    if ($("html[data-mode=dark]").length > 0
      || ($("html[data-mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Markdown converts to HTML */
    $("pre").has("code.language-mermaid").each(function() {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<div class=\"mermaid\">${svgCode}</div>`);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener("message", updateMermaid);
  });
</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
  /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
  MathJax = {
    tex: {
      inlineMath: [              /* start/end delimiter pairs for in-line math */
        ['$','$'],
        ['\\(','\\)']
      ],
      displayMath: [             /* start/end delimiter pairs for display math */
        ['$$', '$$'],
        ['\\[', '\\]']
      ]
    }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>


<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

